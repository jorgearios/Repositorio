import{g as wl,a as Sl}from"./chunks/_commonjsHelpers-DcgyVupF.js";var Cn,Jr,$n,gr,Xt,Wr,yr,ke,Dn;(function(s){s.POST_MESSAGE="postMessage"})(Cn||(Cn={})),(function(s){s.POST_MESSAGE="postMessage"})(Jr||(Jr={})),(function(s){s.STREAMABLE_HTTP="streamableHttp",s.SSE="sse"})($n||($n={})),(function(s){s.LOCAL="local",s.REMOTE="remote"})(gr||(gr={})),(function(s){s.SDK_ANGIE_READY_PING="sdk-angie-ready-ping",s.SDK_ANGIE_REFRESH_PING="sdk-angie-refresh-ping",s.SDK_REQUEST_CLIENT_CREATION="sdk-request-client-creation",s.SDK_REQUEST_INIT_SERVER="sdk-request-init-server",s.SDK_TRIGGER_ANGIE="sdk-trigger-angie",s.SDK_TRIGGER_ANGIE_RESPONSE="sdk-trigger-angie-response"})(Xt||(Xt={})),(function(s){s.SET="ANGIE_SET_LOCALSTORAGE",s.GET="ANGIE_GET_LOCALSTORAGE"})(Wr||(Wr={})),(function(s){s.RESET_HASH="reset-hash",s.HOST_READY="host/ready",s.ANGIE_LOADED="angie/loaded",s.ANGIE_READY="angie/ready"})(yr||(yr={}));class El{isAngieReady=!1;readyPromise;readyResolve;constructor(){if(this.readyPromise=new Promise(a=>{this.readyResolve=a}),typeof window>"u")return;let e=0;const r=()=>{if(this.isAngieReady||e>=500)return void(!this.isAngieReady&&e>=500&&this.handleDetectionTimeout());const a=new MessageChannel;a.port1.onmessage=n=>{this.handleAngieReady(n.data),a.port1.close(),a.port2.close()};const t={type:Xt.SDK_ANGIE_READY_PING,timestamp:Date.now()};window.postMessage(t,window.location.origin,[a.port2]),e++,setTimeout(r,500)};r()}handleAngieReady(e){this.isAngieReady=!0;const r={isReady:!0,version:e.version,capabilities:e.capabilities};this.readyResolve&&this.readyResolve(r)}handleDetectionTimeout(){this.readyResolve&&this.readyResolve({isReady:!1}),console.warn("AngieMcpSdk: AngieDetector: Detection timeout - Angie may not be available")}isReady(){return this.isAngieReady}async waitForReady(){return this.readyPromise}}class Pl{queue=[];isProcessing=!1;add(e){const r={id:this.generateId(e),config:e,timestamp:Date.now(),status:"pending"};return this.queue.push(r),console.log(`RegistrationQueue: Added server "${e.name}" to queue`),r}getAll(){return[...this.queue]}getPending(){return this.queue.filter(e=>e.status==="pending")}updateStatus(e,r,a){const t=this.queue.find(n=>n.id===e);t&&(t.status=r,a?t.error=a:r!=="pending"&&r!=="registered"||delete t.error,console.log(`RegistrationQueue: Updated server ${e} status to ${r}`))}async processQueue(e){if(this.isProcessing)return void console.log("RegistrationQueue: Already processing queue");this.isProcessing=!0;const r=this.getPending();console.log(`RegistrationQueue: Processing ${r.length} pending registrations`);try{for(const a of r)try{await e(a),this.updateStatus(a.id,"registered")}catch(t){const n=t instanceof Error?t.message:String(t);this.updateStatus(a.id,"failed",n),console.error(`RegistrationQueue: Failed to process registration ${a.id}:`,n)}}finally{this.isProcessing=!1}}clear(){this.queue=[],console.log("RegistrationQueue: Cleared all registrations")}resetAllToPending(){if(this.isProcessing)return console.log("RegistrationQueue: Cannot reset to pending - processing in progress"),!1;const e=this.queue.filter(a=>a.status==="registered").length,r=this.queue.filter(a=>a.status==="failed").length;return this.queue.forEach(a=>{a.status!=="pending"&&(a.status="pending",delete a.error)}),console.log(`RegistrationQueue: Reset ${e+r} registrations to pending`),!0}remove(e){const r=this.queue.findIndex(a=>a.id===e);return r!==-1&&(this.queue.splice(r,1),console.log(`RegistrationQueue: Removed registration ${e}`),!0)}generateId(e){return`reg_${e.name}_${e.version}_${Date.now()}`}}class xl{async requestClientCreation(e){const{config:r}=e,a={serverId:e.id,serverName:r.name,serverVersion:r.version,description:r.description,transport:r.transport||Jr.POST_MESSAGE,capabilities:r.capabilities,instanceId:e.instanceId};return"type"in r&&r.type==="remote"&&(a.remote={url:r.url}),new Promise((t,n)=>{const i=new MessageChannel,o=setTimeout(()=>{n(new Error("Client creation request timed out after 15000ms"))},15e3);i.port1.onmessage=c=>{clearTimeout(o),t(c.data)};const l={type:Xt.SDK_REQUEST_CLIENT_CREATION,payload:a,timestamp:Date.now()};window.postMessage(l,window.location.origin,[i.port2])})}}(function(s){s.assertEqual=e=>{},s.assertIs=function(e){},s.assertNever=function(e){throw new Error},s.arrayToEnum=e=>{const r={};for(const a of e)r[a]=a;return r},s.getValidEnumValues=e=>{const r=s.objectKeys(e).filter(t=>typeof e[e[t]]!="number"),a={};for(const t of r)a[t]=e[t];return s.objectValues(a)},s.objectValues=e=>s.objectKeys(e).map(function(r){return e[r]}),s.objectKeys=typeof Object.keys=="function"?e=>Object.keys(e):e=>{const r=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.push(a);return r},s.find=(e,r)=>{for(const a of e)if(r(a))return a},s.isInteger=typeof Number.isInteger=="function"?e=>Number.isInteger(e):e=>typeof e=="number"&&Number.isFinite(e)&&Math.floor(e)===e,s.joinValues=function(e,r=" | "){return e.map(a=>typeof a=="string"?`'${a}'`:a).join(r)},s.jsonStringifyReplacer=(e,r)=>typeof r=="bigint"?r.toString():r})(ke||(ke={})),(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(Dn||(Dn={}));const J=ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Wt=s=>{switch(typeof s){case"undefined":return J.undefined;case"string":return J.string;case"number":return Number.isNaN(s)?J.nan:J.number;case"boolean":return J.boolean;case"function":return J.function;case"bigint":return J.bigint;case"symbol":return J.symbol;case"object":return Array.isArray(s)?J.array:s===null?J.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?J.promise:typeof Map<"u"&&s instanceof Map?J.map:typeof Set<"u"&&s instanceof Set?J.set:typeof Date<"u"&&s instanceof Date?J.date:J.object;default:return J.unknown}},Z=ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Bt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof Bt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}Bt.create=s=>new Bt(s);const xs=(s,e)=>{let r;switch(s.code){case Z.invalid_type:r=s.received===J.undefined?"Required":`Expected ${s.expected}, received ${s.received}`;break;case Z.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,ke.jsonStringifyReplacer)}`;break;case Z.unrecognized_keys:r=`Unrecognized key(s) in object: ${ke.joinValues(s.keys,", ")}`;break;case Z.invalid_union:r="Invalid input";break;case Z.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ke.joinValues(s.options)}`;break;case Z.invalid_enum_value:r=`Invalid enum value. Expected ${ke.joinValues(s.options)}, received '${s.received}'`;break;case Z.invalid_arguments:r="Invalid function arguments";break;case Z.invalid_return_type:r="Invalid function return type";break;case Z.invalid_date:r="Invalid date";break;case Z.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:ke.assertNever(s.validation):r=s.validation!=="regex"?`Invalid ${s.validation}`:"Invalid";break;case Z.too_small:r=s.type==="array"?`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"||s.type==="bigint"?`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:"Invalid input";break;case Z.too_big:r=s.type==="array"?`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:"Invalid input";break;case Z.custom:r="Invalid input";break;case Z.invalid_intersection_types:r="Intersection results could not be merged";break;case Z.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case Z.not_finite:r="Number must be finite";break;default:r=e.defaultError,ke.assertNever(s)}return{message:r}};let Rl=xs;var X;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(X||(X={}));function B(s,e){const r=Rl,a=(t=>{const{data:n,path:i,errorMaps:o,issueData:l}=t,c=[...i,...l.path||[]],h={...l,path:c};if(l.message!==void 0)return{...l,path:c,message:l.message};let p="";const y=o.filter(u=>!!u).slice().reverse();for(const u of y)p=u(h,{data:n,defaultError:p}).message;return{...l,path:c,message:p}})({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===xs?void 0:xs].filter(t=>!!t)});s.common.issues.push(a)}class ot{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const a=[];for(const t of r){if(t.status==="aborted")return ne;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){const a=[];for(const t of r){const n=await t.key,i=await t.value;a.push({key:n,value:i})}return ot.mergeObjectSync(e,a)}static mergeObjectSync(e,r){const a={};for(const t of r){const{key:n,value:i}=t;if(n.status==="aborted"||i.status==="aborted")return ne;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value==="__proto__"||i.value===void 0&&!t.alwaysSet||(a[n.value]=i.value)}return{status:e.value,value:a}}}const ne=Object.freeze({status:"aborted"}),Rs=s=>({status:"dirty",value:s}),_t=s=>({status:"valid",value:s}),Nn=s=>s.status==="aborted",jn=s=>s.status==="dirty",br=s=>s.status==="valid",Yr=s=>typeof Promise<"u"&&s instanceof Promise;class Nt{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ln=(s,e)=>{if(br(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Bt(s.common.issues);return this._error=r,this._error}}};function ye(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(n,i)=>{const{message:o}=s;return n.code==="invalid_enum_value"?{message:o??i.defaultError}:i.data===void 0?{message:o??a??i.defaultError}:n.code!=="invalid_type"?{message:i.defaultError}:{message:o??r??i.defaultError}},description:t}}class xe{get description(){return this._def.description}_getType(e){return Wt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ot,ctx:{common:e.parent.common,data:e.data,parsedType:Wt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Yr(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){const a={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)},t=this._parseSync({data:e,path:a.path,parent:a});return Ln(a,t)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return br(a)?{value:a.value}:{issues:r.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>br(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){const a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){const a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(Yr(t)?t:Promise.resolve(t));return Ln(a,n)}refine(e,r){const a=t=>typeof r=="string"||r===void 0?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{const i=e(t),o=()=>n.addIssue({code:Z.custom,...a(t)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>!!l||(o(),!1)):!!i||(o(),!1)})}refinement(e,r){return this._refinement((a,t)=>!!e(a)||(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new sr({schema:this,typeName:oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Vt.create(this,this._def)}nullable(){return or.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return $t.create(this)}promise(){return aa.create(this,this._def)}or(e){return ea.create([this,e],this._def)}and(e){return ta.create(this,e,this._def)}transform(e){return new sr({...ye(this._def),schema:this,typeName:oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new sa({...ye(this._def),innerType:this,defaultValue:r,typeName:oe.ZodDefault})}brand(){return new vo({typeName:oe.ZodBranded,type:this,...ye(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new na({...ye(this._def),innerType:this,catchValue:r,typeName:oe.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return en.create(this,e)}readonly(){return ia.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const kl=/^c[^\s-]{8,}$/i,Il=/^[0-9a-z]+$/,Al=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Tl=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ol=/^[a-z0-9_-]{21}$/i,Cl=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,$l=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Dl=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Ta;const Nl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,jl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ll=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ql=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ml=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Fl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,fo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Zl=new RegExp(`^${fo}$`);function po(s){let e="[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),`([01]\\d|2[0-3]):[0-5]\\d(:${e})${s.precision?"+":"?"}`}function Ul(s){return new RegExp(`^${po(s)}$`)}function zl(s){let e=`${fo}T${po(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Vl(s,e){return!(e!=="v4"&&e||!Nl.test(s))||!(e!=="v6"&&e||!Ll.test(s))}function Hl(s,e){if(!Cl.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||"typ"in t&&t?.typ!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function Bl(s,e){return!(e!=="v4"&&e||!jl.test(s))||!(e!=="v6"&&e||!ql.test(s))}class Ut extends xe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==J.string){const t=this._getOrReturnCtx(e);return B(t,{code:Z.invalid_type,expected:J.string,received:t.parsedType}),ne}const r=new ot;let a;for(const t of this._def.checks)if(t.kind==="min")e.data.length<t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_small,minimum:t.value,type:"string",inclusive:!0,exact:!1,message:t.message}),r.dirty());else if(t.kind==="max")e.data.length>t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_big,maximum:t.value,type:"string",inclusive:!0,exact:!1,message:t.message}),r.dirty());else if(t.kind==="length"){const n=e.data.length>t.value,i=e.data.length<t.value;(n||i)&&(a=this._getOrReturnCtx(e,a),n?B(a,{code:Z.too_big,maximum:t.value,type:"string",inclusive:!0,exact:!0,message:t.message}):i&&B(a,{code:Z.too_small,minimum:t.value,type:"string",inclusive:!0,exact:!0,message:t.message}),r.dirty())}else if(t.kind==="email")Dl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"email",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="emoji")Ta||(Ta=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ta.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"emoji",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="uuid")Tl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"uuid",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="nanoid")Ol.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"nanoid",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="cuid")kl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cuid",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="cuid2")Il.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cuid2",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="ulid")Al.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"ulid",code:Z.invalid_string,message:t.message}),r.dirty());else if(t.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),B(a,{validation:"url",code:Z.invalid_string,message:t.message}),r.dirty()}else t.kind==="regex"?(t.regex.lastIndex=0,t.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"regex",code:Z.invalid_string,message:t.message}),r.dirty())):t.kind==="trim"?e.data=e.data.trim():t.kind==="includes"?e.data.includes(t.value,t.position)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:{includes:t.value,position:t.position},message:t.message}),r.dirty()):t.kind==="toLowerCase"?e.data=e.data.toLowerCase():t.kind==="toUpperCase"?e.data=e.data.toUpperCase():t.kind==="startsWith"?e.data.startsWith(t.value)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:{startsWith:t.value},message:t.message}),r.dirty()):t.kind==="endsWith"?e.data.endsWith(t.value)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:{endsWith:t.value},message:t.message}),r.dirty()):t.kind==="datetime"?zl(t).test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:"datetime",message:t.message}),r.dirty()):t.kind==="date"?Zl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:"date",message:t.message}),r.dirty()):t.kind==="time"?Ul(t).test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_string,validation:"time",message:t.message}),r.dirty()):t.kind==="duration"?$l.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"duration",code:Z.invalid_string,message:t.message}),r.dirty()):t.kind==="ip"?Vl(e.data,t.version)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"ip",code:Z.invalid_string,message:t.message}),r.dirty()):t.kind==="jwt"?Hl(e.data,t.alg)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"jwt",code:Z.invalid_string,message:t.message}),r.dirty()):t.kind==="cidr"?Bl(e.data,t.version)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"cidr",code:Z.invalid_string,message:t.message}),r.dirty()):t.kind==="base64"?Ml.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"base64",code:Z.invalid_string,message:t.message}),r.dirty()):t.kind==="base64url"?Fl.test(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{validation:"base64url",code:Z.invalid_string,message:t.message}),r.dirty()):ke.assertNever(t);return{status:r.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:Z.invalid_string,...X.errToObj(a)})}_addCheck(e){return new Ut({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...X.errToObj(e)})}url(e){return this._addCheck({kind:"url",...X.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...X.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...X.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...X.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...X.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...X.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...X.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...X.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...X.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...X.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...X.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...X.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:e?.precision===void 0?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...X.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:e?.precision===void 0?null:e?.precision,...X.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...X.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...X.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...X.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...X.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...X.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...X.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...X.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...X.errToObj(r)})}nonempty(e){return this.min(1,X.errToObj(e))}trim(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ut({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}function Gl(s,e){const r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a;return Number.parseInt(s.toFixed(t).replace(".",""))%Number.parseInt(e.toFixed(t).replace(".",""))/10**t}Ut.create=s=>new Ut({checks:[],typeName:oe.ZodString,coerce:s?.coerce??!1,...ye(s)});class wr extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==J.number){const t=this._getOrReturnCtx(e);return B(t,{code:Z.invalid_type,expected:J.number,received:t.parsedType}),ne}let r;const a=new ot;for(const t of this._def.checks)t.kind==="int"?ke.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_type,expected:"integer",received:"float",message:t.message}),a.dirty()):t.kind==="min"?(t.inclusive?e.data<t.value:e.data<=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_small,minimum:t.value,type:"number",inclusive:t.inclusive,exact:!1,message:t.message}),a.dirty()):t.kind==="max"?(t.inclusive?e.data>t.value:e.data>=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_big,maximum:t.value,type:"number",inclusive:t.inclusive,exact:!1,message:t.message}),a.dirty()):t.kind==="multipleOf"?Gl(e.data,t.value)!==0&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.not_multiple_of,multipleOf:t.value,message:t.message}),a.dirty()):t.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.not_finite,message:t.message}),a.dirty()):ke.assertNever(t);return{status:a.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,X.toString(r))}gt(e,r){return this.setLimit("min",e,!1,X.toString(r))}lte(e,r){return this.setLimit("max",e,!0,X.toString(r))}lt(e,r){return this.setLimit("max",e,!1,X.toString(r))}setLimit(e,r,a,t){return new wr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:X.toString(t)}]})}_addCheck(e){return new wr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:X.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:X.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:X.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:X.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:X.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:X.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:X.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:X.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:X.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ke.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}}wr.create=s=>new wr({checks:[],typeName:oe.ZodNumber,coerce:s?.coerce||!1,...ye(s)});class Or extends xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==J.bigint)return this._getInvalidInput(e);let r;const a=new ot;for(const t of this._def.checks)t.kind==="min"?(t.inclusive?e.data<t.value:e.data<=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_small,type:"bigint",minimum:t.value,inclusive:t.inclusive,message:t.message}),a.dirty()):t.kind==="max"?(t.inclusive?e.data>t.value:e.data>=t.value)&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_big,type:"bigint",maximum:t.value,inclusive:t.inclusive,message:t.message}),a.dirty()):t.kind==="multipleOf"?e.data%t.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.not_multiple_of,multipleOf:t.value,message:t.message}),a.dirty()):ke.assertNever(t);return{status:a.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.bigint,received:r.parsedType}),ne}gte(e,r){return this.setLimit("min",e,!0,X.toString(r))}gt(e,r){return this.setLimit("min",e,!1,X.toString(r))}lte(e,r){return this.setLimit("max",e,!0,X.toString(r))}lt(e,r){return this.setLimit("max",e,!1,X.toString(r))}setLimit(e,r,a,t){return new Or({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:X.toString(t)}]})}_addCheck(e){return new Or({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:X.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:X.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:X.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:X.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:X.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Or.create=s=>new Or({checks:[],typeName:oe.ZodBigInt,coerce:s?.coerce??!1,...ye(s)});class ks extends xe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==J.boolean){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.boolean,received:r.parsedType}),ne}return _t(e.data)}}ks.create=s=>new ks({typeName:oe.ZodBoolean,coerce:s?.coerce||!1,...ye(s)});class Xr extends xe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==J.date){const t=this._getOrReturnCtx(e);return B(t,{code:Z.invalid_type,expected:J.date,received:t.parsedType}),ne}if(Number.isNaN(e.data.getTime()))return B(this._getOrReturnCtx(e),{code:Z.invalid_date}),ne;const r=new ot;let a;for(const t of this._def.checks)t.kind==="min"?e.data.getTime()<t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_small,message:t.message,inclusive:!0,exact:!1,minimum:t.value,type:"date"}),r.dirty()):t.kind==="max"?e.data.getTime()>t.value&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_big,message:t.message,inclusive:!0,exact:!1,maximum:t.value,type:"date"}),r.dirty()):ke.assertNever(t);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Xr({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:X.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:X.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Xr.create=s=>new Xr({checks:[],coerce:s?.coerce||!1,typeName:oe.ZodDate,...ye(s)});class qn extends xe{_parse(e){if(this._getType(e)!==J.symbol){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.symbol,received:r.parsedType}),ne}return _t(e.data)}}qn.create=s=>new qn({typeName:oe.ZodSymbol,...ye(s)});class Is extends xe{_parse(e){if(this._getType(e)!==J.undefined){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.undefined,received:r.parsedType}),ne}return _t(e.data)}}Is.create=s=>new Is({typeName:oe.ZodUndefined,...ye(s)});class As extends xe{_parse(e){if(this._getType(e)!==J.null){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.null,received:r.parsedType}),ne}return _t(e.data)}}As.create=s=>new As({typeName:oe.ZodNull,...ye(s)});class Mn extends xe{constructor(){super(...arguments),this._any=!0}_parse(e){return _t(e.data)}}Mn.create=s=>new Mn({typeName:oe.ZodAny,...ye(s)});class Ts extends xe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return _t(e.data)}}Ts.create=s=>new Ts({typeName:oe.ZodUnknown,...ye(s)});class er extends xe{_parse(e){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.never,received:r.parsedType}),ne}}er.create=s=>new er({typeName:oe.ZodNever,...ye(s)});class Fn extends xe{_parse(e){if(this._getType(e)!==J.undefined){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.void,received:r.parsedType}),ne}return _t(e.data)}}Fn.create=s=>new Fn({typeName:oe.ZodVoid,...ye(s)});class $t extends xe{_parse(e){const{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==J.array)return B(r,{code:Z.invalid_type,expected:J.array,received:r.parsedType}),ne;if(t.exactLength!==null){const i=r.data.length>t.exactLength.value,o=r.data.length<t.exactLength.value;(i||o)&&(B(r,{code:i?Z.too_big:Z.too_small,minimum:o?t.exactLength.value:void 0,maximum:i?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(B(r,{code:Z.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(B(r,{code:Z.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>t.type._parseAsync(new Nt(r,i,r.path,o)))).then(i=>ot.mergeArray(a,i));const n=[...r.data].map((i,o)=>t.type._parseSync(new Nt(r,i,r.path,o)));return ot.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new $t({...this._def,minLength:{value:e,message:X.toString(r)}})}max(e,r){return new $t({...this._def,maxLength:{value:e,message:X.toString(r)}})}length(e,r){return new $t({...this._def,exactLength:{value:e,message:X.toString(r)}})}nonempty(e){return this.min(1,e)}}function mr(s){if(s instanceof Qe){const e={};for(const r in s.shape){const a=s.shape[r];e[r]=Vt.create(mr(a))}return new Qe({...s._def,shape:()=>e})}return s instanceof $t?new $t({...s._def,type:mr(s.element)}):s instanceof Vt?Vt.create(mr(s.unwrap())):s instanceof or?or.create(mr(s.unwrap())):s instanceof nr?nr.create(s.items.map(e=>mr(e))):s}$t.create=(s,e)=>new $t({type:s,minLength:null,maxLength:null,exactLength:null,typeName:oe.ZodArray,...ye(e)});class Qe extends xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=ke.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==J.object){const l=this._getOrReturnCtx(e);return B(l,{code:Z.invalid_type,expected:J.object,received:l.parsedType}),ne}const{status:r,ctx:a}=this._processInputParams(e),{shape:t,keys:n}=this._getCached(),i=[];if(!(this._def.catchall instanceof er&&this._def.unknownKeys==="strip"))for(const l in a.data)n.includes(l)||i.push(l);const o=[];for(const l of n){const c=t[l],h=a.data[l];o.push({key:{status:"valid",value:l},value:c._parse(new Nt(a,h,a.path,l)),alwaysSet:l in a.data})}if(this._def.catchall instanceof er){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of i)o.push({key:{status:"valid",value:c},value:{status:"valid",value:a.data[c]}});else if(l==="strict")i.length>0&&(B(a,{code:Z.unrecognized_keys,keys:i}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of i){const h=a.data[c];o.push({key:{status:"valid",value:c},value:l._parse(new Nt(a,h,a.path,c)),alwaysSet:c in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of o){const h=await c.key,p=await c.value;l.push({key:h,value:p,alwaysSet:c.alwaysSet})}return l}).then(l=>ot.mergeObjectSync(r,l)):ot.mergeObjectSync(r,o)}get shape(){return this._def.shape()}strict(e){return X.errToObj,new Qe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{const t=this._def.errorMap?.(r,a).message??a.defaultError;return r.code==="unrecognized_keys"?{message:X.errToObj(e).message??t}:{message:t}}}:{}})}strip(){return new Qe({...this._def,unknownKeys:"strip"})}passthrough(){return new Qe({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:oe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Qe({...this._def,catchall:e})}pick(e){const r={};for(const a of ke.objectKeys(e))e[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new Qe({...this._def,shape:()=>r})}omit(e){const r={};for(const a of ke.objectKeys(this.shape))e[a]||(r[a]=this.shape[a]);return new Qe({...this._def,shape:()=>r})}deepPartial(){return mr(this)}partial(e){const r={};for(const a of ke.objectKeys(this.shape)){const t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}return new Qe({...this._def,shape:()=>r})}required(e){const r={};for(const a of ke.objectKeys(this.shape))if(e&&!e[a])r[a]=this.shape[a];else{let t=this.shape[a];for(;t instanceof Vt;)t=t._def.innerType;r[a]=t}return new Qe({...this._def,shape:()=>r})}keyof(){return mo(ke.objectKeys(this.shape))}}Qe.create=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strip",catchall:er.create(),typeName:oe.ZodObject,...ye(e)}),Qe.strictCreate=(s,e)=>new Qe({shape:()=>s,unknownKeys:"strict",catchall:er.create(),typeName:oe.ZodObject,...ye(e)}),Qe.lazycreate=(s,e)=>new Qe({shape:s,unknownKeys:"strip",catchall:er.create(),typeName:oe.ZodObject,...ye(e)});class ea extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a=this._def.options;if(r.common.async)return Promise.all(a.map(async t=>{const n={...r,common:{...r.common,issues:[]},parent:null};return{result:await t._parseAsync({data:r.data,path:r.path,parent:n}),ctx:n}})).then(function(t){for(const i of t)if(i.result.status==="valid")return i.result;for(const i of t)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const n=t.map(i=>new Bt(i.ctx.common.issues));return B(r,{code:Z.invalid_union,unionErrors:n}),ne});{let t;const n=[];for(const o of a){const l={...r,common:{...r.common,issues:[]},parent:null},c=o._parseSync({data:r.data,path:r.path,parent:l});if(c.status==="valid")return c;c.status!=="dirty"||t||(t={result:c,ctx:l}),l.common.issues.length&&n.push(l.common.issues)}if(t)return r.common.issues.push(...t.ctx.common.issues),t.result;const i=n.map(o=>new Bt(o));return B(r,{code:Z.invalid_union,unionErrors:i}),ne}}get options(){return this._def.options}}ea.create=(s,e)=>new ea({options:s,typeName:oe.ZodUnion,...ye(e)});const Jt=s=>s instanceof Cs?Jt(s.schema):s instanceof sr?Jt(s.innerType()):s instanceof ra?[s.value]:s instanceof ir?s.options:s instanceof $s?ke.objectValues(s.enum):s instanceof sa?Jt(s._def.innerType):s instanceof Is?[void 0]:s instanceof As?[null]:s instanceof Vt?[void 0,...Jt(s.unwrap())]:s instanceof or?[null,...Jt(s.unwrap())]:s instanceof vo||s instanceof ia?Jt(s.unwrap()):s instanceof na?Jt(s._def.innerType):[];class Ys extends xe{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.object)return B(r,{code:Z.invalid_type,expected:J.object,received:r.parsedType}),ne;const a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(B(r,{code:Z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),ne)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){const t=new Map;for(const n of r){const i=Jt(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(t.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);t.set(o,n)}}return new Ys({typeName:oe.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,...ye(a)})}}function Os(s,e){const r=Wt(s),a=Wt(e);if(s===e)return{valid:!0,data:s};if(r===J.object&&a===J.object){const t=ke.objectKeys(e),n=ke.objectKeys(s).filter(o=>t.indexOf(o)!==-1),i={...s,...e};for(const o of n){const l=Os(s[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}if(r===J.array&&a===J.array){if(s.length!==e.length)return{valid:!1};const t=[];for(let n=0;n<s.length;n++){const i=Os(s[n],e[n]);if(!i.valid)return{valid:!1};t.push(i.data)}return{valid:!0,data:t}}return r===J.date&&a===J.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ta extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=(n,i)=>{if(Nn(n)||Nn(i))return ne;const o=Os(n.value,i.value);return o.valid?((jn(n)||jn(i))&&r.dirty(),{status:r.value,value:o.data}):(B(a,{code:Z.invalid_intersection_types}),ne)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>t(n,i)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}ta.create=(s,e,r)=>new ta({left:s,right:e,typeName:oe.ZodIntersection,...ye(r)});class nr extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.array)return B(a,{code:Z.invalid_type,expected:J.array,received:a.parsedType}),ne;if(a.data.length<this._def.items.length)return B(a,{code:Z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ne;!this._def.rest&&a.data.length>this._def.items.length&&(B(a,{code:Z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const t=[...a.data].map((n,i)=>{const o=this._def.items[i]||this._def.rest;return o?o._parse(new Nt(a,n,a.path,i)):null}).filter(n=>!!n);return a.common.async?Promise.all(t).then(n=>ot.mergeArray(r,n)):ot.mergeArray(r,t)}get items(){return this._def.items}rest(e){return new nr({...this._def,rest:e})}}nr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new nr({items:s,typeName:oe.ZodTuple,rest:null,...ye(e)})};class Xs extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.object)return B(a,{code:Z.invalid_type,expected:J.object,received:a.parsedType}),ne;const t=[],n=this._def.keyType,i=this._def.valueType;for(const o in a.data)t.push({key:n._parse(new Nt(a,o,a.path,o)),value:i._parse(new Nt(a,a.data[o],a.path,o)),alwaysSet:o in a.data});return a.common.async?ot.mergeObjectAsync(r,t):ot.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return new Xs(r instanceof xe?{keyType:e,valueType:r,typeName:oe.ZodRecord,...ye(a)}:{keyType:Ut.create(),valueType:e,typeName:oe.ZodRecord,...ye(r)})}}class Zn extends xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.map)return B(a,{code:Z.invalid_type,expected:J.map,received:a.parsedType}),ne;const t=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([o,l],c)=>({key:t._parse(new Nt(a,o,a.path,[c,"key"])),value:n._parse(new Nt(a,l,a.path,[c,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return ne;c.status!=="dirty"&&h.status!=="dirty"||r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}})}{const o=new Map;for(const l of i){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return ne;c.status!=="dirty"&&h.status!=="dirty"||r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}}}}Zn.create=(s,e,r)=>new Zn({valueType:e,keyType:s,typeName:oe.ZodMap,...ye(r)});class Cr extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.set)return B(a,{code:Z.invalid_type,expected:J.set,received:a.parsedType}),ne;const t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&(B(a,{code:Z.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&(B(a,{code:Z.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());const n=this._def.valueType;function i(l){const c=new Set;for(const h of l){if(h.status==="aborted")return ne;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}const o=[...a.data.values()].map((l,c)=>n._parse(new Nt(a,l,a.path,c)));return a.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,r){return new Cr({...this._def,minSize:{value:e,message:X.toString(r)}})}max(e,r){return new Cr({...this._def,maxSize:{value:e,message:X.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Cr.create=(s,e)=>new Cr({valueType:s,minSize:null,maxSize:null,typeName:oe.ZodSet,...ye(e)});class Cs extends xe{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Cs.create=(s,e)=>new Cs({getter:s,typeName:oe.ZodLazy,...ye(e)});class ra extends xe{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return B(r,{received:r.data,code:Z.invalid_literal,expected:this._def.value}),ne}return{status:"valid",value:e.data}}get value(){return this._def.value}}function mo(s,e){return new ir({values:s,typeName:oe.ZodEnum,...ye(e)})}ra.create=(s,e)=>new ra({value:s,typeName:oe.ZodLiteral,...ye(e)});class ir extends xe{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),a=this._def.values;return B(r,{expected:ke.joinValues(a),received:r.parsedType,code:Z.invalid_type}),ne}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),a=this._def.values;return B(r,{received:r.data,code:Z.invalid_enum_value,options:a}),ne}return _t(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return ir.create(e,{...this._def,...r})}exclude(e,r=this._def){return ir.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}}ir.create=mo;class $s extends xe{_parse(e){const r=ke.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==J.string&&a.parsedType!==J.number){const t=ke.objectValues(r);return B(a,{expected:ke.joinValues(t),received:a.parsedType,code:Z.invalid_type}),ne}if(this._cache||(this._cache=new Set(ke.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const t=ke.objectValues(r);return B(a,{received:a.data,code:Z.invalid_enum_value,options:t}),ne}return _t(e.data)}get enum(){return this._def.values}}$s.create=(s,e)=>new $s({values:s,typeName:oe.ZodNativeEnum,...ye(e)});class aa extends xe{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.promise&&r.common.async===!1)return B(r,{code:Z.invalid_type,expected:J.promise,received:r.parsedType}),ne;const a=r.parsedType===J.promise?r.data:Promise.resolve(r.data);return _t(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}}aa.create=(s,e)=>new aa({type:s,typeName:oe.ZodPromise,...ye(e)});class sr extends xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:i=>{B(a,i),i.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){const i=t.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return ne;const l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?ne:l.status==="dirty"||r.value==="dirty"?Rs(l.value):l});{if(r.value==="aborted")return ne;const o=this._def.schema._parseSync({data:i,path:a.path,parent:a});return o.status==="aborted"?ne:o.status==="dirty"||r.value==="dirty"?Rs(o.value):o}}if(t.type==="refinement"){const i=o=>{const l=t.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?ne:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?ne:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(t.type==="transform"){if(a.common.async===!1){const i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!br(i))return ne;const o=t.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>br(i)?Promise.resolve(t.transform(i.value,n)).then(o=>({status:r.value,value:o})):ne)}ke.assertNever(t)}}sr.create=(s,e,r)=>new sr({schema:s,typeName:oe.ZodEffects,effect:e,...ye(r)}),sr.createWithPreprocess=(s,e,r)=>new sr({schema:e,effect:{type:"preprocess",transform:s},typeName:oe.ZodEffects,...ye(r)});class Vt extends xe{_parse(e){return this._getType(e)===J.undefined?_t(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Vt.create=(s,e)=>new Vt({innerType:s,typeName:oe.ZodOptional,...ye(e)});class or extends xe{_parse(e){return this._getType(e)===J.null?_t(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}or.create=(s,e)=>new or({innerType:s,typeName:oe.ZodNullable,...ye(e)});class sa extends xe{_parse(e){const{ctx:r}=this._processInputParams(e);let a=r.data;return r.parsedType===J.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}sa.create=(s,e)=>new sa({innerType:s,typeName:oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ye(e)});class na extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Yr(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Bt(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new Bt(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}na.create=(s,e)=>new na({innerType:s,typeName:oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ye(e)});class Un extends xe{_parse(e){if(this._getType(e)!==J.nan){const r=this._getOrReturnCtx(e);return B(r,{code:Z.invalid_type,expected:J.nan,received:r.parsedType}),ne}return{status:"valid",value:e.data}}}Un.create=s=>new Un({typeName:oe.ZodNaN,...ye(s)});class vo extends xe{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class en extends xe{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const t=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ne:t.status==="dirty"?(r.dirty(),Rs(t.value)):this._def.out._parseAsync({data:t.value,path:a.path,parent:a})})();{const t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ne:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new en({in:e,out:r,typeName:oe.ZodPipeline})}}class ia extends xe{_parse(e){const r=this._def.innerType._parse(e),a=t=>(br(t)&&(t.value=Object.freeze(t.value)),t);return Yr(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}}var oe;ia.create=(s,e)=>new ia({innerType:s,typeName:oe.ZodReadonly,...ye(e)}),(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(oe||(oe={}));const Q=Ut.create,it=wr.create,mt=ks.create,$r=Ts.create,Ye=(er.create,$t.create),Y=Qe.create,nt=ea.create,Ql=Ys.create,Lr=(ta.create,nr.create,Xs.create),me=ra.create,Gt=ir.create,L=(aa.create,Vt.create),_a=(or.create,"2.0"),go=nt([Q(),it().int()]),yo=Q(),Kl=Y({progressToken:L(go)}).passthrough(),bt=Y({_meta:L(Kl)}).passthrough(),ft=Y({method:Q(),params:L(bt)}),qr=Y({_meta:L(Y({}).passthrough())}).passthrough(),Lt=Y({method:Q(),params:L(qr)}),wt=Y({_meta:L(Y({}).passthrough())}).passthrough(),ba=nt([Q(),it().int()]),Jl=Y({jsonrpc:me(_a),id:ba}).merge(ft).strict(),Wl=Y({jsonrpc:me(_a)}).merge(Lt).strict(),Yl=Y({jsonrpc:me(_a),id:ba,result:wt}).strict();var zn;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(zn||(zn={}));const Xl=nt([Jl,Wl,Yl,Y({jsonrpc:me(_a),id:ba,error:Y({code:it().int(),message:Q(),data:L($r())})}).strict()]),Vn=wt.strict(),Hn=Lt.extend({method:me("notifications/cancelled"),params:qr.extend({requestId:ba,reason:Q().optional()})}),Mr=Y({name:Q(),title:L(Q())}).passthrough(),_o=Mr.extend({version:Q()}),ec=Y({experimental:L(Y({}).passthrough()),sampling:L(Y({}).passthrough()),elicitation:L(Y({}).passthrough()),roots:L(Y({listChanged:L(mt())}).passthrough())}).passthrough(),tc=ft.extend({method:me("initialize"),params:bt.extend({protocolVersion:Q(),capabilities:ec,clientInfo:_o})}),rc=Y({experimental:L(Y({}).passthrough()),logging:L(Y({}).passthrough()),completions:L(Y({}).passthrough()),prompts:L(Y({listChanged:L(mt())}).passthrough()),resources:L(Y({subscribe:L(mt()),listChanged:L(mt())}).passthrough()),tools:L(Y({listChanged:L(mt())}).passthrough())}).passthrough(),ac=wt.extend({protocolVersion:Q(),capabilities:rc,serverInfo:_o,instructions:L(Q())}),sc=Lt.extend({method:me("notifications/initialized")}),Bn=ft.extend({method:me("ping")}),nc=Y({progress:it(),total:L(it()),message:L(Q())}).passthrough(),Gn=Lt.extend({method:me("notifications/progress"),params:qr.merge(nc).extend({progressToken:go})}),wa=ft.extend({params:bt.extend({cursor:L(yo)}).optional()}),Sa=wt.extend({nextCursor:L(yo)}),bo=Y({uri:Q(),mimeType:L(Q()),_meta:L(Y({}).passthrough())}).passthrough(),wo=bo.extend({text:Q()}),tn=Q().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),So=bo.extend({blob:tn}),Eo=Mr.extend({uri:Q(),description:L(Q()),mimeType:L(Q()),_meta:L(Y({}).passthrough())}),ic=Mr.extend({uriTemplate:Q(),description:L(Q()),mimeType:L(Q()),_meta:L(Y({}).passthrough())}),oc=wa.extend({method:me("resources/list")}),lc=Sa.extend({resources:Ye(Eo)}),cc=wa.extend({method:me("resources/templates/list")}),uc=Sa.extend({resourceTemplates:Ye(ic)}),dc=ft.extend({method:me("resources/read"),params:bt.extend({uri:Q()})}),hc=wt.extend({contents:Ye(nt([wo,So]))}),fc=Lt.extend({method:me("notifications/resources/list_changed")}),pc=ft.extend({method:me("resources/subscribe"),params:bt.extend({uri:Q()})}),mc=ft.extend({method:me("resources/unsubscribe"),params:bt.extend({uri:Q()})}),vc=Lt.extend({method:me("notifications/resources/updated"),params:qr.extend({uri:Q()})}),gc=Y({name:Q(),description:L(Q()),required:L(mt())}).passthrough(),yc=Mr.extend({description:L(Q()),arguments:L(Ye(gc)),_meta:L(Y({}).passthrough())}),_c=wa.extend({method:me("prompts/list")}),bc=Sa.extend({prompts:Ye(yc)}),wc=ft.extend({method:me("prompts/get"),params:bt.extend({name:Q(),arguments:L(Lr(Q()))})}),rn=Y({type:me("text"),text:Q(),_meta:L(Y({}).passthrough())}).passthrough(),an=Y({type:me("image"),data:tn,mimeType:Q(),_meta:L(Y({}).passthrough())}).passthrough(),sn=Y({type:me("audio"),data:tn,mimeType:Q(),_meta:L(Y({}).passthrough())}).passthrough(),Sc=Y({type:me("resource"),resource:nt([wo,So]),_meta:L(Y({}).passthrough())}).passthrough(),Po=nt([rn,an,sn,Eo.extend({type:me("resource_link")}),Sc]),Ec=Y({role:Gt(["user","assistant"]),content:Po}).passthrough(),Pc=wt.extend({description:L(Q()),messages:Ye(Ec)}),xc=Lt.extend({method:me("notifications/prompts/list_changed")}),Rc=Y({title:L(Q()),readOnlyHint:L(mt()),destructiveHint:L(mt()),idempotentHint:L(mt()),openWorldHint:L(mt())}).passthrough(),kc=Mr.extend({description:L(Q()),inputSchema:Y({type:me("object"),properties:L(Y({}).passthrough()),required:L(Ye(Q()))}).passthrough(),outputSchema:L(Y({type:me("object"),properties:L(Y({}).passthrough()),required:L(Ye(Q()))}).passthrough()),annotations:L(Rc),_meta:L(Y({}).passthrough())}),Ic=wa.extend({method:me("tools/list")}),Ac=Sa.extend({tools:Ye(kc)}),xo=wt.extend({content:Ye(Po).default([]),structuredContent:Y({}).passthrough().optional(),isError:L(mt())}),Tc=(xo.or(wt.extend({toolResult:$r()})),ft.extend({method:me("tools/call"),params:bt.extend({name:Q(),arguments:L(Lr($r()))})})),Oc=Lt.extend({method:me("notifications/tools/list_changed")}),Ro=Gt(["debug","info","notice","warning","error","critical","alert","emergency"]),Cc=ft.extend({method:me("logging/setLevel"),params:bt.extend({level:Ro})}),$c=Lt.extend({method:me("notifications/message"),params:qr.extend({level:Ro,logger:L(Q()),data:$r()})}),Dc=Y({name:Q().optional()}).passthrough(),Nc=Y({hints:L(Ye(Dc)),costPriority:L(it().min(0).max(1)),speedPriority:L(it().min(0).max(1)),intelligencePriority:L(it().min(0).max(1))}).passthrough(),jc=Y({role:Gt(["user","assistant"]),content:nt([rn,an,sn])}).passthrough(),Lc=ft.extend({method:me("sampling/createMessage"),params:bt.extend({messages:Ye(jc),systemPrompt:L(Q()),includeContext:L(Gt(["none","thisServer","allServers"])),temperature:L(it()),maxTokens:it().int(),stopSequences:L(Ye(Q())),metadata:L(Y({}).passthrough()),modelPreferences:L(Nc)})}),qc=wt.extend({model:Q(),stopReason:L(Gt(["endTurn","stopSequence","maxTokens"]).or(Q())),role:Gt(["user","assistant"]),content:Ql("type",[rn,an,sn])}),Mc=nt([Y({type:me("boolean"),title:L(Q()),description:L(Q()),default:L(mt())}).passthrough(),Y({type:me("string"),title:L(Q()),description:L(Q()),minLength:L(it()),maxLength:L(it()),format:L(Gt(["email","uri","date","date-time"]))}).passthrough(),Y({type:Gt(["number","integer"]),title:L(Q()),description:L(Q()),minimum:L(it()),maximum:L(it())}).passthrough(),Y({type:me("string"),title:L(Q()),description:L(Q()),enum:Ye(Q()),enumNames:L(Ye(Q()))}).passthrough()]),Fc=ft.extend({method:me("elicitation/create"),params:bt.extend({message:Q(),requestedSchema:Y({type:me("object"),properties:Lr(Q(),Mc),required:L(Ye(Q()))}).passthrough()})}),Zc=wt.extend({action:Gt(["accept","decline","cancel"]),content:L(Lr(Q(),$r()))}),Uc=Y({type:me("ref/resource"),uri:Q()}).passthrough(),zc=Y({type:me("ref/prompt"),name:Q()}).passthrough(),Vc=ft.extend({method:me("completion/complete"),params:bt.extend({ref:nt([zc,Uc]),argument:Y({name:Q(),value:Q()}).passthrough(),context:L(Y({arguments:L(Lr(Q(),Q()))}))})}),Hc=wt.extend({completion:Y({values:Ye(Q()).max(100),total:L(it().int()),hasMore:L(mt())}).passthrough()}),Bc=Y({uri:Q().startsWith("file://"),name:L(Q()),_meta:L(Y({}).passthrough())}).passthrough(),Gc=ft.extend({method:me("roots/list")}),Qc=wt.extend({roots:Ye(Bc)}),Kc=Lt.extend({method:me("notifications/roots/list_changed")});nt([Bn,tc,Vc,Cc,wc,_c,oc,cc,dc,pc,mc,Tc,Ic]),nt([Hn,Gn,sc,Kc]),nt([Vn,qc,Zc,Qc]),nt([Bn,Lc,Fc,Gc]),nt([Hn,Gn,$c,vc,fc,Oc,xc]),nt([Vn,ac,Hc,Pc,bc,lc,uc,hc,xo,Ac]);class nn{sessionId;onmessage;onerror;onclose;_port;_started=!1;_closed=!1;constructor(e,r){if(!e)throw new Error("MessagePort is required");this._port=e,this.sessionId=r||this.generateId(),this._port.onmessage=a=>{try{const t=Xl.parse(a.data);this.onmessage?.(t)}catch(t){const n=new Error(`Failed to parse message: ${t}`);this.onerror?.(n)}},this._port.onmessageerror=a=>{const t=new Error(`MessagePort error: ${JSON.stringify(a)}`);this.onerror?.(t)}}static generateSessionId(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`${Date.now().toString(36)}-${Math.random().toString(36).substring(2,10)}`}async start(){if(this._started)throw new Error("BrowserContextTransport already started! If using Client or Server class, note that connect() calls start() automatically.");if(this._closed)throw new Error("Cannot start a closed BrowserContextTransport");this._started=!0,this._port.start()}async send(e){if(this._closed)throw new Error("Cannot send on a closed BrowserContextTransport");return new Promise((r,a)=>{try{this._port.postMessage(e),r()}catch(t){const n=t instanceof Error?t:new Error(String(t));this.onerror?.(n),a(n)}})}async close(){this._closed||(this._closed=!0,this._port.close(),this.onclose?.())}generateId(){return nn.generateSessionId()}}let Qr=null;const Qn=()=>(Qr&&document.contains(Qr)||(Qr=document.querySelector('iframe[src*="angie/"]')),Qr),Kn=(s,e)=>{console.log("postMessageToAngieIframe",s,e);const r=Qn();if(!r?.contentWindow)return!1;const a=(()=>{const t=Qn();if(!t)return null;try{return new URL(t.src).origin}catch(n){return console.error("Error parsing iframe URL:",n),null}})();return a?(r.contentWindow.postMessage(s,a),!0):(console.error("Could not determine target origin for Angie iframe"),!1)};let Oa=!1;const Jc="open",Wc="closed";function Yc(){if(typeof window>"u")return 370;try{const s=window.localStorage.getItem("angie_sidebar_width");if(s){const e=parseInt(s,10);if(e>=350&&e<=590)return e}}catch{console.warn("localStorage not available")}return 370}function Xc(s){(function(){if(typeof document>"u"||Oa)return;const e="angie-sidebar-styles";if(document.getElementById(e))return void(Oa=!0);const r=document.createElement("style");r.id=e,r.textContent=`/* Angie Sidebar - CSS Variables */
:root {
    --angie-sidebar-z-index: 1200; /* below MUI popups, elementor popups and media library modal */
    --angie-sidebar-width: 330px;
    --angie-sidebar-transition: margin 0.3s ease-in-out, transform 0.3s ease-in-out;
    /* Direction-aware transform values for sidebar positioning */
    --angie-sidebar-hide-transform: translateX(-100%); /* LTR: hide to the left */
    --angie-sidebar-show-transform: translateX(0);
}

/* RTL-specific transform values */
[dir="rtl"] {
    --angie-sidebar-hide-transform: translateX(100%); /* RTL: hide to the right */
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
    :root {
        --angie-sidebar-transition: none;
    }
}

/* Apply transitions only when user is actively toggling */
body.angie-sidebar-transitioning {
    transition: var(--angie-sidebar-transition) !important;
}

body.angie-sidebar-transitioning #angie-sidebar-container {
    transition: var(--angie-sidebar-transition) !important;
}

/* LTR Layout (default) - Push content to the right */
@media (min-width: 768px) {
    body.angie-sidebar-active {
        padding-inline-start: var(--angie-sidebar-width) !important;
    }

    body.angie-sidebar-active #angie-body-top-padding {
        width: 100%;
        height: 8px;
    }

    /* Push WordPress Admin Bar - LTR */
    body.angie-sidebar-active #wpadminbar {
        inset-inline-start: var(--angie-sidebar-width) !important;
        inset-inline-end: 8px !important;
        width: calc(100% - 8px - var(--angie-sidebar-width)) !important;
        margin-top: 8px;
    }

    /* Sidebar container - LTR */
    #angie-sidebar-container {
        position: fixed;
        top: 0;
        inset-inline-start: 0;
        width: var(--angie-sidebar-width);
        height: 100vh;
        z-index: var(--angie-sidebar-z-index) !important; /* below elementor popups and media library modal */
        background: #FCFCFC;
        transform: var(--angie-sidebar-hide-transform);
        outline: none;
        overflow: hidden;
        /* No default transition - only when transitioning */
    }

    /* Resize handle */
    #angie-sidebar-container::after {
        content: '';
        position: absolute;
        top: 0;
        inset-inline-end: 0;
        width: 4px;
        height: 100%;
        cursor: ew-resize;
        background: transparent;
        z-index: 1000001;
    }

    /* Pink border during resize */
    #angie-sidebar-container.angie-resizing {
        border-inline-end-color: #ff69b4 !important;
        border-inline-end-width: 2px !important;
    }

    /* Disable iframe pointer events during resize */
    #angie-sidebar-container.angie-resizing iframe#angie-iframe {
        pointer-events: none !important;
    }
}

/* Active states */
body.angie-sidebar-active #angie-sidebar-container {
    transform: var(--angie-sidebar-show-transform);
}

/* Studio mode - sidebar takes full width */
@media (min-width: 768px) {
    html.angie-studio-active body.angie-sidebar-active #angie-sidebar-container {
        width: 100%;
    }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    #angie-sidebar-container {
        border-color: #000;
        box-shadow: none;
    }
}

/* Screen reader only class */
.angie-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Plugin conflict resolution */
body.angie-sidebar-active {
    /* Reset common conflicting styles */
    box-sizing: border-box !important;
    position: relative !important;
}

#angie-sidebar-toggle {
    z-index: 99999 !important;
}
`;const a=document.head||document.getElementsByTagName("head")[0];a.insertBefore(r,a.firstChild),Oa=!0})(),typeof window<"u"&&(window.toggleAngieSidebar=(function(e){return function(r,a){const t=document.body,n=document.getElementById("angie-sidebar-container");if(!n)return void console.warn("Angie Sidebar: Required elements not found!");const i=t.classList.contains("angie-sidebar-active"),o=r!==void 0?r:!i;a||(t.classList.add("angie-sidebar-transitioning"),setTimeout(function(){t.classList.remove("angie-sidebar-transitioning")},300)),o?t.classList.add("angie-sidebar-active"):t.classList.remove("angie-sidebar-active"),o&&setTimeout(function(){Kn({type:"focusInput"})},a?0:300),(function(c){try{localStorage.setItem("angie_sidebar_state",c)}catch{console.warn("localStorage not available")}})(o?Jc:Wc);const l=new CustomEvent("angieSidebarToggle",{detail:{isOpen:o,sidebar:n,skipTransition:a}});document.dispatchEvent(l),Kn({type:st.ANGIE_SIDEBAR_TOGGLED,payload:{state:o?"opened":"closed"}})}})(),window.addEventListener("message",function(e){if(e.data&&e.data.type==="toggleAngieSidebar"){const{force:r,skipTransition:a}=e.data.payload||{};window.toggleAngieSidebar&&window.toggleAngieSidebar(r,a)}}))}const Jn=(s,e)=>{const r=document.getElementById("angie-sidebar-container");r&&r.setAttribute("aria-hidden",e?"false":"true"),e?s.removeAttribute("tabindex"):s.setAttribute("tabindex","-1")},_r=(s,e)=>{s.postMessage({status:"success",payload:e})},Ca=(s,e)=>{s.postMessage({status:"error",payload:e})};var Wn;(Wn||(Wn={})).POST_MESSAGE="postMessage";const Ct={open:!1,iframe:null,iframeUrlObject:null};function Yn(){const s=new URL(window.location.href);s.searchParams.set("start-oauth","1"),console.log("OAuth: Redirecting to wp-admin with OAuth:",s.toString()),window.location.href=s.toString()}const eu=()=>{window.addEventListener("message",s=>{if(s.origin===Ct.iframeUrlObject?.origin)switch(s.data.type){case"OAUTH_GET_CODE_AND_STATE":(e=>{const r=new URLSearchParams(window.location.search),a=r.get("oauth_code"),t=r.get("oauth_state");if(a&&t)_r(e,{code:a,state:t});else{const n=r.get("oauth_error");if(n){Ca(e,{message:n,code:a||null,state:t||null});const i=new URL(window.location.href);i.searchParams.delete("oauth_error"),history.replaceState({},"",i.toString())}else _r(e,{message:"No OAuth error found"})}})(s.ports[0]);break;case"OAUTH_GET_TOP_URL":console.log("OAuth: Iframe requested top window URL via MessageChannel"),_r(s.ports[0],{topUrl:window.location.href});break;case"OAUTH_REDIRECT_TOP_WINDOW":console.log("OAuth: Iframe requested top window redirect to:",s.data.payload.url),window.location.href=s.data.payload.url;break;case"OAUTH_UPDATE_URL":console.log("OAuth: Iframe requested URL update to:",s.data.payload.url),(function(e,r){if(!history?.replaceState)return console.warn("history.replaceState not supported in this browser"),void Ca(r,{message:"URL update not supported in this browser"});try{const a=window.location.href;history.replaceState({},"",e),(function(t,n){const i=new URL(n),o=new URL(t),l=i.searchParams,c=o.searchParams,h=["oauth_code","oauth_state","start-oauth"];return h.some(p=>c?.has(p))&&!h.some(p=>l?.has(p))})(a,e)&&(function(){console.log("OAuth parameters cleaned, opening sidebar");try{localStorage.setItem("angie_sidebar_state","open")}catch{console.warn("localStorage not available")}setTimeout(()=>{window.toggleAngieSidebar(!0)},500)})(),_r(r,{message:"URL updated successfully"})}catch(a){console.warn("Failed to update URL via history.replaceState:",a),Ca(r,{message:"URL update failed: "+(a instanceof Error?a.message:"Unknown error")})}})(s.data.payload.url,s.ports[0]);break;case"ANGIE_REDIRECT_TO_WP_ADMIN_WITH_OAUTH":Yn();break;case"ANGIE_REDIRECT_TO_AUTH_ORIGIN_LOGOUT":try{Yn()}catch(e){console.error("OAuth: Auth origin logout fallback failed:",e),window.location.reload()}}})};var st;(function(s){s.SDK_ANGIE_ALL_SERVERS_REGISTERED="sdk-angie-all-servers-registered",s.SDK_ANGIE_READY_PING="sdk-angie-ready-ping",s.SDK_REQUEST_CLIENT_CREATION="sdk-request-client-creation",s.SDK_TRIGGER_ANGIE="sdk-trigger-angie",s.SDK_TRIGGER_ANGIE_RESPONSE="sdk-trigger-angie-response",s.ANGIE_SIDEBAR_RESIZED="angie-sidebar-resized",s.ANGIE_SIDEBAR_TOGGLED="angie-sidebar-toggled",s.ANGIE_CHAT_TOGGLE="angie-chat-toggle",s.ANGIE_STUDIO_TOGGLE="angie-studio-toggle",s.ANGIE_NAVIGATE_TO_URL="angie/navigate-to-url",s.ANGIE_PAGE_RELOAD="angie/page-reload"})(st||(st={}));class tu{angieDetector;registrationQueue;clientManager;isInitialized=!1;instanceId;constructor(){this.instanceId=Math.random().toString(36).substring(2,8),console.log(`AngieMcpSdk: Constructor called - initializing SDK (Instance: ${this.instanceId})`),this.angieDetector=new El,this.registrationQueue=new Pl,this.clientManager=new xl,console.log(`AngieMcpSdk: Setting up event handlers (Instance: ${this.instanceId})`),this.setupAngieReadyHandler(),this.setupServerInitHandler(),this.setupReRegistrationHandler(),console.log(`AngieMcpSdk: SDK initialization complete (Instance: ${this.instanceId})`)}async loadSidebar(e){Xc(),await(async r=>{if(window.screen.availWidth<=768)return void console.log("Angie: Mobile detected, skipping iframe injection");let a=document.getElementById("angie-sidebar-container");if(!a){const i=performance.now();if(console.log(" Waiting for sidebar container..."),await new Promise(o=>{let l=0;const c=setInterval(()=>{a=document.getElementById("angie-sidebar-container"),l++,(a||l>20)&&(clearInterval(c),a&&o())},100);setTimeout(()=>{if(clearInterval(c),a)return void o();const h=new MutationObserver(()=>{a=document.getElementById("angie-sidebar-container"),a&&(h.disconnect(),o())});h.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{h.disconnect(),o()},8e3)},2e3)}),console.log(` Sidebar container detection took: ${(performance.now()-i).toFixed(2)}ms`),!a)return void console.error("Angie: Sidebar container not found")}const{iframe:t,iframeUrlObject:n}=await(async i=>{const o=i.origin,l=new URL(i.path,o),c=l.pathname.slice(1).replace(/\//,"--")+"-"+Math.random().toString(36).substring(7);return new Promise(h=>{const p=new URL(o);p.pathname=l.pathname;const y=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";if(p.searchParams.append("colorScheme",i.uiTheme||y||"light"),p.searchParams.append("sdkVersion",i.sdkVersion),p.searchParams.append("instanceId",c),p.searchParams.append("origin",window.location.origin),i.isRTL&&p.searchParams.append("isRTL",i.isRTL?"true":"false"),window.location.hostname==="localhost"&&window.location.search.includes("debug_error")){const m=new URLSearchParams(window.location.search).get("debug_error");m&&p.searchParams.append("debug_error",m)}l.searchParams.forEach((m,w)=>{p.searchParams.set(w,m)}),p.searchParams.set("ver",new Date().getTime().toString());const u=i.parent||document,f=u.createElement("iframe"),g={"background-color":"transparent","color-scheme":"normal",...i.css};window.addEventListener("message",async m=>{if(m.origin===p.origin)switch(m.data.type){case yr.ANGIE_READY:h({iframe:f,iframeUrlObject:p});break;case yr.ANGIE_LOADED:f.contentWindow?.postMessage({type:yr.HOST_READY,instanceId:c},p.origin)}}),f.setAttribute("src",p.href),f.id="angie-iframe",f.setAttribute("frameborder","0"),f.setAttribute("scrolling","no"),f.setAttribute("style",Object.entries(g).map(([m,w])=>`${m}: ${w}`).join("; ")),f.setAttribute("allow","clipboard-write; clipboard-read"),i.insertCallback?i.insertCallback(f):u.body.appendChild(f)})})({origin:r.origin||"https://angie.elementor.com",path:"angie/wp-admin",insertCallback:i=>{console.log("Injecting Angie iframe into sidebar container"),i.setAttribute("title","Angie AI Assistant"),i.setAttribute("role","application"),i.setAttribute("aria-label","Angie AI Assistant Interface");const o=document.getElementById("angie-sidebar-loading");o&&(o.textContent=""),a?.appendChild(i),Jn(i,!0),i.addEventListener("load",()=>{i.focus()})},css:{width:"100%",height:"100%",border:"none",outline:"none"},uiTheme:r.uiTheme,isRTL:r.isRTL,sdkVersion:"1.0.3"});Ct.iframe=t,Ct.iframeUrlObject=n,window.addEventListener("message",i=>{if(i.origin===Ct.iframeUrlObject?.origin)switch(i.data.type){case Wr.SET:window.localStorage.setItem(i.data.key,i.data.value);break;case Wr.GET:const o=i.ports[0],l=window.localStorage.getItem(i.data.key);o.postMessage({value:l})}}),(i=>{window.addEventListener("message",async o=>{const l=o.origin===window.location.origin,c=o.origin===i.iframeUrlObject?.origin;if(l||c)switch(o?.data?.type){case st.SDK_ANGIE_ALL_SERVERS_REGISTERED:break;case st.SDK_ANGIE_READY_PING:const h=o.ports[0];console.log("Angie is ready",o),_r(h,{message:"Angie is ready"});break;case st.SDK_REQUEST_CLIENT_CREATION:const p=o.data.payload;try{const y=o.ports[0],u=new MessageChannel;u.port1.onmessage=g=>{y.postMessage({success:!0,data:g.data})};const f={type:st.SDK_REQUEST_CLIENT_CREATION,payload:{success:!0,...p,clientId:`dynamic-client-${p.serverName}-${p.serverVersion}-${Date.now()}`,requestId:o.data.payload.requestId},timestamp:Date.now()};if(!i.iframe)throw new Error("Iframe not found");i.iframe.contentWindow?.postMessage(f,i.iframeUrlObject?.origin||"",[u.port2])}catch(y){console.error(`AngieMcpSdk:Failed to create client for SDK server "${p.serverName}":`,y)}break;case st.SDK_TRIGGER_ANGIE:console.log("SDK Trigger Angie received",o.data);try{const{requestId:y,prompt:u,context:f}=o.data.payload;if(!i.iframe)throw new Error("Iframe not found");i.iframe.contentWindow?.postMessage({type:st.SDK_TRIGGER_ANGIE,payload:{requestId:y,prompt:u,context:f}},i.iframeUrlObject?.origin||""),window.postMessage({type:st.SDK_TRIGGER_ANGIE_RESPONSE,payload:{success:!0,requestId:y,response:"Angie triggered successfully"}},window.location.origin)}catch(y){console.error("Failed to trigger Angie:",y),window.postMessage({type:st.SDK_TRIGGER_ANGIE_RESPONSE,payload:{success:!1,requestId:o.data.payload?.requestId,error:y instanceof Error?y.message:"Unknown error"}},window.location.origin)}}})})(Ct),eu(),window.addEventListener("message",async i=>{if([window.location.origin,r.origin||"https://angie.elementor.com"].includes(i.origin))if(i?.data?.type===st.ANGIE_CHAT_TOGGLE)Ct.open=i.data.open,Ct.iframe&&Jn(Ct.iframe,Ct.open);else if(i?.data?.type===st.ANGIE_STUDIO_TOGGLE){const o=i.data.isStudioOpen;if(!Ct.iframe)return;if(o)document.documentElement.classList.add("angie-studio-active");else{const l=Yc();document.documentElement.style.setProperty("--angie-sidebar-width",`${l}px`),document.documentElement.classList.remove("angie-studio-active")}}else if(i?.data?.type===st.ANGIE_NAVIGATE_TO_URL){const{url:o=""}=i.data;if(!((l,c=[])=>{const h=c.length===0&&typeof window<"u"?[window.location.origin]:c;if(!l.startsWith("http"))return!1;try{const p=new URL(l);return h.includes(p.origin)}catch{return!1}})(o))throw new Error("Angie: Invalid URL - navigation blocked for security reasons");window.location.assign(o)}else i?.data?.type===st.ANGIE_PAGE_RELOAD?(console.log("Angie requested page reload - database operations completed"),window.location.reload()):i?.data?.type===yr.RESET_HASH&&(window.location.hash="",_r(i.ports[0],{message:"Hash reset successfully"}))})})({origin:e?.origin||"https://angie.elementor.com",uiTheme:e?.uiTheme||"light",isRTL:e?.isRTL||!1,...e}),this.setupPromptHashDetection()}setupReRegistrationHandler(){window.addEventListener("message",e=>{if(e.data?.type===Xt.SDK_ANGIE_REFRESH_PING)if(console.log(`AngieMcpSdk: Angie refresh ping received (Instance: ${this.instanceId})`),this.registrationQueue.resetAllToPending()){const r=this.registrationQueue.getPending().length;console.log(`AngieMcpSdk: Successfully reset ${r} registrations, processing queue (Instance: ${this.instanceId})`),this.handleAngieReady()}else console.log(`AngieMcpSdk: Skipping queue reset - processing already in progress (Instance: ${this.instanceId})`)})}setupAngieReadyHandler(){this.angieDetector.waitForReady().then(e=>{e.isReady?this.handleAngieReady():console.warn("AngieMcpSdk: Angie not detected - servers will remain queued")}).catch(e=>{console.error("AngieMcpSdk: Error waiting for Angie:",e)})}async handleAngieReady(){console.log(`AngieMcpSdk: Angie is ready, processing queued registrations (Instance: ${this.instanceId})`);try{await this.registrationQueue.processQueue(async e=>{console.log(`AngieMcpSdk: processQueue callback called for "${e.config.name}" (Instance: ${this.instanceId})`),await this.processRegistration(e)}),this.isInitialized=!0,console.log(`AngieMcpSdk: Initialization complete (Instance: ${this.instanceId})`)}catch(e){console.error(`AngieMcpSdk: Error processing registration queue (Instance: ${this.instanceId}):`,e)}}async processRegistration(e){console.log(`AngieMcpSdk: Processing registration for server "${e.config.name}" (ID: ${e.id}) (Instance: ${this.instanceId})`);try{console.log(`AngieMcpSdk: Calling clientManager.requestClientCreation for "${e.config.name}" (Instance: ${this.instanceId})`);const r={...e,instanceId:this.instanceId};await this.clientManager.requestClientCreation(r),console.log(`AngieMcpSdk: Successfully registered server "${e.config.name}" (Instance: ${this.instanceId})`)}catch(r){throw console.error(`AngieMcpSdk: Failed to register server "${e.config.name}" (Instance: ${this.instanceId}):`,r),r}}registerLocalServer(e){return e.type=gr.LOCAL,e.transport=Jr.POST_MESSAGE,this.registerServer(e)}registerRemoteServer(e){return e.type=gr.REMOTE,this.registerServer(e)}isLocalServerConfig(e){return e.type===gr.LOCAL||!e.type&&"server"in e}isRemoteServerConfig(e){return e.type===gr.REMOTE&&"url"in e}async registerServer(e){if(!e.type)return console.warn("AngieMcpSdk: for a local server, please use registerLocalServer instead of registerServer"),void this.registerLocalServer(e);if(console.log(`AngieMcpSdk: registerServer called for "${e.name}" (Instance: ${this.instanceId})`),!e.name)throw new Error("Server name is required");if(!e.description)throw new Error("Server description is required");if(this.isLocalServerConfig(e)&&!e.server)throw new Error("Server instance is required for local servers");console.log(`AngieMcpSdk: Registering server "${e.name}" (Instance: ${this.instanceId})`);const r=this.registrationQueue.add(e);if(console.log(`AngieMcpSdk: Added registration to queue: ${r.id} (Instance: ${this.instanceId})`),this.angieDetector.isReady())try{await this.processRegistration(r),this.registrationQueue.updateStatus(r.id,"registered"),console.log(`AngieMcpSdk: Server "${e.name}" registered successfully (Instance: ${this.instanceId})`)}catch(a){const t=a instanceof Error?a.message:String(a);throw this.registrationQueue.updateStatus(r.id,"failed",t),a}else console.log(`AngieMcpSdk: Server "${e.name}" queued until Angie is ready (Instance: ${this.instanceId})`)}getRegistrations(){return this.registrationQueue.getAll()}getPendingRegistrations(){return this.registrationQueue.getPending()}isAngieReady(){return this.angieDetector.isReady()}isReady(){return this.isInitialized}async waitForReady(){if(!(await this.angieDetector.waitForReady()).isReady)throw new Error("Angie is not available");for(;!this.isInitialized;)await new Promise(e=>setTimeout(e,100))}async triggerAngie(e){if(!this.isAngieReady())throw new Error("Angie is not ready. Please wait for Angie to be available before triggering.");const r=this.generateRequestId(),a=e.options?.timeout||3e4;return new Promise((t,n)=>{const i=setTimeout(()=>{n(new Error("Angie trigger request timed out"))},a),o=c=>{c.data?.type===Xt.SDK_TRIGGER_ANGIE_RESPONSE&&c.data?.payload?.requestId===r&&(clearTimeout(i),window.removeEventListener("message",o),t(c.data.payload))};window.addEventListener("message",o);const l={type:Xt.SDK_TRIGGER_ANGIE,payload:{requestId:r,prompt:e.prompt,options:e.options,context:{pageUrl:window.location.href,pageTitle:document.title,...e.context}},timestamp:Date.now()};console.log(`AngieMcpSdk: Triggering Angie with prompt (Request ID: ${r}, Instance: ${this.instanceId})`),window.postMessage(l,window.location.origin)})}destroy(){this.registrationQueue.clear(),console.log(`AngieMcpSdk: SDK destroyed (Instance: ${this.instanceId})`)}setupServerInitHandler(){window.addEventListener("message",e=>{e.data?.type===Xt.SDK_REQUEST_INIT_SERVER&&(console.log(`AngieMcpSdk: Server init request received (Instance: ${this.instanceId})`),this.handleServerInitRequest(e))})}handleServerInitRequest(e){const{clientId:r,serverId:a,instanceId:t}=e.data.payload||{};if(r&&a)if(console.log(`AngieMcpSdk: Server init request received - Request instanceId: ${t}, This instanceId: ${this.instanceId} (Instance: ${this.instanceId})`),t&&t!==this.instanceId)console.log(`AngieMcpSdk: Ignoring server init request for different instance. Request instanceId: ${t}, this instanceId: ${this.instanceId}`);else{console.log(`AngieMcpSdk: Handling server init request for clientId: ${r}, serverId: ${a} (Instance: ${this.instanceId})`);try{const n=this.registrationQueue.getAll().find(c=>c.id===a);if(!n)return void console.error(`AngieMcpSdk: No registration found for serverId: ${a} (Instance: ${this.instanceId})`);if("type"in n.config&&n.config.type==="remote")return void console.log(`AngieMcpSdk: Remote server registration detected; skipping local connect (Instance: ${this.instanceId})`);const i=e.ports[0];if(!i)return void console.error(`AngieMcpSdk: No port provided in server init request (Instance: ${this.instanceId})`);const o=n.config.server,l=new nn(i);o.connect(l),console.log(`AngieMcpSdk: Server "${n.config.name}" initialized successfully (Instance: ${this.instanceId})`)}catch(n){console.error(`AngieMcpSdk: Error initializing server for clientId ${r} (Instance: ${this.instanceId}):`,n)}}else console.error(`AngieMcpSdk: Invalid server init request - missing clientId or serverId (Instance: ${this.instanceId})`)}generateRequestId(){return`${this.instanceId}-${Date.now()}-${Math.random().toString(36).substring(2,8)}`}async handlePromptHash(){const e=window.location.hash;if(e.startsWith("#angie-prompt="))try{const r=e.replace("#angie-prompt=",""),a=decodeURIComponent(r);if(!a)return void console.warn("AngieMcpSdk: Empty prompt detected in hash");console.log("AngieMcpSdk: Detected prompt in hash:",a),await this.waitForReady();const t=await this.triggerAngie({prompt:a,context:{source:"hash-parameter",pageUrl:window.location.href,timestamp:new Date().toISOString()}});console.log("AngieMcpSdk: Triggered successfully from hash:",t),window.location.hash=""}catch(r){console.error("AngieMcpSdk: Failed to trigger from hash:",r)}}setupPromptHashDetection(){this.handlePromptHash(),window.addEventListener("hashchange",()=>this.handlePromptHash())}}var Ie;(function(s){s.assertEqual=t=>{};function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{const n={};for(const i of t)n[i]=i;return n},s.getValidEnumValues=t=>{const n=s.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),i={};for(const o of n)i[o]=t[o];return s.objectValues(i)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(i);return n},s.find=(t,n)=>{for(const i of t)if(n(i))return i},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(Ie||(Ie={}));var Xn;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(Xn||(Xn={}));const W=Ie.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yt=s=>{switch(typeof s){case"undefined":return W.undefined;case"string":return W.string;case"number":return Number.isNaN(s)?W.nan:W.number;case"boolean":return W.boolean;case"function":return W.function;case"bigint":return W.bigint;case"symbol":return W.symbol;case"object":return Array.isArray(s)?W.array:s===null?W.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?W.promise:typeof Map<"u"&&s instanceof Map?W.map:typeof Set<"u"&&s instanceof Set?W.set:typeof Date<"u"&&s instanceof Date?W.date:W.object;default:return W.unknown}},U=Ie.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);let lr=class ko extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof ko))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ie.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}};lr.create=s=>new lr(s);const Ds=(s,e)=>{let r;switch(s.code){case U.invalid_type:s.received===W.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case U.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,Ie.jsonStringifyReplacer)}`;break;case U.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ie.joinValues(s.keys,", ")}`;break;case U.invalid_union:r="Invalid input";break;case U.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ie.joinValues(s.options)}`;break;case U.invalid_enum_value:r=`Invalid enum value. Expected ${Ie.joinValues(s.options)}, received '${s.received}'`;break;case U.invalid_arguments:r="Invalid function arguments";break;case U.invalid_return_type:r="Invalid function return type";break;case U.invalid_date:r="Invalid date";break;case U.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:Ie.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case U.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case U.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case U.custom:r="Invalid input";break;case U.invalid_intersection_types:r="Intersection results could not be merged";break;case U.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case U.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ie.assertNever(s)}return{message:r}};let ru=Ds;function au(){return ru}const su=s=>{const{data:e,path:r,errorMaps:a,issueData:t}=s,n=[...r,...t.path||[]],i={...t,path:n};if(t.message!==void 0)return{...t,path:n,message:t.message};let o="";const l=a.filter(c=>!!c).slice().reverse();for(const c of l)o=c(i,{data:e,defaultError:o}).message;return{...t,path:n,message:o}};function G(s,e){const r=au(),a=su({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===Ds?void 0:Ds].filter(t=>!!t)});s.common.issues.push(a)}class lt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const a=[];for(const t of r){if(t.status==="aborted")return ie;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){const a=[];for(const t of r){const n=await t.key,i=await t.value;a.push({key:n,value:i})}return lt.mergeObjectSync(e,a)}static mergeObjectSync(e,r){const a={};for(const t of r){const{key:n,value:i}=t;if(n.status==="aborted"||i.status==="aborted")return ie;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof i.value<"u"||t.alwaysSet)&&(a[n.value]=i.value)}return{status:e.value,value:a}}}const ie=Object.freeze({status:"aborted"}),Ar=s=>({status:"dirty",value:s}),St=s=>({status:"valid",value:s}),ei=s=>s.status==="aborted",ti=s=>s.status==="dirty",Sr=s=>s.status==="valid",oa=s=>typeof Promise<"u"&&s instanceof Promise;var ee;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(ee||(ee={}));class jt{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ri=(s,e)=>{if(Sr(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new lr(s.common.issues);return this._error=r,this._error}}};function _e(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(i,o)=>{const{message:l}=s;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??a??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:t}}class Se{get description(){return this._def.description}_getType(e){return Yt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Yt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new lt,ctx:{common:e.parent.common,data:e.data,parsedType:Yt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(oa(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){const a={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yt(e)},t=this._parseSync({data:e,path:a.path,parent:a});return ri(a,t)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yt(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return Sr(a)?{value:a.value}:{issues:r.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>Sr(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){const a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){const a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Yt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(oa(t)?t:Promise.resolve(t));return ri(a,n)}refine(e,r){const a=t=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{const i=e(t),o=()=>n.addIssue({code:U.custom,...a(t)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,r){return this._refinement((a,t)=>e(a)?!0:(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new dr({schema:this,typeName:le.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ht.create(this,this._def)}nullable(){return hr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Dt.create(this)}promise(){return fa.create(this,this._def)}or(e){return ca.create([this,e],this._def)}and(e){return ua.create(this,e,this._def)}transform(e){return new dr({..._e(this._def),schema:this,typeName:le.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new pa({..._e(this._def),innerType:this,defaultValue:r,typeName:le.ZodDefault})}brand(){return new Oo({typeName:le.ZodBranded,type:this,..._e(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new ma({..._e(this._def),innerType:this,catchValue:r,typeName:le.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ln.create(this,e)}readonly(){return va.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const nu=/^c[^\s-]{8,}$/i,iu=/^[0-9a-z]+$/,ou=/^[0-9A-HJKMNP-TV-Z]{26}$/i,lu=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,cu=/^[a-z0-9_-]{21}$/i,uu=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,du=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,hu=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,fu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let $a;const pu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,mu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,vu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,gu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,yu=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_u=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Io="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",bu=new RegExp(`^${Io}$`);function Ao(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function wu(s){return new RegExp(`^${Ao(s)}$`)}function Su(s){let e=`${Io}T${Ao(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Eu(s,e){return!!((e==="v4"||!e)&&pu.test(s)||(e==="v6"||!e)&&vu.test(s))}function Pu(s,e){if(!uu.test(s))return!1;try{const[r]=s.split(".");if(!r)return!1;const a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||"typ"in t&&t?.typ!=="JWT"||!t.alg||e&&t.alg!==e)}catch{return!1}}function xu(s,e){return!!((e==="v4"||!e)&&mu.test(s)||(e==="v6"||!e)&&gu.test(s))}class zt extends Se{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==W.string){const n=this._getOrReturnCtx(e);return G(n,{code:U.invalid_type,expected:W.string,received:n.parsedType}),ie}const a=new lt;let t;for(const n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:U.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:U.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){const i=e.data.length>n.value,o=e.data.length<n.value;(i||o)&&(t=this._getOrReturnCtx(e,t),i?G(t,{code:U.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):o&&G(t,{code:U.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")hu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"email",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")$a||($a=new RegExp(fu,"u")),$a.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"emoji",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")lu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"uuid",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")cu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"nanoid",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")nu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cuid",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")iu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cuid2",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")ou.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"ulid",code:U.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),G(t,{validation:"url",code:U.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"regex",code:U.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?Su(n).test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?bu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?wu(n).test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{code:U.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?du.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"duration",code:U.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?Eu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"ip",code:U.invalid_string,message:n.message}),a.dirty()):n.kind==="jwt"?Pu(e.data,n.alg)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"jwt",code:U.invalid_string,message:n.message}),a.dirty()):n.kind==="cidr"?xu(e.data,n.version)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"cidr",code:U.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?yu.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"base64",code:U.invalid_string,message:n.message}),a.dirty()):n.kind==="base64url"?_u.test(e.data)||(t=this._getOrReturnCtx(e,t),G(t,{validation:"base64url",code:U.invalid_string,message:n.message}),a.dirty()):Ie.assertNever(n);return{status:a.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:U.invalid_string,...ee.errToObj(a)})}_addCheck(e){return new zt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ee.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ee.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ee.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ee.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ee.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ee.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ee.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ee.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ee.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ee.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ee.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ee.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ee.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...ee.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ee.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ee.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...ee.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...ee.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...ee.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...ee.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...ee.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...ee.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...ee.errToObj(r)})}nonempty(e){return this.min(1,ee.errToObj(e))}trim(){return new zt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new zt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new zt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}zt.create=s=>new zt({checks:[],typeName:le.ZodString,coerce:s?.coerce??!1,..._e(s)});function Ru(s,e){const r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a,n=Number.parseInt(s.toFixed(t).replace(".","")),i=Number.parseInt(e.toFixed(t).replace(".",""));return n%i/10**t}class Er extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==W.number){const n=this._getOrReturnCtx(e);return G(n,{code:U.invalid_type,expected:W.number,received:n.parsedType}),ie}let a;const t=new lt;for(const n of this._def.checks)n.kind==="int"?Ie.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:U.invalid_type,expected:"integer",received:"float",message:n.message}),t.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="multipleOf"?Ru(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:U.not_finite,message:n.message}),t.dirty()):Ie.assertNever(n);return{status:t.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,ee.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ee.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ee.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ee.toString(r))}setLimit(e,r,a,t){return new Er({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:ee.toString(t)}]})}_addCheck(e){return new Er({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ee.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ee.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ee.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:ee.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ee.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ee.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ie.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Er.create=s=>new Er({checks:[],typeName:le.ZodNumber,coerce:s?.coerce||!1,..._e(s)});class Dr extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==W.bigint)return this._getInvalidInput(e);let a;const t=new lt;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),G(a,{code:U.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):Ie.assertNever(n);return{status:t.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return G(r,{code:U.invalid_type,expected:W.bigint,received:r.parsedType}),ie}gte(e,r){return this.setLimit("min",e,!0,ee.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ee.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ee.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ee.toString(r))}setLimit(e,r,a,t){return new Dr({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:ee.toString(t)}]})}_addCheck(e){return new Dr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ee.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ee.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Dr.create=s=>new Dr({checks:[],typeName:le.ZodBigInt,coerce:s?.coerce??!1,..._e(s)});class Ns extends Se{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==W.boolean){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.boolean,received:a.parsedType}),ie}return St(e.data)}}Ns.create=s=>new Ns({typeName:le.ZodBoolean,coerce:s?.coerce||!1,..._e(s)});class la extends Se{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==W.date){const n=this._getOrReturnCtx(e);return G(n,{code:U.invalid_type,expected:W.date,received:n.parsedType}),ie}if(Number.isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return G(n,{code:U.invalid_date}),ie}const a=new lt;let t;for(const n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:U.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),G(t,{code:U.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):Ie.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new la({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:ee.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:ee.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}la.create=s=>new la({checks:[],coerce:s?.coerce||!1,typeName:le.ZodDate,..._e(s)});class ai extends Se{_parse(e){if(this._getType(e)!==W.symbol){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.symbol,received:a.parsedType}),ie}return St(e.data)}}ai.create=s=>new ai({typeName:le.ZodSymbol,..._e(s)});class js extends Se{_parse(e){if(this._getType(e)!==W.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.undefined,received:a.parsedType}),ie}return St(e.data)}}js.create=s=>new js({typeName:le.ZodUndefined,..._e(s)});class Ls extends Se{_parse(e){if(this._getType(e)!==W.null){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.null,received:a.parsedType}),ie}return St(e.data)}}Ls.create=s=>new Ls({typeName:le.ZodNull,..._e(s)});class si extends Se{constructor(){super(...arguments),this._any=!0}_parse(e){return St(e.data)}}si.create=s=>new si({typeName:le.ZodAny,..._e(s)});class qs extends Se{constructor(){super(...arguments),this._unknown=!0}_parse(e){return St(e.data)}}qs.create=s=>new qs({typeName:le.ZodUnknown,..._e(s)});class tr extends Se{_parse(e){const r=this._getOrReturnCtx(e);return G(r,{code:U.invalid_type,expected:W.never,received:r.parsedType}),ie}}tr.create=s=>new tr({typeName:le.ZodNever,..._e(s)});class ni extends Se{_parse(e){if(this._getType(e)!==W.undefined){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.void,received:a.parsedType}),ie}return St(e.data)}}ni.create=s=>new ni({typeName:le.ZodVoid,..._e(s)});class Dt extends Se{_parse(e){const{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==W.array)return G(r,{code:U.invalid_type,expected:W.array,received:r.parsedType}),ie;if(t.exactLength!==null){const i=r.data.length>t.exactLength.value,o=r.data.length<t.exactLength.value;(i||o)&&(G(r,{code:i?U.too_big:U.too_small,minimum:o?t.exactLength.value:void 0,maximum:i?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(G(r,{code:U.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(G(r,{code:U.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((i,o)=>t.type._parseAsync(new jt(r,i,r.path,o)))).then(i=>lt.mergeArray(a,i));const n=[...r.data].map((i,o)=>t.type._parseSync(new jt(r,i,r.path,o)));return lt.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new Dt({...this._def,minLength:{value:e,message:ee.toString(r)}})}max(e,r){return new Dt({...this._def,maxLength:{value:e,message:ee.toString(r)}})}length(e,r){return new Dt({...this._def,exactLength:{value:e,message:ee.toString(r)}})}nonempty(e){return this.min(1,e)}}Dt.create=(s,e)=>new Dt({type:s,minLength:null,maxLength:null,exactLength:null,typeName:le.ZodArray,..._e(e)});function vr(s){if(s instanceof Ke){const e={};for(const r in s.shape){const a=s.shape[r];e[r]=Ht.create(vr(a))}return new Ke({...s._def,shape:()=>e})}else return s instanceof Dt?new Dt({...s._def,type:vr(s.element)}):s instanceof Ht?Ht.create(vr(s.unwrap())):s instanceof hr?hr.create(vr(s.unwrap())):s instanceof cr?cr.create(s.items.map(e=>vr(e))):s}class Ke extends Se{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ie.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==W.object){const c=this._getOrReturnCtx(e);return G(c,{code:U.invalid_type,expected:W.object,received:c.parsedType}),ie}const{status:a,ctx:t}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof tr&&this._def.unknownKeys==="strip"))for(const c in t.data)i.includes(c)||o.push(c);const l=[];for(const c of i){const h=n[c],p=t.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new jt(t,p,t.path,c)),alwaysSet:c in t.data})}if(this._def.catchall instanceof tr){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of o)l.push({key:{status:"valid",value:h},value:{status:"valid",value:t.data[h]}});else if(c==="strict")o.length>0&&(G(t,{code:U.unrecognized_keys,keys:o}),a.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of o){const p=t.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new jt(t,p,t.path,h)),alwaysSet:h in t.data})}}return t.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const p=await h.key,y=await h.value;c.push({key:p,value:y,alwaysSet:h.alwaysSet})}return c}).then(c=>lt.mergeObjectSync(a,c)):lt.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return ee.errToObj,new Ke({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{const t=this._def.errorMap?.(r,a).message??a.defaultError;return r.code==="unrecognized_keys"?{message:ee.errToObj(e).message??t}:{message:t}}}:{}})}strip(){return new Ke({...this._def,unknownKeys:"strip"})}passthrough(){return new Ke({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ke({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ke({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:le.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ke({...this._def,catchall:e})}pick(e){const r={};for(const a of Ie.objectKeys(e))e[a]&&this.shape[a]&&(r[a]=this.shape[a]);return new Ke({...this._def,shape:()=>r})}omit(e){const r={};for(const a of Ie.objectKeys(this.shape))e[a]||(r[a]=this.shape[a]);return new Ke({...this._def,shape:()=>r})}deepPartial(){return vr(this)}partial(e){const r={};for(const a of Ie.objectKeys(this.shape)){const t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}return new Ke({...this._def,shape:()=>r})}required(e){const r={};for(const a of Ie.objectKeys(this.shape))if(e&&!e[a])r[a]=this.shape[a];else{let n=this.shape[a];for(;n instanceof Ht;)n=n._def.innerType;r[a]=n}return new Ke({...this._def,shape:()=>r})}keyof(){return To(Ie.objectKeys(this.shape))}}Ke.create=(s,e)=>new Ke({shape:()=>s,unknownKeys:"strip",catchall:tr.create(),typeName:le.ZodObject,..._e(e)});Ke.strictCreate=(s,e)=>new Ke({shape:()=>s,unknownKeys:"strict",catchall:tr.create(),typeName:le.ZodObject,..._e(e)});Ke.lazycreate=(s,e)=>new Ke({shape:s,unknownKeys:"strip",catchall:tr.create(),typeName:le.ZodObject,..._e(e)});class ca extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=this._def.options;function t(n){for(const o of n)if(o.result.status==="valid")return o.result;for(const o of n)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const i=n.map(o=>new lr(o.ctx.common.issues));return G(r,{code:U.invalid_union,unionErrors:i}),ie}if(r.common.async)return Promise.all(a.map(async n=>{const i={...r,common:{...r.common,issues:[]},parent:null};return{result:await n._parseAsync({data:r.data,path:r.path,parent:i}),ctx:i}})).then(t);{let n;const i=[];for(const l of a){const c={...r,common:{...r.common,issues:[]},parent:null},h=l._parseSync({data:r.data,path:r.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!n&&(n={result:h,ctx:c}),c.common.issues.length&&i.push(c.common.issues)}if(n)return r.common.issues.push(...n.ctx.common.issues),n.result;const o=i.map(l=>new lr(l));return G(r,{code:U.invalid_union,unionErrors:o}),ie}}get options(){return this._def.options}}ca.create=(s,e)=>new ca({options:s,typeName:le.ZodUnion,..._e(e)});const Zt=s=>s instanceof Fs?Zt(s.schema):s instanceof dr?Zt(s.innerType()):s instanceof ha?[s.value]:s instanceof ur?s.options:s instanceof Zs?Ie.objectValues(s.enum):s instanceof pa?Zt(s._def.innerType):s instanceof js?[void 0]:s instanceof Ls?[null]:s instanceof Ht?[void 0,...Zt(s.unwrap())]:s instanceof hr?[null,...Zt(s.unwrap())]:s instanceof Oo||s instanceof va?Zt(s.unwrap()):s instanceof ma?Zt(s._def.innerType):[];class on extends Se{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.object)return G(r,{code:U.invalid_type,expected:W.object,received:r.parsedType}),ie;const a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(G(r,{code:U.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){const t=new Map;for(const n of r){const i=Zt(n.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(t.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);t.set(o,n)}}return new on({typeName:le.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,..._e(a)})}}function Ms(s,e){const r=Yt(s),a=Yt(e);if(s===e)return{valid:!0,data:s};if(r===W.object&&a===W.object){const t=Ie.objectKeys(e),n=Ie.objectKeys(s).filter(o=>t.indexOf(o)!==-1),i={...s,...e};for(const o of n){const l=Ms(s[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(r===W.array&&a===W.array){if(s.length!==e.length)return{valid:!1};const t=[];for(let n=0;n<s.length;n++){const i=s[n],o=e[n],l=Ms(i,o);if(!l.valid)return{valid:!1};t.push(l.data)}return{valid:!0,data:t}}else return r===W.date&&a===W.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ua extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=(n,i)=>{if(ei(n)||ei(i))return ie;const o=Ms(n.value,i.value);return o.valid?((ti(n)||ti(i))&&r.dirty(),{status:r.value,value:o.data}):(G(a,{code:U.invalid_intersection_types}),ie)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>t(n,i)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}ua.create=(s,e,r)=>new ua({left:s,right:e,typeName:le.ZodIntersection,..._e(r)});class cr extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.array)return G(a,{code:U.invalid_type,expected:W.array,received:a.parsedType}),ie;if(a.data.length<this._def.items.length)return G(a,{code:U.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ie;!this._def.rest&&a.data.length>this._def.items.length&&(G(a,{code:U.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const n=[...a.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new jt(a,i,a.path,o)):null}).filter(i=>!!i);return a.common.async?Promise.all(n).then(i=>lt.mergeArray(r,i)):lt.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new cr({...this._def,rest:e})}}cr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new cr({items:s,typeName:le.ZodTuple,rest:null,..._e(e)})};class da extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.object)return G(a,{code:U.invalid_type,expected:W.object,received:a.parsedType}),ie;const t=[],n=this._def.keyType,i=this._def.valueType;for(const o in a.data)t.push({key:n._parse(new jt(a,o,a.path,o)),value:i._parse(new jt(a,a.data[o],a.path,o)),alwaysSet:o in a.data});return a.common.async?lt.mergeObjectAsync(r,t):lt.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return r instanceof Se?new da({keyType:e,valueType:r,typeName:le.ZodRecord,..._e(a)}):new da({keyType:zt.create(),valueType:e,typeName:le.ZodRecord,..._e(r)})}}class ii extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.map)return G(a,{code:U.invalid_type,expected:W.map,received:a.parsedType}),ie;const t=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([o,l],c)=>({key:t._parse(new jt(a,o,a.path,[c,"key"])),value:n._parse(new jt(a,l,a.path,[c,"value"]))}));if(a.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return ie;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of i){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return ie;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),o.set(c.value,h.value)}return{status:r.value,value:o}}}}ii.create=(s,e,r)=>new ii({valueType:e,keyType:s,typeName:le.ZodMap,..._e(r)});class Nr extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==W.set)return G(a,{code:U.invalid_type,expected:W.set,received:a.parsedType}),ie;const t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&(G(a,{code:U.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&(G(a,{code:U.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());const n=this._def.valueType;function i(l){const c=new Set;for(const h of l){if(h.status==="aborted")return ie;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}const o=[...a.data.values()].map((l,c)=>n._parse(new jt(a,l,a.path,c)));return a.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,r){return new Nr({...this._def,minSize:{value:e,message:ee.toString(r)}})}max(e,r){return new Nr({...this._def,maxSize:{value:e,message:ee.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Nr.create=(s,e)=>new Nr({valueType:s,minSize:null,maxSize:null,typeName:le.ZodSet,..._e(e)});class Fs extends Se{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Fs.create=(s,e)=>new Fs({getter:s,typeName:le.ZodLazy,..._e(e)});class ha extends Se{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return G(r,{received:r.data,code:U.invalid_literal,expected:this._def.value}),ie}return{status:"valid",value:e.data}}get value(){return this._def.value}}ha.create=(s,e)=>new ha({value:s,typeName:le.ZodLiteral,..._e(e)});function To(s,e){return new ur({values:s,typeName:le.ZodEnum,..._e(e)})}class ur extends Se{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{expected:Ie.joinValues(a),received:r.parsedType,code:U.invalid_type}),ie}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),a=this._def.values;return G(r,{received:r.data,code:U.invalid_enum_value,options:a}),ie}return St(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return ur.create(e,{...this._def,...r})}exclude(e,r=this._def){return ur.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}}ur.create=To;class Zs extends Se{_parse(e){const r=Ie.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==W.string&&a.parsedType!==W.number){const t=Ie.objectValues(r);return G(a,{expected:Ie.joinValues(t),received:a.parsedType,code:U.invalid_type}),ie}if(this._cache||(this._cache=new Set(Ie.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const t=Ie.objectValues(r);return G(a,{received:a.data,code:U.invalid_enum_value,options:t}),ie}return St(e.data)}get enum(){return this._def.values}}Zs.create=(s,e)=>new Zs({values:s,typeName:le.ZodNativeEnum,..._e(e)});class fa extends Se{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==W.promise&&r.common.async===!1)return G(r,{code:U.invalid_type,expected:W.promise,received:r.parsedType}),ie;const a=r.parsedType===W.promise?r.data:Promise.resolve(r.data);return St(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}}fa.create=(s,e)=>new fa({type:s,typeName:le.ZodPromise,..._e(e)});class dr extends Se{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:i=>{G(a,i),i.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){const i=t.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async o=>{if(r.value==="aborted")return ie;const l=await this._def.schema._parseAsync({data:o,path:a.path,parent:a});return l.status==="aborted"?ie:l.status==="dirty"||r.value==="dirty"?Ar(l.value):l});{if(r.value==="aborted")return ie;const o=this._def.schema._parseSync({data:i,path:a.path,parent:a});return o.status==="aborted"?ie:o.status==="dirty"||r.value==="dirty"?Ar(o.value):o}}if(t.type==="refinement"){const i=o=>{const l=t.refinement(o,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(a.common.async===!1){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return o.status==="aborted"?ie:(o.status==="dirty"&&r.dirty(),i(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>o.status==="aborted"?ie:(o.status==="dirty"&&r.dirty(),i(o.value).then(()=>({status:r.value,value:o.value}))))}if(t.type==="transform")if(a.common.async===!1){const i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Sr(i))return ie;const o=t.transform(i.value,n);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>Sr(i)?Promise.resolve(t.transform(i.value,n)).then(o=>({status:r.value,value:o})):ie);Ie.assertNever(t)}}dr.create=(s,e,r)=>new dr({schema:s,typeName:le.ZodEffects,effect:e,..._e(r)});dr.createWithPreprocess=(s,e,r)=>new dr({schema:e,effect:{type:"preprocess",transform:s},typeName:le.ZodEffects,..._e(r)});class Ht extends Se{_parse(e){return this._getType(e)===W.undefined?St(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ht.create=(s,e)=>new Ht({innerType:s,typeName:le.ZodOptional,..._e(e)});class hr extends Se{_parse(e){return this._getType(e)===W.null?St(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hr.create=(s,e)=>new hr({innerType:s,typeName:le.ZodNullable,..._e(e)});class pa extends Se{_parse(e){const{ctx:r}=this._processInputParams(e);let a=r.data;return r.parsedType===W.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}pa.create=(s,e)=>new pa({innerType:s,typeName:le.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,..._e(e)});class ma extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return oa(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new lr(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new lr(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}ma.create=(s,e)=>new ma({innerType:s,typeName:le.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,..._e(e)});class oi extends Se{_parse(e){if(this._getType(e)!==W.nan){const a=this._getOrReturnCtx(e);return G(a,{code:U.invalid_type,expected:W.nan,received:a.parsedType}),ie}return{status:"valid",value:e.data}}}oi.create=s=>new oi({typeName:le.ZodNaN,..._e(s)});class Oo extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}class ln extends Se{_parse(e){const{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?ie:n.status==="dirty"?(r.dirty(),Ar(n.value)):this._def.out._parseAsync({data:n.value,path:a.path,parent:a})})();{const t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?ie:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new ln({in:e,out:r,typeName:le.ZodPipeline})}}class va extends Se{_parse(e){const r=this._def.innerType._parse(e),a=t=>(Sr(t)&&(t.value=Object.freeze(t.value)),t);return oa(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}}va.create=(s,e)=>new va({innerType:s,typeName:le.ZodReadonly,..._e(e)});var le;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(le||(le={}));const z=zt.create,Ce=Er.create,vt=Ns.create,Fr=qs.create;tr.create;const Je=Dt.create,K=Ke.create,ct=ca.create,ku=on.create;ua.create;cr.create;const Zr=da.create,ve=ha.create,Qt=ur.create;fa.create;const q=Ht.create;hr.create;const Co="2025-06-18",Iu=[Co,"2025-03-26","2024-11-05","2024-10-07"],Ea="2.0",$o=ct([z(),Ce().int()]),Do=z(),Au=K({progressToken:q($o)}).passthrough(),Et=K({_meta:q(Au)}).passthrough(),pt=K({method:z(),params:q(Et)}),Ur=K({_meta:q(K({}).passthrough())}).passthrough(),qt=K({method:z(),params:q(Ur)}),Pt=K({_meta:q(K({}).passthrough())}).passthrough(),Pa=ct([z(),Ce().int()]),No=K({jsonrpc:ve(Ea),id:Pa}).merge(pt).strict(),Tu=s=>No.safeParse(s).success,jo=K({jsonrpc:ve(Ea)}).merge(qt).strict(),Ou=s=>jo.safeParse(s).success,Lo=K({jsonrpc:ve(Ea),id:Pa,result:Pt}).strict(),li=s=>Lo.safeParse(s).success;var Fe;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(Fe||(Fe={}));const qo=K({jsonrpc:ve(Ea),id:Pa,error:K({code:Ce().int(),message:z(),data:q(Fr())})}).strict(),Cu=s=>qo.safeParse(s).success;ct([No,jo,Lo,qo]);const cn=Pt.strict(),un=qt.extend({method:ve("notifications/cancelled"),params:Ur.extend({requestId:Pa,reason:z().optional()})}),zr=K({name:z(),title:q(z())}).passthrough(),Mo=zr.extend({version:z()}),$u=K({experimental:q(K({}).passthrough()),sampling:q(K({}).passthrough()),elicitation:q(K({}).passthrough()),roots:q(K({listChanged:q(vt())}).passthrough())}).passthrough(),Fo=pt.extend({method:ve("initialize"),params:Et.extend({protocolVersion:z(),capabilities:$u,clientInfo:Mo})}),Du=K({experimental:q(K({}).passthrough()),logging:q(K({}).passthrough()),completions:q(K({}).passthrough()),prompts:q(K({listChanged:q(vt())}).passthrough()),resources:q(K({subscribe:q(vt()),listChanged:q(vt())}).passthrough()),tools:q(K({listChanged:q(vt())}).passthrough())}).passthrough(),Nu=Pt.extend({protocolVersion:z(),capabilities:Du,serverInfo:Mo,instructions:q(z())}),Zo=qt.extend({method:ve("notifications/initialized")}),dn=pt.extend({method:ve("ping")}),ju=K({progress:Ce(),total:q(Ce()),message:q(z())}).passthrough(),hn=qt.extend({method:ve("notifications/progress"),params:Ur.merge(ju).extend({progressToken:$o})}),xa=pt.extend({params:Et.extend({cursor:q(Do)}).optional()}),Ra=Pt.extend({nextCursor:q(Do)}),Uo=K({uri:z(),mimeType:q(z()),_meta:q(K({}).passthrough())}).passthrough(),zo=Uo.extend({text:z()}),fn=z().refine(s=>{try{return atob(s),!0}catch{return!1}},{message:"Invalid Base64 string"}),Vo=Uo.extend({blob:fn}),Ho=zr.extend({uri:z(),description:q(z()),mimeType:q(z()),_meta:q(K({}).passthrough())}),Lu=zr.extend({uriTemplate:z(),description:q(z()),mimeType:q(z()),_meta:q(K({}).passthrough())}),Us=xa.extend({method:ve("resources/list")}),qu=Ra.extend({resources:Je(Ho)}),zs=xa.extend({method:ve("resources/templates/list")}),Mu=Ra.extend({resourceTemplates:Je(Lu)}),Vs=pt.extend({method:ve("resources/read"),params:Et.extend({uri:z()})}),Fu=Pt.extend({contents:Je(ct([zo,Vo]))}),Zu=qt.extend({method:ve("notifications/resources/list_changed")}),Uu=pt.extend({method:ve("resources/subscribe"),params:Et.extend({uri:z()})}),zu=pt.extend({method:ve("resources/unsubscribe"),params:Et.extend({uri:z()})}),Vu=qt.extend({method:ve("notifications/resources/updated"),params:Ur.extend({uri:z()})}),Hu=K({name:z(),description:q(z()),required:q(vt())}).passthrough(),Bu=zr.extend({description:q(z()),arguments:q(Je(Hu)),_meta:q(K({}).passthrough())}),Hs=xa.extend({method:ve("prompts/list")}),Gu=Ra.extend({prompts:Je(Bu)}),Bs=pt.extend({method:ve("prompts/get"),params:Et.extend({name:z(),arguments:q(Zr(z()))})}),pn=K({type:ve("text"),text:z(),_meta:q(K({}).passthrough())}).passthrough(),mn=K({type:ve("image"),data:fn,mimeType:z(),_meta:q(K({}).passthrough())}).passthrough(),vn=K({type:ve("audio"),data:fn,mimeType:z(),_meta:q(K({}).passthrough())}).passthrough(),Qu=K({type:ve("resource"),resource:ct([zo,Vo]),_meta:q(K({}).passthrough())}).passthrough(),Ku=Ho.extend({type:ve("resource_link")}),Bo=ct([pn,mn,vn,Ku,Qu]),Ju=K({role:Qt(["user","assistant"]),content:Bo}).passthrough(),Wu=Pt.extend({description:q(z()),messages:Je(Ju)}),Yu=qt.extend({method:ve("notifications/prompts/list_changed")}),Xu=K({title:q(z()),readOnlyHint:q(vt()),destructiveHint:q(vt()),idempotentHint:q(vt()),openWorldHint:q(vt())}).passthrough(),ed=zr.extend({description:q(z()),inputSchema:K({type:ve("object"),properties:q(K({}).passthrough()),required:q(Je(z()))}).passthrough(),outputSchema:q(K({type:ve("object"),properties:q(K({}).passthrough()),required:q(Je(z()))}).passthrough()),annotations:q(Xu),_meta:q(K({}).passthrough())}),Gs=xa.extend({method:ve("tools/list")}),td=Ra.extend({tools:Je(ed)}),Go=Pt.extend({content:Je(Bo).default([]),structuredContent:K({}).passthrough().optional(),isError:q(vt())});Go.or(Pt.extend({toolResult:Fr()}));const Qs=pt.extend({method:ve("tools/call"),params:Et.extend({name:z(),arguments:q(Zr(Fr()))})}),rd=qt.extend({method:ve("notifications/tools/list_changed")}),Qo=Qt(["debug","info","notice","warning","error","critical","alert","emergency"]),ad=pt.extend({method:ve("logging/setLevel"),params:Et.extend({level:Qo})}),sd=qt.extend({method:ve("notifications/message"),params:Ur.extend({level:Qo,logger:q(z()),data:Fr()})}),nd=K({name:z().optional()}).passthrough(),id=K({hints:q(Je(nd)),costPriority:q(Ce().min(0).max(1)),speedPriority:q(Ce().min(0).max(1)),intelligencePriority:q(Ce().min(0).max(1))}).passthrough(),od=K({role:Qt(["user","assistant"]),content:ct([pn,mn,vn])}).passthrough(),ld=pt.extend({method:ve("sampling/createMessage"),params:Et.extend({messages:Je(od),systemPrompt:q(z()),includeContext:q(Qt(["none","thisServer","allServers"])),temperature:q(Ce()),maxTokens:Ce().int(),stopSequences:q(Je(z())),metadata:q(K({}).passthrough()),modelPreferences:q(id)})}),Ko=Pt.extend({model:z(),stopReason:q(Qt(["endTurn","stopSequence","maxTokens"]).or(z())),role:Qt(["user","assistant"]),content:ku("type",[pn,mn,vn])}),cd=K({type:ve("boolean"),title:q(z()),description:q(z()),default:q(vt())}).passthrough(),ud=K({type:ve("string"),title:q(z()),description:q(z()),minLength:q(Ce()),maxLength:q(Ce()),format:q(Qt(["email","uri","date","date-time"]))}).passthrough(),dd=K({type:Qt(["number","integer"]),title:q(z()),description:q(z()),minimum:q(Ce()),maximum:q(Ce())}).passthrough(),hd=K({type:ve("string"),title:q(z()),description:q(z()),enum:Je(z()),enumNames:q(Je(z()))}).passthrough(),fd=ct([cd,ud,dd,hd]),pd=pt.extend({method:ve("elicitation/create"),params:Et.extend({message:z(),requestedSchema:K({type:ve("object"),properties:Zr(z(),fd),required:q(Je(z()))}).passthrough()})}),Jo=Pt.extend({action:Qt(["accept","decline","cancel"]),content:q(Zr(z(),Fr()))}),md=K({type:ve("ref/resource"),uri:z()}).passthrough(),vd=K({type:ve("ref/prompt"),name:z()}).passthrough(),Ks=pt.extend({method:ve("completion/complete"),params:Et.extend({ref:ct([vd,md]),argument:K({name:z(),value:z()}).passthrough(),context:q(K({arguments:q(Zr(z(),z()))}))})}),gd=Pt.extend({completion:K({values:Je(z()).max(100),total:q(Ce().int()),hasMore:q(vt())}).passthrough()}),yd=K({uri:z().startsWith("file://"),name:q(z()),_meta:q(K({}).passthrough())}).passthrough(),_d=pt.extend({method:ve("roots/list")}),Wo=Pt.extend({roots:Je(yd)}),bd=qt.extend({method:ve("notifications/roots/list_changed")});ct([dn,Fo,Ks,ad,Bs,Hs,Us,zs,Vs,Uu,zu,Qs,Gs]);ct([un,hn,Zo,bd]);ct([cn,Ko,Jo,Wo]);ct([dn,ld,pd,_d]);ct([un,hn,sd,Vu,Zu,rd,Yu]);ct([cn,Nu,gd,Wu,Gu,qu,Mu,Fu,Go,td]);class Be extends Error{constructor(e,r,a){super(`MCP error ${e}: ${r}`),this.code=e,this.data=a,this.name="McpError"}}const wd=6e4;class Sd{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(un,r=>{const a=this._requestHandlerAbortControllers.get(r.params.requestId);a?.abort(r.params.reason)}),this.setNotificationHandler(hn,r=>{this._onprogress(r)}),this.setRequestHandler(dn,r=>({}))}_setupTimeout(e,r,a,t,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(t,r),startTime:Date.now(),timeout:r,maxTotalTimeout:a,resetTimeoutOnProgress:n,onTimeout:t})}_resetTimeout(e){const r=this._timeoutInfo.get(e);if(!r)return!1;const a=Date.now()-r.startTime;if(r.maxTotalTimeout&&a>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new Be(Fe.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:a});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){const r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,a,t;this._transport=e;const n=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};const i=(a=this.transport)===null||a===void 0?void 0:a.onerror;this._transport.onerror=l=>{i?.(l),this._onerror(l)};const o=(t=this._transport)===null||t===void 0?void 0:t.onmessage;this._transport.onmessage=(l,c)=>{o?.(l,c),li(l)||Cu(l)?this._onresponse(l):Tu(l)?this._onrequest(l,c):Ou(l)?this._onnotification(l):this._onerror(new Error(`Unknown message type: ${JSON.stringify(l)}`))},await this._transport.start()}_onclose(){var e;const r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);const a=new Be(Fe.ConnectionClosed,"Connection closed");for(const t of r.values())t(a)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;const a=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;a!==void 0&&Promise.resolve().then(()=>a(e)).catch(t=>this._onerror(new Error(`Uncaught error in notification handler: ${t}`)))}_onrequest(e,r){var a,t;const n=(a=this._requestHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackRequestHandler,i=this._transport;if(n===void 0){i?.send({jsonrpc:"2.0",id:e.id,error:{code:Fe.MethodNotFound,message:"Method not found"}}).catch(c=>this._onerror(new Error(`Failed to send an error response: ${c}`)));return}const o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);const l={signal:o.signal,sessionId:i?.sessionId,_meta:(t=e.params)===null||t===void 0?void 0:t._meta,sendNotification:c=>this.notification(c,{relatedRequestId:e.id}),sendRequest:(c,h,p)=>this.request(c,h,{...p,relatedRequestId:e.id}),authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo};Promise.resolve().then(()=>n(e,l)).then(c=>{if(!o.signal.aborted)return i?.send({result:c,jsonrpc:"2.0",id:e.id})},c=>{var h;if(!o.signal.aborted)return i?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(c.code)?c.code:Fe.InternalError,message:(h=c.message)!==null&&h!==void 0?h:"Internal error"}})}).catch(c=>this._onerror(new Error(`Failed to send response: ${c}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:r,...a}=e.params,t=Number(r),n=this._progressHandlers.get(t);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const i=this._responseHandlers.get(t),o=this._timeoutInfo.get(t);if(o&&i&&o.resetTimeoutOnProgress)try{this._resetTimeout(t)}catch(l){i(l);return}n(a)}_onresponse(e){const r=Number(e.id),a=this._responseHandlers.get(r);if(a===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),li(e))a(e);else{const t=new Be(e.error.code,e.error.message,e.error.data);a(t)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,a){const{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}=a??{};return new Promise((o,l)=>{var c,h,p,y,u,f;if(!this._transport){l(new Error("Not connected"));return}((c=this._options)===null||c===void 0?void 0:c.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(h=a?.signal)===null||h===void 0||h.throwIfAborted();const g=this._requestMessageId++,m={...e,jsonrpc:"2.0",id:g};a?.onprogress&&(this._progressHandlers.set(g,a.onprogress),m.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:g}});const w=b=>{var E;this._responseHandlers.delete(g),this._progressHandlers.delete(g),this._cleanupTimeout(g),(E=this._transport)===null||E===void 0||E.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:g,reason:String(b)}},{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(x=>this._onerror(new Error(`Failed to send cancellation: ${x}`))),l(b)};this._responseHandlers.set(g,b=>{var E;if(!(!((E=a?.signal)===null||E===void 0)&&E.aborted)){if(b instanceof Error)return l(b);try{const x=r.parse(b.result);o(x)}catch(x){l(x)}}}),(y=a?.signal)===null||y===void 0||y.addEventListener("abort",()=>{var b;w((b=a?.signal)===null||b===void 0?void 0:b.reason)});const $=(u=a?.timeout)!==null&&u!==void 0?u:wd,A=()=>w(new Be(Fe.RequestTimeout,"Request timed out",{timeout:$}));this._setupTimeout(g,$,a?.maxTotalTimeout,A,(f=a?.resetTimeoutOnProgress)!==null&&f!==void 0?f:!1),this._transport.send(m,{relatedRequestId:t,resumptionToken:n,onresumptiontoken:i}).catch(b=>{this._cleanupTimeout(g),l(b)})})}async notification(e,r){var a,t;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((t=(a=this._options)===null||a===void 0?void 0:a.debouncedNotificationMethods)!==null&&t!==void 0?t:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var l;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;const c={...e,jsonrpc:"2.0"};(l=this._transport)===null||l===void 0||l.send(c,r).catch(h=>this._onerror(h))});return}const o={...e,jsonrpc:"2.0"};await this._transport.send(o,r)}setRequestHandler(e,r){const a=e.shape.method.value;this.assertRequestHandlerCapability(a),this._requestHandlers.set(a,(t,n)=>Promise.resolve(r(e.parse(t),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,a=>Promise.resolve(r(e.parse(a))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}function Ed(s,e){return Object.entries(e).reduce((r,[a,t])=>(t&&typeof t=="object"?r[a]=r[a]?{...r[a],...t}:t:r[a]=t,r),{...s})}var Tr={exports:{}};var Pd=Tr.exports,ci;function xd(){return ci||(ci=1,(function(s,e){(function(r,a){a(e)})(Pd,(function(r){function a(){for(var v=arguments.length,d=Array(v),_=0;_<v;_++)d[_]=arguments[_];if(d.length>1){d[0]=d[0].slice(0,-1);for(var I=d.length-1,k=1;k<I;++k)d[k]=d[k].slice(1,-1);return d[I]=d[I].slice(1),d.join("")}else return d[0]}function t(v){return"(?:"+v+")"}function n(v){return v===void 0?"undefined":v===null?"null":Object.prototype.toString.call(v).split(" ").pop().split("]").shift().toLowerCase()}function i(v){return v.toUpperCase()}function o(v){return v!=null?v instanceof Array?v:typeof v.length!="number"||v.split||v.setInterval||v.call?[v]:Array.prototype.slice.call(v):[]}function l(v,d){var _=v;if(d)for(var I in d)_[I]=d[I];return _}function c(v){var d="[A-Za-z]",_="[0-9]",I=a(_,"[A-Fa-f]"),k=t(t("%[EFef]"+I+"%"+I+I+"%"+I+I)+"|"+t("%[89A-Fa-f]"+I+"%"+I+I)+"|"+t("%"+I+I)),re="[\\:\\/\\?\\#\\[\\]\\@]",ae="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Re=a(re,ae),Ne=v?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Ve=v?"[\\uE000-\\uF8FF]":"[]",Pe=a(d,_,"[\\-\\.\\_\\~]",Ne);t(d+a(d,_,"[\\+\\-\\.]")+"*"),t(t(k+"|"+a(Pe,ae,"[\\:]"))+"*");var De=t(t("25[0-5]")+"|"+t("2[0-4]"+_)+"|"+t("1"+_+_)+"|"+t("0?[1-9]"+_)+"|0?0?"+_),He=t(De+"\\."+De+"\\."+De+"\\."+De),he=t(I+"{1,4}"),Le=t(t(he+"\\:"+he)+"|"+He),Ge=t(t(he+"\\:")+"{6}"+Le),qe=t("\\:\\:"+t(he+"\\:")+"{5}"+Le),Kt=t(t(he)+"?\\:\\:"+t(he+"\\:")+"{4}"+Le),At=t(t(t(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+t(he+"\\:")+"{3}"+Le),Tt=t(t(t(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+t(he+"\\:")+"{2}"+Le),pr=t(t(t(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+Le),rr=t(t(t(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+Le),yt=t(t(t(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),Ot=t(t(t(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),ar=t([Ge,qe,Kt,At,Tt,pr,rr,yt,Ot].join("|")),Ft=t(t(Pe+"|"+k)+"+");t("[vV]"+I+"+\\."+a(Pe,ae,"[\\:]")+"+"),t(t(k+"|"+a(Pe,ae))+"*");var kr=t(k+"|"+a(Pe,ae,"[\\:\\@]"));return t(t(k+"|"+a(Pe,ae,"[\\@]"))+"+"),t(t(kr+"|"+a("[\\/\\?]",Ve))+"*"),{NOT_SCHEME:new RegExp(a("[^]",d,_,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(a("[^\\%\\:]",Pe,ae),"g"),NOT_HOST:new RegExp(a("[^\\%\\[\\]\\:]",Pe,ae),"g"),NOT_PATH:new RegExp(a("[^\\%\\/\\:\\@]",Pe,ae),"g"),NOT_PATH_NOSCHEME:new RegExp(a("[^\\%\\/\\@]",Pe,ae),"g"),NOT_QUERY:new RegExp(a("[^\\%]",Pe,ae,"[\\:\\@\\/\\?]",Ve),"g"),NOT_FRAGMENT:new RegExp(a("[^\\%]",Pe,ae,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(a("[^]",Pe,ae),"g"),UNRESERVED:new RegExp(Pe,"g"),OTHER_CHARS:new RegExp(a("[^\\%]",Pe,Re),"g"),PCT_ENCODED:new RegExp(k,"g"),IPV4ADDRESS:new RegExp("^("+He+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ar+")"+t(t("\\%25|\\%(?!"+I+"{2})")+"("+Ft+")")+"?\\]?$")}}var h=c(!1),p=c(!0),y=(function(){function v(d,_){var I=[],k=!0,re=!1,ae=void 0;try{for(var Re=d[Symbol.iterator](),Ne;!(k=(Ne=Re.next()).done)&&(I.push(Ne.value),!(_&&I.length===_));k=!0);}catch(Ve){re=!0,ae=Ve}finally{try{!k&&Re.return&&Re.return()}finally{if(re)throw ae}}return I}return function(d,_){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d))return v(d,_);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),u=function(v){if(Array.isArray(v)){for(var d=0,_=Array(v.length);d<v.length;d++)_[d]=v[d];return _}else return Array.from(v)},f=2147483647,g=36,m=1,w=26,$=38,A=700,b=72,E=128,x="-",T=/^xn--/,O=/[^\0-\x7E]/,C=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=g-m,D=Math.floor,M=String.fromCharCode;function F(v){throw new RangeError(S[v])}function te(v,d){for(var _=[],I=v.length;I--;)_[I]=d(v[I]);return _}function pe(v,d){var _=v.split("@"),I="";_.length>1&&(I=_[0]+"@",v=_[1]),v=v.replace(C,".");var k=v.split("."),re=te(k,d).join(".");return I+re}function se(v){for(var d=[],_=0,I=v.length;_<I;){var k=v.charCodeAt(_++);if(k>=55296&&k<=56319&&_<I){var re=v.charCodeAt(_++);(re&64512)==56320?d.push(((k&1023)<<10)+(re&1023)+65536):(d.push(k),_--)}else d.push(k)}return d}var be=function(d){return String.fromCodePoint.apply(String,u(d))},ue=function(d){return d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:g},de=function(d,_){return d+22+75*(d<26)-((_!=0)<<5)},tt=function(d,_,I){var k=0;for(d=I?D(d/A):d>>1,d+=D(d/_);d>R*w>>1;k+=g)d=D(d/R);return D(k+(R+1)*d/(d+$))},Xe=function(d){var _=[],I=d.length,k=0,re=E,ae=b,Re=d.lastIndexOf(x);Re<0&&(Re=0);for(var Ne=0;Ne<Re;++Ne)d.charCodeAt(Ne)>=128&&F("not-basic"),_.push(d.charCodeAt(Ne));for(var Ve=Re>0?Re+1:0;Ve<I;){for(var Pe=k,De=1,He=g;;He+=g){Ve>=I&&F("invalid-input");var he=ue(d.charCodeAt(Ve++));(he>=g||he>D((f-k)/De))&&F("overflow"),k+=he*De;var Le=He<=ae?m:He>=ae+w?w:He-ae;if(he<Le)break;var Ge=g-Le;De>D(f/Ge)&&F("overflow"),De*=Ge}var qe=_.length+1;ae=tt(k-Pe,qe,Pe==0),D(k/qe)>f-re&&F("overflow"),re+=D(k/qe),k%=qe,_.splice(k++,0,re)}return String.fromCodePoint.apply(String,_)},We=function(d){var _=[];d=se(d);var I=d.length,k=E,re=0,ae=b,Re=!0,Ne=!1,Ve=void 0;try{for(var Pe=d[Symbol.iterator](),De;!(Re=(De=Pe.next()).done);Re=!0){var He=De.value;He<128&&_.push(M(He))}}catch(Ir){Ne=!0,Ve=Ir}finally{try{!Re&&Pe.return&&Pe.return()}finally{if(Ne)throw Ve}}var he=_.length,Le=he;for(he&&_.push(x);Le<I;){var Ge=f,qe=!0,Kt=!1,At=void 0;try{for(var Tt=d[Symbol.iterator](),pr;!(qe=(pr=Tt.next()).done);qe=!0){var rr=pr.value;rr>=k&&rr<Ge&&(Ge=rr)}}catch(Ir){Kt=!0,At=Ir}finally{try{!qe&&Tt.return&&Tt.return()}finally{if(Kt)throw At}}var yt=Le+1;Ge-k>D((f-re)/yt)&&F("overflow"),re+=(Ge-k)*yt,k=Ge;var Ot=!0,ar=!1,Ft=void 0;try{for(var kr=d[Symbol.iterator](),In;!(Ot=(In=kr.next()).done);Ot=!0){var An=In.value;if(An<k&&++re>f&&F("overflow"),An==k){for(var Hr=re,Br=g;;Br+=g){var Gr=Br<=ae?m:Br>=ae+w?w:Br-ae;if(Hr<Gr)break;var Tn=Hr-Gr,On=g-Gr;_.push(M(de(Gr+Tn%On,0))),Hr=D(Tn/On)}_.push(M(de(Hr,0))),ae=tt(re,yt,Le==he),re=0,++Le}}}catch(Ir){ar=!0,Ft=Ir}finally{try{!Ot&&kr.return&&kr.return()}finally{if(ar)throw Ft}}++re,++k}return _.join("")},Ue=function(d){return pe(d,function(_){return T.test(_)?Xe(_.slice(4).toLowerCase()):_})},gt=function(d){return pe(d,function(_){return O.test(_)?"xn--"+We(_):_})},P={version:"2.1.0",ucs2:{decode:se,encode:be},decode:Xe,encode:We,toASCII:gt,toUnicode:Ue},N={};function H(v){var d=v.charCodeAt(0),_=void 0;return d<16?_="%0"+d.toString(16).toUpperCase():d<128?_="%"+d.toString(16).toUpperCase():d<2048?_="%"+(d>>6|192).toString(16).toUpperCase()+"%"+(d&63|128).toString(16).toUpperCase():_="%"+(d>>12|224).toString(16).toUpperCase()+"%"+(d>>6&63|128).toString(16).toUpperCase()+"%"+(d&63|128).toString(16).toUpperCase(),_}function ce(v){for(var d="",_=0,I=v.length;_<I;){var k=parseInt(v.substr(_+1,2),16);if(k<128)d+=String.fromCharCode(k),_+=3;else if(k>=194&&k<224){if(I-_>=6){var re=parseInt(v.substr(_+4,2),16);d+=String.fromCharCode((k&31)<<6|re&63)}else d+=v.substr(_,6);_+=6}else if(k>=224){if(I-_>=9){var ae=parseInt(v.substr(_+4,2),16),Re=parseInt(v.substr(_+7,2),16);d+=String.fromCharCode((k&15)<<12|(ae&63)<<6|Re&63)}else d+=v.substr(_,9);_+=9}else d+=v.substr(_,3),_+=3}return d}function j(v,d){function _(I){var k=ce(I);return k.match(d.UNRESERVED)?k:I}return v.scheme&&(v.scheme=String(v.scheme).replace(d.PCT_ENCODED,_).toLowerCase().replace(d.NOT_SCHEME,"")),v.userinfo!==void 0&&(v.userinfo=String(v.userinfo).replace(d.PCT_ENCODED,_).replace(d.NOT_USERINFO,H).replace(d.PCT_ENCODED,i)),v.host!==void 0&&(v.host=String(v.host).replace(d.PCT_ENCODED,_).toLowerCase().replace(d.NOT_HOST,H).replace(d.PCT_ENCODED,i)),v.path!==void 0&&(v.path=String(v.path).replace(d.PCT_ENCODED,_).replace(v.scheme?d.NOT_PATH:d.NOT_PATH_NOSCHEME,H).replace(d.PCT_ENCODED,i)),v.query!==void 0&&(v.query=String(v.query).replace(d.PCT_ENCODED,_).replace(d.NOT_QUERY,H).replace(d.PCT_ENCODED,i)),v.fragment!==void 0&&(v.fragment=String(v.fragment).replace(d.PCT_ENCODED,_).replace(d.NOT_FRAGMENT,H).replace(d.PCT_ENCODED,i)),v}function V(v){return v.replace(/^0*(.*)/,"$1")||"0"}function ge(v,d){var _=v.match(d.IPV4ADDRESS)||[],I=y(_,2),k=I[1];return k?k.split(".").map(V).join("."):v}function Ee(v,d){var _=v.match(d.IPV6ADDRESS)||[],I=y(_,3),k=I[1],re=I[2];if(k){for(var ae=k.toLowerCase().split("::").reverse(),Re=y(ae,2),Ne=Re[0],Ve=Re[1],Pe=Ve?Ve.split(":").map(V):[],De=Ne.split(":").map(V),He=d.IPV4ADDRESS.test(De[De.length-1]),he=He?7:8,Le=De.length-he,Ge=Array(he),qe=0;qe<he;++qe)Ge[qe]=Pe[qe]||De[Le+qe]||"";He&&(Ge[he-1]=ge(Ge[he-1],d));var Kt=Ge.reduce(function(yt,Ot,ar){if(!Ot||Ot==="0"){var Ft=yt[yt.length-1];Ft&&Ft.index+Ft.length===ar?Ft.length++:yt.push({index:ar,length:1})}return yt},[]),At=Kt.sort(function(yt,Ot){return Ot.length-yt.length})[0],Tt=void 0;if(At&&At.length>1){var pr=Ge.slice(0,At.index),rr=Ge.slice(At.index+At.length);Tt=pr.join(":")+"::"+rr.join(":")}else Tt=Ge.join(":");return re&&(Tt+="%"+re),Tt}else return v}var we=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,je="".match(/(){0}/)[1]===void 0;function Ae(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_={},I=d.iri!==!1?p:h;d.reference==="suffix"&&(v=(d.scheme?d.scheme+":":"")+"//"+v);var k=v.match(we);if(k){je?(_.scheme=k[1],_.userinfo=k[3],_.host=k[4],_.port=parseInt(k[5],10),_.path=k[6]||"",_.query=k[7],_.fragment=k[8],isNaN(_.port)&&(_.port=k[5])):(_.scheme=k[1]||void 0,_.userinfo=v.indexOf("@")!==-1?k[3]:void 0,_.host=v.indexOf("//")!==-1?k[4]:void 0,_.port=parseInt(k[5],10),_.path=k[6]||"",_.query=v.indexOf("?")!==-1?k[7]:void 0,_.fragment=v.indexOf("#")!==-1?k[8]:void 0,isNaN(_.port)&&(_.port=v.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?k[4]:void 0)),_.host&&(_.host=Ee(ge(_.host,I),I)),_.scheme===void 0&&_.userinfo===void 0&&_.host===void 0&&_.port===void 0&&!_.path&&_.query===void 0?_.reference="same-document":_.scheme===void 0?_.reference="relative":_.fragment===void 0?_.reference="absolute":_.reference="uri",d.reference&&d.reference!=="suffix"&&d.reference!==_.reference&&(_.error=_.error||"URI is not a "+d.reference+" reference.");var re=N[(d.scheme||_.scheme||"").toLowerCase()];if(!d.unicodeSupport&&(!re||!re.unicodeSupport)){if(_.host&&(d.domainHost||re&&re.domainHost))try{_.host=P.toASCII(_.host.replace(I.PCT_ENCODED,ce).toLowerCase())}catch(ae){_.error=_.error||"Host's domain name can not be converted to ASCII via punycode: "+ae}j(_,h)}else j(_,I);re&&re.parse&&re.parse(_,d)}else _.error=_.error||"URI can not be parsed.";return _}function Te(v,d){var _=d.iri!==!1?p:h,I=[];return v.userinfo!==void 0&&(I.push(v.userinfo),I.push("@")),v.host!==void 0&&I.push(Ee(ge(String(v.host),_),_).replace(_.IPV6ADDRESS,function(k,re,ae){return"["+re+(ae?"%25"+ae:"")+"]"})),(typeof v.port=="number"||typeof v.port=="string")&&(I.push(":"),I.push(String(v.port))),I.length?I.join(""):void 0}var et=/^\.\.?\//,Me=/^\/\.(\/|$)/,xt=/^\/\.\.(\/|$)/,rt=/^\/?(?:.|\n)*?(?=\/|$)/;function Ze(v){for(var d=[];v.length;)if(v.match(et))v=v.replace(et,"");else if(v.match(Me))v=v.replace(Me,"/");else if(v.match(xt))v=v.replace(xt,"/"),d.pop();else if(v==="."||v==="..")v="";else{var _=v.match(rt);if(_){var I=_[0];v=v.slice(I.length),d.push(I)}else throw new Error("Unexpected dot segment condition")}return d.join("")}function ze(v){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=d.iri?p:h,I=[],k=N[(d.scheme||v.scheme||"").toLowerCase()];if(k&&k.serialize&&k.serialize(v,d),v.host&&!_.IPV6ADDRESS.test(v.host)){if(d.domainHost||k&&k.domainHost)try{v.host=d.iri?P.toUnicode(v.host):P.toASCII(v.host.replace(_.PCT_ENCODED,ce).toLowerCase())}catch(Re){v.error=v.error||"Host's domain name can not be converted to "+(d.iri?"Unicode":"ASCII")+" via punycode: "+Re}}j(v,_),d.reference!=="suffix"&&v.scheme&&(I.push(v.scheme),I.push(":"));var re=Te(v,d);if(re!==void 0&&(d.reference!=="suffix"&&I.push("//"),I.push(re),v.path&&v.path.charAt(0)!=="/"&&I.push("/")),v.path!==void 0){var ae=v.path;!d.absolutePath&&(!k||!k.absolutePath)&&(ae=Ze(ae)),re===void 0&&(ae=ae.replace(/^\/\//,"/%2F")),I.push(ae)}return v.query!==void 0&&(I.push("?"),I.push(v.query)),v.fragment!==void 0&&(I.push("#"),I.push(v.fragment)),I.join("")}function ut(v,d){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},I=arguments[3],k={};return I||(v=Ae(ze(v,_),_),d=Ae(ze(d,_),_)),_=_||{},!_.tolerant&&d.scheme?(k.scheme=d.scheme,k.userinfo=d.userinfo,k.host=d.host,k.port=d.port,k.path=Ze(d.path||""),k.query=d.query):(d.userinfo!==void 0||d.host!==void 0||d.port!==void 0?(k.userinfo=d.userinfo,k.host=d.host,k.port=d.port,k.path=Ze(d.path||""),k.query=d.query):(d.path?(d.path.charAt(0)==="/"?k.path=Ze(d.path):((v.userinfo!==void 0||v.host!==void 0||v.port!==void 0)&&!v.path?k.path="/"+d.path:v.path?k.path=v.path.slice(0,v.path.lastIndexOf("/")+1)+d.path:k.path=d.path,k.path=Ze(k.path)),k.query=d.query):(k.path=v.path,d.query!==void 0?k.query=d.query:k.query=v.query),k.userinfo=v.userinfo,k.host=v.host,k.port=v.port),k.scheme=v.scheme),k.fragment=d.fragment,k}function Vr(v,d,_){var I=l({scheme:"null"},_);return ze(ut(Ae(v,I),Ae(d,I),I,!0),I)}function ka(v,d){return typeof v=="string"?v=ze(Ae(v,d),d):n(v)==="object"&&(v=Ae(ze(v,d),d)),v}function Ia(v,d,_){return typeof v=="string"?v=ze(Ae(v,_),_):n(v)==="object"&&(v=ze(v,_)),typeof d=="string"?d=ze(Ae(d,_),_):n(d)==="object"&&(d=ze(d,_)),v===d}function cl(v,d){return v&&v.toString().replace(!d||!d.iri?h.ESCAPE:p.ESCAPE,H)}function Mt(v,d){return v&&v.toString().replace(!d||!d.iri?h.PCT_ENCODED:p.PCT_ENCODED,ce)}var xr={scheme:"http",domainHost:!0,parse:function(d,_){return d.host||(d.error=d.error||"HTTP URIs must have a host."),d},serialize:function(d,_){var I=String(d.scheme).toLowerCase()==="https";return(d.port===(I?443:80)||d.port==="")&&(d.port=void 0),d.path||(d.path="/"),d}},bn={scheme:"https",domainHost:xr.domainHost,parse:xr.parse,serialize:xr.serialize};function wn(v){return typeof v.secure=="boolean"?v.secure:String(v.scheme).toLowerCase()==="wss"}var Rr={scheme:"ws",domainHost:!0,parse:function(d,_){var I=d;return I.secure=wn(I),I.resourceName=(I.path||"/")+(I.query?"?"+I.query:""),I.path=void 0,I.query=void 0,I},serialize:function(d,_){if((d.port===(wn(d)?443:80)||d.port==="")&&(d.port=void 0),typeof d.secure=="boolean"&&(d.scheme=d.secure?"wss":"ws",d.secure=void 0),d.resourceName){var I=d.resourceName.split("?"),k=y(I,2),re=k[0],ae=k[1];d.path=re&&re!=="/"?re:void 0,d.query=ae,d.resourceName=void 0}return d.fragment=void 0,d}},Sn={scheme:"wss",domainHost:Rr.domainHost,parse:Rr.parse,serialize:Rr.serialize},ul={},En="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",It="[0-9A-Fa-f]",dl=t(t("%[EFef]"+It+"%"+It+It+"%"+It+It)+"|"+t("%[89A-Fa-f]"+It+"%"+It+It)+"|"+t("%"+It+It)),hl="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",fl="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",pl=a(fl,'[\\"\\\\]'),ml="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",vl=new RegExp(En,"g"),fr=new RegExp(dl,"g"),gl=new RegExp(a("[^]",hl,"[\\.]",'[\\"]',pl),"g"),Pn=new RegExp(a("[^]",En,ml),"g"),yl=Pn;function Aa(v){var d=ce(v);return d.match(vl)?d:v}var xn={scheme:"mailto",parse:function(d,_){var I=d,k=I.to=I.path?I.path.split(","):[];if(I.path=void 0,I.query){for(var re=!1,ae={},Re=I.query.split("&"),Ne=0,Ve=Re.length;Ne<Ve;++Ne){var Pe=Re[Ne].split("=");switch(Pe[0]){case"to":for(var De=Pe[1].split(","),He=0,he=De.length;He<he;++He)k.push(De[He]);break;case"subject":I.subject=Mt(Pe[1],_);break;case"body":I.body=Mt(Pe[1],_);break;default:re=!0,ae[Mt(Pe[0],_)]=Mt(Pe[1],_);break}}re&&(I.headers=ae)}I.query=void 0;for(var Le=0,Ge=k.length;Le<Ge;++Le){var qe=k[Le].split("@");if(qe[0]=Mt(qe[0]),_.unicodeSupport)qe[1]=Mt(qe[1],_).toLowerCase();else try{qe[1]=P.toASCII(Mt(qe[1],_).toLowerCase())}catch(Kt){I.error=I.error||"Email address's domain name can not be converted to ASCII via punycode: "+Kt}k[Le]=qe.join("@")}return I},serialize:function(d,_){var I=d,k=o(d.to);if(k){for(var re=0,ae=k.length;re<ae;++re){var Re=String(k[re]),Ne=Re.lastIndexOf("@"),Ve=Re.slice(0,Ne).replace(fr,Aa).replace(fr,i).replace(gl,H),Pe=Re.slice(Ne+1);try{Pe=_.iri?P.toUnicode(Pe):P.toASCII(Mt(Pe,_).toLowerCase())}catch(Le){I.error=I.error||"Email address's domain name can not be converted to "+(_.iri?"Unicode":"ASCII")+" via punycode: "+Le}k[re]=Ve+"@"+Pe}I.path=k.join(",")}var De=d.headers=d.headers||{};d.subject&&(De.subject=d.subject),d.body&&(De.body=d.body);var He=[];for(var he in De)De[he]!==ul[he]&&He.push(he.replace(fr,Aa).replace(fr,i).replace(Pn,H)+"="+De[he].replace(fr,Aa).replace(fr,i).replace(yl,H));return He.length&&(I.query=He.join("&")),I}},_l=/^([^\:]+)\:(.*)/,Rn={scheme:"urn",parse:function(d,_){var I=d.path&&d.path.match(_l),k=d;if(I){var re=_.scheme||k.scheme||"urn",ae=I[1].toLowerCase(),Re=I[2],Ne=re+":"+(_.nid||ae),Ve=N[Ne];k.nid=ae,k.nss=Re,k.path=void 0,Ve&&(k=Ve.parse(k,_))}else k.error=k.error||"URN can not be parsed.";return k},serialize:function(d,_){var I=_.scheme||d.scheme||"urn",k=d.nid,re=I+":"+(_.nid||k),ae=N[re];ae&&(d=ae.serialize(d,_));var Re=d,Ne=d.nss;return Re.path=(k||_.nid)+":"+Ne,Re}},bl=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,kn={scheme:"urn:uuid",parse:function(d,_){var I=d;return I.uuid=I.nss,I.nss=void 0,!_.tolerant&&(!I.uuid||!I.uuid.match(bl))&&(I.error=I.error||"UUID is not valid."),I},serialize:function(d,_){var I=d;return I.nss=(d.uuid||"").toLowerCase(),I}};N[xr.scheme]=xr,N[bn.scheme]=bn,N[Rr.scheme]=Rr,N[Sn.scheme]=Sn,N[xn.scheme]=xn,N[Rn.scheme]=Rn,N[kn.scheme]=kn,r.SCHEMES=N,r.pctEncChar=H,r.pctDecChars=ce,r.parse=Ae,r.removeDotSegments=Ze,r.serialize=ze,r.resolveComponents=ut,r.resolve=Vr,r.normalize=ka,r.equal=Ia,r.escapeComponent=cl,r.unescapeComponent=Mt,Object.defineProperty(r,"__esModule",{value:!0})}))})(Tr,Tr.exports)),Tr.exports}var Da,ui;function gn(){return ui||(ui=1,Da=function s(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var a,t,n;if(Array.isArray(e)){if(a=e.length,a!=r.length)return!1;for(t=a;t--!==0;)if(!s(e[t],r[t]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(n=Object.keys(e),a=n.length,a!==Object.keys(r).length)return!1;for(t=a;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,n[t]))return!1;for(t=a;t--!==0;){var i=n[t];if(!s(e[i],r[i]))return!1}return!0}return e!==e&&r!==r}),Da}var Na,di;function Rd(){return di||(di=1,Na=function(e){for(var r=0,a=e.length,t=0,n;t<a;)r++,n=e.charCodeAt(t++),n>=55296&&n<=56319&&t<a&&(n=e.charCodeAt(t),(n&64512)==56320&&t++);return r}),Na}var ja,hi;function Pr(){if(hi)return ja;hi=1,ja={copy:s,checkDataType:e,checkDataTypes:r,coerceToTypes:t,toHash:n,getProperty:l,escapeQuotes:c,equal:gn(),ucs2length:Rd(),varOccurences:h,varReplace:p,schemaHasRules:y,schemaHasRulesExcept:u,schemaUnknownRules:f,toQuotedString:g,getPathExpr:m,getPath:w,getData:b,unescapeFragment:x,unescapeJsonPointer:C,escapeFragment:T,escapeJsonPointer:O};function s(S,R){R=R||{};for(var D in S)R[D]=S[D];return R}function e(S,R,D,M){var F=M?" !== ":" === ",te=M?" || ":" && ",pe=M?"!":"",se=M?"":"!";switch(S){case"null":return R+F+"null";case"array":return pe+"Array.isArray("+R+")";case"object":return"("+pe+R+te+"typeof "+R+F+'"object"'+te+se+"Array.isArray("+R+"))";case"integer":return"(typeof "+R+F+'"number"'+te+se+"("+R+" % 1)"+te+R+F+R+(D?te+pe+"isFinite("+R+")":"")+")";case"number":return"(typeof "+R+F+'"'+S+'"'+(D?te+pe+"isFinite("+R+")":"")+")";default:return"typeof "+R+F+'"'+S+'"'}}function r(S,R,D){switch(S.length){case 1:return e(S[0],R,D,!0);default:var M="",F=n(S);F.array&&F.object&&(M=F.null?"(":"(!"+R+" || ",M+="typeof "+R+' !== "object")',delete F.null,delete F.array,delete F.object),F.number&&delete F.integer;for(var te in F)M+=(M?" && ":"")+e(te,R,D,!0);return M}}var a=n(["string","number","integer","boolean","null"]);function t(S,R){if(Array.isArray(R)){for(var D=[],M=0;M<R.length;M++){var F=R[M];(a[F]||S==="array"&&F==="array")&&(D[D.length]=F)}if(D.length)return D}else{if(a[R])return[R];if(S==="array"&&R==="array")return["array"]}}function n(S){for(var R={},D=0;D<S.length;D++)R[S[D]]=!0;return R}var i=/^[a-z$_][a-z$_0-9]*$/i,o=/'|\\/g;function l(S){return typeof S=="number"?"["+S+"]":i.test(S)?"."+S:"['"+c(S)+"']"}function c(S){return S.replace(o,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function h(S,R){R+="[^0-9]";var D=S.match(new RegExp(R,"g"));return D?D.length:0}function p(S,R,D){return R+="([^0-9])",D=D.replace(/\$/g,"$$$$"),S.replace(new RegExp(R,"g"),D+"$1")}function y(S,R){if(typeof S=="boolean")return!S;for(var D in S)if(R[D])return!0}function u(S,R,D){if(typeof S=="boolean")return!S&&D!="not";for(var M in S)if(M!=D&&R[M])return!0}function f(S,R){if(typeof S!="boolean"){for(var D in S)if(!R[D])return D}}function g(S){return"'"+c(S)+"'"}function m(S,R,D,M){var F=D?"'/' + "+R+(M?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):M?"'[' + "+R+" + ']'":"'[\\'' + "+R+" + '\\']'";return E(S,F)}function w(S,R,D){var M=g(D?"/"+O(R):l(R));return E(S,M)}var $=/^\/(?:[^~]|~0|~1)*$/,A=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function b(S,R,D){var M,F,te,pe;if(S==="")return"rootData";if(S[0]=="/"){if(!$.test(S))throw new Error("Invalid JSON-pointer: "+S);F=S,te="rootData"}else{if(pe=S.match(A),!pe)throw new Error("Invalid JSON-pointer: "+S);if(M=+pe[1],F=pe[2],F=="#"){if(M>=R)throw new Error("Cannot access property/index "+M+" levels up, current level is "+R);return D[R-M]}if(M>R)throw new Error("Cannot access data "+M+" levels up, current level is "+R);if(te="data"+(R-M||""),!F)return te}for(var se=te,be=F.split("/"),ue=0;ue<be.length;ue++){var de=be[ue];de&&(te+=l(C(de)),se+=" && "+te)}return se}function E(S,R){return S=='""'?R:(S+" + "+R).replace(/([^\\])' \+ '/g,"$1")}function x(S){return C(decodeURIComponent(S))}function T(S){return encodeURIComponent(O(S))}function O(S){return S.replace(/~/g,"~0").replace(/\//g,"~1")}function C(S){return S.replace(/~1/g,"/").replace(/~0/g,"~")}return ja}var La,fi;function Yo(){if(fi)return La;fi=1;var s=Pr();La=e;function e(r){s.copy(r,this)}return La}var qa={exports:{}},pi;function kd(){if(pi)return qa.exports;pi=1;var s=qa.exports=function(a,t,n){typeof t=="function"&&(n=t,t={}),n=t.cb||n;var i=typeof n=="function"?n:n.pre||function(){},o=n.post||function(){};e(t,i,o,a,"",a)};s.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},s.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},s.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},s.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(a,t,n,i,o,l,c,h,p,y){if(i&&typeof i=="object"&&!Array.isArray(i)){t(i,o,l,c,h,p,y);for(var u in i){var f=i[u];if(Array.isArray(f)){if(u in s.arrayKeywords)for(var g=0;g<f.length;g++)e(a,t,n,f[g],o+"/"+u+"/"+g,l,o,u,i,g)}else if(u in s.propsKeywords){if(f&&typeof f=="object")for(var m in f)e(a,t,n,f[m],o+"/"+u+"/"+r(m),l,o,u,i,m)}else(u in s.keywords||a.allKeys&&!(u in s.skipKeywords))&&e(a,t,n,f,o+"/"+u,l,o,u,i)}n(i,o,l,c,h,p,y)}}function r(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}return qa.exports}var Ma,mi;function yn(){if(mi)return Ma;mi=1;var s=xd(),e=gn(),r=Pr(),a=Yo(),t=kd();Ma=n,n.normalizeId=w,n.fullPath=f,n.url=$,n.ids=A,n.inlineRef=p,n.schema=i;function n(b,E,x){var T=this._refs[x];if(typeof T=="string")if(this._refs[T])T=this._refs[T];else return n.call(this,b,E,T);if(T=T||this._schemas[x],T instanceof a)return p(T.schema,this._opts.inlineRefs)?T.schema:T.validate||this._compile(T);var O=i.call(this,E,x),C,S,R;return O&&(C=O.schema,E=O.root,R=O.baseId),C instanceof a?S=C.validate||b.call(this,C.schema,E,void 0,R):C!==void 0&&(S=p(C,this._opts.inlineRefs)?C:b.call(this,C,E,void 0,R)),S}function i(b,E){var x=s.parse(E),T=g(x),O=f(this._getId(b.schema));if(Object.keys(b.schema).length===0||T!==O){var C=w(T),S=this._refs[C];if(typeof S=="string")return o.call(this,b,S,x);if(S instanceof a)S.validate||this._compile(S),b=S;else if(S=this._schemas[C],S instanceof a){if(S.validate||this._compile(S),C==w(E))return{schema:S,root:b,baseId:O};b=S}else return;if(!b.schema)return;O=f(this._getId(b.schema))}return c.call(this,x,O,b.schema,b)}function o(b,E,x){var T=i.call(this,b,E);if(T){var O=T.schema,C=T.baseId;b=T.root;var S=this._getId(O);return S&&(C=$(C,S)),c.call(this,x,C,O,b)}}var l=r.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function c(b,E,x,T){if(b.fragment=b.fragment||"",b.fragment.slice(0,1)=="/"){for(var O=b.fragment.split("/"),C=1;C<O.length;C++){var S=O[C];if(S){if(S=r.unescapeFragment(S),x=x[S],x===void 0)break;var R;if(!l[S]&&(R=this._getId(x),R&&(E=$(E,R)),x.$ref)){var D=$(E,x.$ref),M=i.call(this,T,D);M&&(x=M.schema,T=M.root,E=M.baseId)}}}if(x!==void 0&&x!==T.schema)return{schema:x,root:T,baseId:E}}}var h=r.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(b,E){if(E===!1)return!1;if(E===void 0||E===!0)return y(b);if(E)return u(b)<=E}function y(b){var E;if(Array.isArray(b)){for(var x=0;x<b.length;x++)if(E=b[x],typeof E=="object"&&!y(E))return!1}else for(var T in b)if(T=="$ref"||(E=b[T],typeof E=="object"&&!y(E)))return!1;return!0}function u(b){var E=0,x;if(Array.isArray(b)){for(var T=0;T<b.length;T++)if(x=b[T],typeof x=="object"&&(E+=u(x)),E==1/0)return 1/0}else for(var O in b){if(O=="$ref")return 1/0;if(h[O])E++;else if(x=b[O],typeof x=="object"&&(E+=u(x)+1),E==1/0)return 1/0}return E}function f(b,E){E!==!1&&(b=w(b));var x=s.parse(b);return g(x)}function g(b){return s.serialize(b).split("#")[0]+"#"}var m=/#\/?$/;function w(b){return b?b.replace(m,""):""}function $(b,E){return E=w(E),s.resolve(b,E)}function A(b){var E=w(this._getId(b)),x={"":E},T={"":f(E,!1)},O={},C=this;return t(b,{allKeys:!0},function(S,R,D,M,F,te,pe){if(R!==""){var se=C._getId(S),be=x[M],ue=T[M]+"/"+F;if(pe!==void 0&&(ue+="/"+(typeof pe=="number"?pe:r.escapeFragment(pe))),typeof se=="string"){se=be=w(be?s.resolve(be,se):se);var de=C._refs[se];if(typeof de=="string"&&(de=C._refs[de]),de&&de.schema){if(!e(S,de.schema))throw new Error('id "'+se+'" resolves to more than one schema')}else if(se!=w(ue))if(se[0]=="#"){if(O[se]&&!e(S,O[se]))throw new Error('id "'+se+'" resolves to more than one schema');O[se]=S}else C._refs[se]=ue}x[R]=be,T[R]=ue}}),O}return Ma}var Fa,vi;function _n(){if(vi)return Fa;vi=1;var s=yn();Fa={Validation:a(e),MissingRef:a(r)};function e(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}r.message=function(t,n){return"can't resolve reference "+n+" from id "+t};function r(t,n,i){this.message=i||r.message(t,n),this.missingRef=s.url(t,n),this.missingSchema=s.normalizeId(s.fullPath(this.missingRef))}function a(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}return Fa}var Za,gi;function Xo(){return gi||(gi=1,Za=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,a=e.cmp&&(function(n){return function(i){return function(o,l){var c={key:o,value:i[o]},h={key:l,value:i[l]};return n(c,h)}}})(e.cmp),t=[];return(function n(i){if(i&&i.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i!==void 0){if(typeof i=="number")return isFinite(i)?""+i:"null";if(typeof i!="object")return JSON.stringify(i);var o,l;if(Array.isArray(i)){for(l="[",o=0;o<i.length;o++)o&&(l+=","),l+=n(i[o])||"null";return l+"]"}if(i===null)return"null";if(t.indexOf(i)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=t.push(i)-1,h=Object.keys(i).sort(a&&a(i));for(l="",o=0;o<h.length;o++){var p=h[o],y=n(i[p]);y&&(l&&(l+=","),l+=JSON.stringify(p)+":"+y)}return t.splice(c,1),"{"+l+"}"}})(s)}),Za}var Ua,yi;function el(){return yi||(yi=1,Ua=function(e,r,a){var t="",n=e.schema.$async===!0,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var c="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(c);else throw new Error(c)}}if(e.isTop&&(t+=" var validate = ",n&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" "+("/*# sourceURL="+o+" */")+" ")),typeof e.schema=="boolean"||!(i||e.schema.$ref)){var r="false schema",h=e.level,p=e.dataLevel,y=e.schema[r],u=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,E=!e.opts.allErrors,O,g="data"+(p||""),b="valid"+h;if(e.schema===!1){e.isTop?E=!0:t+=" var "+b+" = false; ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ";var w=t;t=m.pop(),!e.compositeRule&&E?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?t+=" return data; ":t+=" validate.errors = null; return true; ":t+=" var "+b+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var $=e.isTop,h=e.level=0,p=e.dataLevel=0,g="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var A="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{var h=e.level,p=e.dataLevel,g="data"+(p||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),n&&!e.async)throw new Error("async schema in sync schema");t+=" var errs_"+h+" = errors;"}var b="valid"+h,E=!e.opts.allErrors,x="",T="",O,C=e.schema.type,S=Array.isArray(C);if(C&&e.opts.nullable&&e.schema.nullable===!0&&(S?C.indexOf("null")==-1&&(C=C.concat("null")):C!="null"&&(C=[C,"null"],S=!0)),S&&C.length==1&&(C=C[0],S=!1),e.schema.$ref&&i){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(t+=" "+e.RULES.all.$comment.code(e,"$comment")),C){if(e.opts.coerceTypes)var R=e.util.coerceToTypes(e.opts.coerceTypes,C);var D=e.RULES.types[C];if(R||S||D===!0||D&&!Me(D)){var u=e.schemaPath+".type",f=e.errSchemaPath+"/type",u=e.schemaPath+".type",f=e.errSchemaPath+"/type",M=S?"checkDataTypes":"checkDataType";if(t+=" if ("+e.util[M](C,g,e.opts.strictNumbers,!0)+") { ",R){var F="dataType"+h,te="coerced"+h;t+=" var "+F+" = typeof "+g+"; var "+te+" = undefined; ",e.opts.coerceTypes=="array"&&(t+=" if ("+F+" == 'object' && Array.isArray("+g+") && "+g+".length == 1) { "+g+" = "+g+"[0]; "+F+" = typeof "+g+"; if ("+e.util.checkDataType(e.schema.type,g,e.opts.strictNumbers)+") "+te+" = "+g+"; } "),t+=" if ("+te+" !== undefined) ; ";var pe=R;if(pe)for(var se,be=-1,ue=pe.length-1;be<ue;)se=pe[be+=1],se=="string"?t+=" else if ("+F+" == 'number' || "+F+" == 'boolean') "+te+" = '' + "+g+"; else if ("+g+" === null) "+te+" = ''; ":se=="number"||se=="integer"?(t+=" else if ("+F+" == 'boolean' || "+g+" === null || ("+F+" == 'string' && "+g+" && "+g+" == +"+g+" ",se=="integer"&&(t+=" && !("+g+" % 1)"),t+=")) "+te+" = +"+g+"; "):se=="boolean"?t+=" else if ("+g+" === 'false' || "+g+" === 0 || "+g+" === null) "+te+" = false; else if ("+g+" === 'true' || "+g+" === 1) "+te+" = true; ":se=="null"?t+=" else if ("+g+" === '' || "+g+" === 0 || "+g+" === false) "+te+" = null; ":e.opts.coerceTypes=="array"&&se=="array"&&(t+=" else if ("+F+" == 'string' || "+F+" == 'number' || "+F+" == 'boolean' || "+g+" == null) "+te+" = ["+g+"]; ");t+=" else {   ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ";var w=t;t=m.pop(),!e.compositeRule&&E?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } if ("+te+" !== undefined) {  ";var de=p?"data"+(p-1||""):"parentData",tt=p?e.dataPathArr[p]:"parentDataProperty";t+=" "+g+" = "+te+"; ",p||(t+="if ("+de+" !== undefined)"),t+=" "+de+"["+tt+"] = "+te+"; } "}else{var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ";var w=t;t=m.pop(),!e.compositeRule&&E?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.$ref&&!i)t+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",E&&(t+=" } if (errors === ",$?t+="0":t+="errs_"+h,t+=") { ",T+="}");else{var Xe=e.RULES;if(Xe){for(var D,We=-1,Ue=Xe.length-1;We<Ue;)if(D=Xe[We+=1],Me(D)){if(D.type&&(t+=" if ("+e.util.checkDataType(D.type,g,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(D.type=="object"&&e.schema.properties){var y=e.schema.properties,gt=Object.keys(y),P=gt;if(P)for(var N,H=-1,ce=P.length-1;H<ce;){N=P[H+=1];var j=y[N];if(j.default!==void 0){var V=g+e.util.getProperty(N);if(e.compositeRule){if(e.opts.strictDefaults){var A="default is ignored for: "+V;if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}}else t+=" if ("+V+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+V+" === null || "+V+" === '' "),t+=" ) "+V+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(j.default)+" ":t+=" "+JSON.stringify(j.default)+" ",t+="; "}}}else if(D.type=="array"&&Array.isArray(e.schema.items)){var ge=e.schema.items;if(ge){for(var j,be=-1,Ee=ge.length-1;be<Ee;)if(j=ge[be+=1],j.default!==void 0){var V=g+"["+be+"]";if(e.compositeRule){if(e.opts.strictDefaults){var A="default is ignored for: "+V;if(e.opts.strictDefaults==="log")e.logger.warn(A);else throw new Error(A)}}else t+=" if ("+V+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+V+" === null || "+V+" === '' "),t+=" ) "+V+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(j.default)+" ":t+=" "+JSON.stringify(j.default)+" ",t+="; "}}}}var we=D.rules;if(we){for(var je,Ae=-1,Te=we.length-1;Ae<Te;)if(je=we[Ae+=1],xt(je)){var et=je.code(e,je.keyword,D.type);et&&(t+=" "+et+" ",E&&(x+="}"))}}if(E&&(t+=" "+x+" ",x=""),D.type&&(t+=" } ",C&&C===D.type&&!R)){t+=" else { ";var u=e.schemaPath+".type",f=e.errSchemaPath+"/type",m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(O||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { type: '",S?t+=""+C.join(","):t+=""+C,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",S?t+=""+C.join(","):t+=""+C,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),t+=" } "):t+=" {} ";var w=t;t=m.pop(),!e.compositeRule&&E?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}E&&(t+=" if (errors === ",$?t+="0":t+="errs_"+h,t+=") { ",T+="}")}}}E&&(t+=" "+T+" "),$?(n?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+b+" = errors === errs_"+h+";";function Me(Ze){for(var ze=Ze.rules,ut=0;ut<ze.length;ut++)if(xt(ze[ut]))return!0}function xt(Ze){return e.schema[Ze.keyword]!==void 0||Ze.implements&&rt(Ze)}function rt(Ze){for(var ze=Ze.implements,ut=0;ut<ze.length;ut++)if(e.schema[ze[ut]]!==void 0)return!0}return t}),Ua}var za,_i;function Id(){if(_i)return za;_i=1;var s=yn(),e=Pr(),r=_n(),a=Xo(),t=el(),n=e.ucs2length,i=gn(),o=r.Validation;za=l;function l(w,$,A,b){var E=this,x=this._opts,T=[void 0],O={},C=[],S={},R=[],D={},M=[];$=$||{schema:w,refVal:T,refs:O};var F=c.call(this,w,$,b),te=this._compilations[F.index];if(F.compiling)return te.callValidate=de;var pe=this._formats,se=this.RULES;try{var be=tt(w,$,A,b);te.validate=be;var ue=te.callValidate;return ue&&(ue.schema=be.schema,ue.errors=null,ue.refs=be.refs,ue.refVal=be.refVal,ue.root=be.root,ue.$async=be.$async,x.sourceCode&&(ue.source=be.source)),be}finally{h.call(this,w,$,b)}function de(){var j=te.validate,V=j.apply(this,arguments);return de.errors=j.errors,V}function tt(j,V,ge,Ee){var we=!V||V&&V.schema==j;if(V.schema!=$.schema)return l.call(E,j,V,ge,Ee);var je=j.$async===!0,Ae=t({isTop:!0,schema:j,isRoot:we,baseId:Ee,root:V,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:r.MissingRef,RULES:se,validate:t,util:e,resolve:s,resolveRef:Xe,usePattern:N,useDefault:H,useCustomRule:ce,opts:x,formats:pe,logger:E.logger,self:E});Ae=m(T,f)+m(C,y)+m(R,u)+m(M,g)+Ae,x.processCode&&(Ae=x.processCode(Ae,j));var Te;try{var et=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",Ae);Te=et(E,se,pe,$,T,R,M,i,n,o),T[0]=Te}catch(Me){throw E.logger.error("Error compiling schema, function code:",Ae),Me}return Te.schema=j,Te.errors=null,Te.refs=O,Te.refVal=T,Te.root=we?Te:V,je&&(Te.$async=!0),x.sourceCode===!0&&(Te.source={code:Ae,patterns:C,defaults:R}),Te}function Xe(j,V,ge){V=s.url(j,V);var Ee=O[V],we,je;if(Ee!==void 0)return we=T[Ee],je="refVal["+Ee+"]",P(we,je);if(!ge&&$.refs){var Ae=$.refs[V];if(Ae!==void 0)return we=$.refVal[Ae],je=We(V,we),P(we,je)}je=We(V);var Te=s.call(E,tt,$,V);if(Te===void 0){var et=A&&A[V];et&&(Te=s.inlineRef(et,x.inlineRefs)?et:l.call(E,et,$,A,j))}if(Te===void 0)Ue(V);else return gt(V,Te),P(Te,je)}function We(j,V){var ge=T.length;return T[ge]=V,O[j]=ge,"refVal"+ge}function Ue(j){delete O[j]}function gt(j,V){var ge=O[j];T[ge]=V}function P(j,V){return typeof j=="object"||typeof j=="boolean"?{code:V,schema:j,inline:!0}:{code:V,$async:j&&!!j.$async}}function N(j){var V=S[j];return V===void 0&&(V=S[j]=C.length,C[V]=j),"pattern"+V}function H(j){switch(typeof j){case"boolean":case"number":return""+j;case"string":return e.toQuotedString(j);case"object":if(j===null)return"null";var V=a(j),ge=D[V];return ge===void 0&&(ge=D[V]=R.length,R[ge]=j),"default"+ge}}function ce(j,V,ge,Ee){if(E._opts.validateSchema!==!1){var we=j.definition.dependencies;if(we&&!we.every(function(ze){return Object.prototype.hasOwnProperty.call(ge,ze)}))throw new Error("parent schema must have all required keywords: "+we.join(","));var je=j.definition.validateSchema;if(je){var Ae=je(V);if(!Ae){var Te="keyword schema is invalid: "+E.errorsText(je.errors);if(E._opts.validateSchema=="log")E.logger.error(Te);else throw new Error(Te)}}}var et=j.definition.compile,Me=j.definition.inline,xt=j.definition.macro,rt;if(et)rt=et.call(E,V,ge,Ee);else if(xt)rt=xt.call(E,V,ge,Ee),x.validateSchema!==!1&&E.validateSchema(rt,!0);else if(Me)rt=Me.call(E,Ee,j.keyword,V,ge);else if(rt=j.definition.validate,!rt)return;if(rt===void 0)throw new Error('custom keyword "'+j.keyword+'"failed to compile');var Ze=M.length;return M[Ze]=rt,{code:"customRule"+Ze,validate:rt}}}function c(w,$,A){var b=p.call(this,w,$,A);return b>=0?{index:b,compiling:!0}:(b=this._compilations.length,this._compilations[b]={schema:w,root:$,baseId:A},{index:b,compiling:!1})}function h(w,$,A){var b=p.call(this,w,$,A);b>=0&&this._compilations.splice(b,1)}function p(w,$,A){for(var b=0;b<this._compilations.length;b++){var E=this._compilations[b];if(E.schema==w&&E.root==$&&E.baseId==A)return b}return-1}function y(w,$){return"var pattern"+w+" = new RegExp("+e.toQuotedString($[w])+");"}function u(w){return"var default"+w+" = defaults["+w+"];"}function f(w,$){return $[w]===void 0?"":"var refVal"+w+" = refVal["+w+"];"}function g(w){return"var customRule"+w+" = customRules["+w+"];"}function m(w,$){if(!w.length)return"";for(var A="",b=0;b<w.length;b++)A+=$(b,w);return A}return za}var Va={exports:{}},bi;function Ad(){if(bi)return Va.exports;bi=1;var s=Va.exports=function(){this._cache={}};return s.prototype.put=function(r,a){this._cache[r]=a},s.prototype.get=function(r){return this._cache[r]},s.prototype.del=function(r){delete this._cache[r]},s.prototype.clear=function(){this._cache={}},Va.exports}var Ha,wi;function Td(){if(wi)return Ha;wi=1;var s=Pr(),e=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,r=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,t=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,n=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,i=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,o=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,l=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,c=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,y=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Ha=u;function u(T){return T=T=="full"?"full":"fast",s.copy(u[T])}u.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":o,url:l,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:t,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:x,uuid:c,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":y},u.full={date:g,time:m,"date-time":$,uri:b,"uri-reference":i,"uri-template":o,url:l,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:t,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:x,uuid:c,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":y};function f(T){return T%4===0&&(T%100!==0||T%400===0)}function g(T){var O=T.match(e);if(!O)return!1;var C=+O[1],S=+O[2],R=+O[3];return S>=1&&S<=12&&R>=1&&R<=(S==2&&f(C)?29:r[S])}function m(T,O){var C=T.match(a);if(!C)return!1;var S=C[1],R=C[2],D=C[3],M=C[5];return(S<=23&&R<=59&&D<=59||S==23&&R==59&&D==60)&&(!O||M)}var w=/t|\s/i;function $(T){var O=T.split(w);return O.length==2&&g(O[0])&&m(O[1],!0)}var A=/\/|:/;function b(T){return A.test(T)&&n.test(T)}var E=/[^\\]\\Z/;function x(T){if(E.test(T))return!1;try{return new RegExp(T),!0}catch{return!1}}return Ha}var Ba,Si;function Od(){return Si||(Si=1,Ba=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.errSchemaPath+"/"+r,c=!e.opts.allErrors,h="data"+(i||""),p="valid"+n,y,u;if(o=="#"||o=="#/")e.isRoot?(y=e.async,u="validate"):(y=e.root.schema.$async===!0,u="root.refVal[0]");else{var f=e.resolveRef(e.baseId,o,e.isRoot);if(f===void 0){var g=e.MissingRefError.message(e.baseId,o);if(e.opts.missingRefs=="fail"){e.logger.error(g);var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(o)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(o)+"' "),e.opts.verbose&&(t+=" , schema: "+e.util.toQuotedString(o)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var w=t;t=m.pop(),!e.compositeRule&&c?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(t+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(g),c&&(t+=" if (true) { ");else throw new e.MissingRefError(e.baseId,o,g)}else if(f.inline){var $=e.util.copy(e);$.level++;var A="valid"+$.level;$.schema=f.schema,$.schemaPath="",$.errSchemaPath=o;var b=e.validate($).replace(/validate\.schema/g,f.code);t+=" "+b+" ",c&&(t+=" if ("+A+") { ")}else y=f.$async===!0||e.async&&f.$async!==!1,u=f.code}if(u){var m=m||[];m.push(t),t="",e.opts.passContext?t+=" "+u+".call(this, ":t+=" "+u+"( ",t+=" "+h+", (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var E=i?"data"+(i-1||""):"parentData",x=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+E+" , "+x+", rootData)  ";var T=t;if(t=m.pop(),y){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(t+=" var "+p+"; "),t+=" try { await "+T+"; ",c&&(t+=" "+p+" = true; "),t+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(t+=" "+p+" = false; "),t+=" } ",c&&(t+=" if ("+p+") { ")}else t+=" if (!"+T+") { if (vErrors === null) vErrors = "+u+".errors; else vErrors = vErrors.concat("+u+".errors); errors = vErrors.length; } ",c&&(t+=" else { ")}return t}),Ba}var Ga,Ei;function Cd(){return Ei||(Ei=1,Ga=function(e,r,a){var t=" ",n=e.schema[r],i=e.schemaPath+e.util.getProperty(r),o=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,c=e.util.copy(e),h="";c.level++;var p="valid"+c.level,y=c.baseId,u=!0,f=n;if(f)for(var g,m=-1,w=f.length-1;m<w;)g=f[m+=1],(e.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:e.util.schemaHasRules(g,e.RULES.all))&&(u=!1,c.schema=g,c.schemaPath=i+"["+m+"]",c.errSchemaPath=o+"/"+m,t+="  "+e.validate(c)+" ",c.baseId=y,l&&(t+=" if ("+p+") { ",h+="}"));return l&&(u?t+=" if (true) { ":t+=" "+h.slice(0,-1)+" "),t}),Ga}var Qa,Pi;function $d(){return Pi||(Pi=1,Qa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),g="";f.level++;var m="valid"+f.level,w=o.every(function(O){return e.opts.strictKeywords?typeof O=="object"&&Object.keys(O).length>0||O===!1:e.util.schemaHasRules(O,e.RULES.all)});if(w){var $=f.baseId;t+=" var "+u+" = errors; var "+y+" = false;  ";var A=e.compositeRule;e.compositeRule=f.compositeRule=!0;var b=o;if(b)for(var E,x=-1,T=b.length-1;x<T;)E=b[x+=1],f.schema=E,f.schemaPath=l+"["+x+"]",f.errSchemaPath=c+"/"+x,t+="  "+e.validate(f)+" ",f.baseId=$,t+=" "+y+" = "+y+" || "+m+"; if (!"+y+") { ",g+="}";e.compositeRule=f.compositeRule=A,t+=" "+g+" if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else h&&(t+=" if (true) { ");return t}),Qa}var Ka,xi;function Dd(){return xi||(xi=1,Ka=function(e,r,a){var t=" ",n=e.schema[r],i=e.errSchemaPath+"/"+r;e.opts.allErrors;var o=e.util.toQuotedString(n);return e.opts.$comment===!0?t+=" console.log("+o+");":typeof e.opts.$comment=="function"&&(t+=" self._opts.$comment("+o+", "+e.util.toQuotedString(i)+", validate.root.schema);"),t}),Ka}var Ja,Ri;function Nd(){return Ri||(Ri=1,Ja=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; "),u||(t+=" var schema"+n+" = validate.schema"+l+";"),t+="var "+y+" = equal("+p+", schema"+n+"); if (!"+y+") {   ";var f=f||[];f.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var g=t;return t=f.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}),Ja}var Wa,ki;function jd(){return ki||(ki=1,Wa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),g="";f.level++;var m="valid"+f.level,w="i"+n,$=f.dataLevel=e.dataLevel+1,A="data"+$,b=e.baseId,E=e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all);if(t+="var "+u+" = errors;var "+y+";",E){var x=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+=" var "+m+" = false; for (var "+w+" = 0; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var T=p+"["+w+"]";f.dataPathArr[$]=w;var O=e.validate(f);f.baseId=b,e.util.varOccurences(O,A)<2?t+=" "+e.util.varReplace(O,A,T)+" ":t+=" var "+A+" = "+T+"; "+O+" ",t+=" if ("+m+") break; }  ",e.compositeRule=f.compositeRule=x,t+=" "+g+" if (!"+m+") {"}else t+=" if ("+p+".length == 0) {";var C=C||[];C.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var S=t;return t=C.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",E&&(t+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t}),Wa}var Ya,Ii;function Ld(){return Ii||(Ii=1,Ya=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var g="valid"+u.level,m={},w={},$=e.opts.ownProperties;for(x in o)if(x!="__proto__"){var A=o[x],b=Array.isArray(A)?w:m;b[x]=A}t+="var "+y+" = errors;";var E=e.errorPath;t+="var missing"+n+";";for(var x in w)if(b=w[x],b.length){if(t+=" if ( "+p+e.util.getProperty(x)+" !== undefined ",$&&(t+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(x)+"') "),h){t+=" && ( ";var T=b;if(T)for(var O,C=-1,S=T.length-1;C<S;){O=T[C+=1],C&&(t+=" || ");var R=e.util.getProperty(O),D=p+R;t+=" ( ( "+D+" === undefined ",$&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:R)+") ) "}t+=")) {  ";var M="missing"+n,F="' + "+M+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(E,M,!0):E+" + "+M);var te=te||[];te.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+F+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(b.length==1?b[0]:b.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",b.length==1?t+="property "+e.util.escapeQuotes(b[0]):t+="properties "+e.util.escapeQuotes(b.join(", ")),t+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var pe=t;t=te.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+pe+"]); ":t+=" validate.errors = ["+pe+"]; return false; ":t+=" var err = "+pe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var se=b;if(se)for(var O,be=-1,ue=se.length-1;be<ue;){O=se[be+=1];var R=e.util.getProperty(O),F=e.util.escapeQuotes(O),D=p+R;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(E,O,e.opts.jsonPointers)),t+=" if ( "+D+" === undefined ",$&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(x)+"', missingProperty: '"+F+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(b.length==1?b[0]:b.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",b.length==1?t+="property "+e.util.escapeQuotes(b[0]):t+="properties "+e.util.escapeQuotes(b.join(", ")),t+=" when property "+e.util.escapeQuotes(x)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",h&&(f+="}",t+=" else { ")}e.errorPath=E;var de=u.baseId;for(var x in m){var A=m[x];(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))&&(t+=" "+g+" = true; if ( "+p+e.util.getProperty(x)+" !== undefined ",$&&(t+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(x)+"') "),t+=") { ",u.schema=A,u.schemaPath=l+e.util.getProperty(x),u.errSchemaPath=c+"/"+e.util.escapeFragment(x),t+="  "+e.validate(u)+" ",u.baseId=de,t+=" }  ",h&&(t+=" if ("+g+") { ",f+="}"))}return h&&(t+="   "+f+" if ("+y+" == errors) {"),t}),Ya}var Xa,Ai;function qd(){return Ai||(Ai=1,Xa=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ");var f="i"+n,g="schema"+n;u||(t+=" var "+g+" = validate.schema"+l+";"),t+="var "+y+";",u&&(t+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),t+=""+y+" = false;for (var "+f+"=0; "+f+"<"+g+".length; "+f+"++) if (equal("+p+", "+g+"["+f+"])) { "+y+" = true; break; }",u&&(t+="  }  "),t+=" if (!"+y+") {   ";var m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",h&&(t+=" else { "),t}),Xa}var es,Ti;function Md(){return Ti||(Ti=1,es=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||"");if(e.opts.format===!1)return h&&(t+=" if (true) { "),t;var y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=e.opts.unknownFormats,g=Array.isArray(f);if(y){var m="format"+n,w="isObject"+n,$="formatType"+n;t+=" var "+m+" = formats["+u+"]; var "+w+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+$+" = "+w+" && "+m+".type || 'string'; if ("+w+") { ",e.async&&(t+=" var async"+n+" = "+m+".async; "),t+=" "+m+" = "+m+".validate; } if (  ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),t+=" (",f!="ignore"&&(t+=" ("+u+" && !"+m+" ",g&&(t+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),t+=") || "),t+=" ("+m+" && "+$+" == '"+a+"' && !(typeof "+m+" == 'function' ? ",e.async?t+=" (async"+n+" ? await "+m+"("+p+") : "+m+"("+p+")) ":t+=" "+m+"("+p+") ",t+=" : "+m+".test("+p+"))))) {"}else{var m=e.formats[o];if(!m){if(f=="ignore")return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),h&&(t+=" if (true) { "),t;if(g&&f.indexOf(o)>=0)return h&&(t+=" if (true) { "),t;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var w=typeof m=="object"&&!(m instanceof RegExp)&&m.validate,$=w&&m.type||"string";if(w){var A=m.async===!0;m=m.validate}if($!=a)return h&&(t+=" if (true) { "),t;if(A){if(!e.async)throw new Error("async format in sync schema");var b="formats"+e.util.getProperty(o)+".validate";t+=" if (!(await "+b+"("+p+"))) { "}else{t+=" if (! ";var b="formats"+e.util.getProperty(o);w&&(b+=".validate"),typeof m=="function"?t+=" "+b+"("+p+") ":t+=" "+b+".test("+p+") ",t+=") { "}}var E=E||[];E.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",y?t+=""+u:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match format "`,y?t+="' + "+u+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var x=t;return t=E.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}),es}var ts,Oi;function Fd(){return Oi||(Oi=1,ts=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e);f.level++;var g="valid"+f.level,m=e.schema.then,w=e.schema.else,$=m!==void 0&&(e.opts.strictKeywords?typeof m=="object"&&Object.keys(m).length>0||m===!1:e.util.schemaHasRules(m,e.RULES.all)),A=w!==void 0&&(e.opts.strictKeywords?typeof w=="object"&&Object.keys(w).length>0||w===!1:e.util.schemaHasRules(w,e.RULES.all)),b=f.baseId;if($||A){var E;f.createErrors=!1,f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+=" var "+u+" = errors; var "+y+" = true;  ";var x=e.compositeRule;e.compositeRule=f.compositeRule=!0,t+="  "+e.validate(f)+" ",f.baseId=b,f.createErrors=!0,t+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }  ",e.compositeRule=f.compositeRule=x,$?(t+=" if ("+g+") {  ",f.schema=e.schema.then,f.schemaPath=e.schemaPath+".then",f.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(f)+" ",f.baseId=b,t+=" "+y+" = "+g+"; ",$&&A?(E="ifClause"+n,t+=" var "+E+" = 'then'; "):E="'then'",t+=" } ",A&&(t+=" else { ")):t+=" if (!"+g+") { ",A&&(f.schema=e.schema.else,f.schemaPath=e.schemaPath+".else",f.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(f)+" ",f.baseId=b,t+=" "+y+" = "+g+"; ",$&&A?(E="ifClause"+n,t+=" var "+E+" = 'else'; "):E="'else'",t+=" } "),t+=" if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+E+" } ",e.opts.messages!==!1&&(t+=` , message: 'should match "' + `+E+` + '" schema' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" }   ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}),ts}var rs,Ci;function Zd(){return Ci||(Ci=1,rs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),g="";f.level++;var m="valid"+f.level,w="i"+n,$=f.dataLevel=e.dataLevel+1,A="data"+$,b=e.baseId;if(t+="var "+u+" = errors;var "+y+";",Array.isArray(o)){var E=e.schema.additionalItems;if(E===!1){t+=" "+y+" = "+p+".length <= "+o.length+"; ";var x=c;c=e.errSchemaPath+"/additionalItems",t+="  if (!"+y+") {   ";var T=T||[];T.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+o.length+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var O=t;t=T.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+O+"]); ":t+=" validate.errors = ["+O+"]; return false; ":t+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",c=x,h&&(g+="}",t+=" else { ")}var C=o;if(C){for(var S,R=-1,D=C.length-1;R<D;)if(S=C[R+=1],e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===!1:e.util.schemaHasRules(S,e.RULES.all)){t+=" "+m+" = true; if ("+p+".length > "+R+") { ";var M=p+"["+R+"]";f.schema=S,f.schemaPath=l+"["+R+"]",f.errSchemaPath=c+"/"+R,f.errorPath=e.util.getPathExpr(e.errorPath,R,e.opts.jsonPointers,!0),f.dataPathArr[$]=R;var F=e.validate(f);f.baseId=b,e.util.varOccurences(F,A)<2?t+=" "+e.util.varReplace(F,A,M)+" ":t+=" var "+A+" = "+M+"; "+F+" ",t+=" }  ",h&&(t+=" if ("+m+") { ",g+="}")}}if(typeof E=="object"&&(e.opts.strictKeywords?typeof E=="object"&&Object.keys(E).length>0||E===!1:e.util.schemaHasRules(E,e.RULES.all))){f.schema=E,f.schemaPath=e.schemaPath+".additionalItems",f.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+m+" = true; if ("+p+".length > "+o.length+") {  for (var "+w+" = "+o.length+"; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var M=p+"["+w+"]";f.dataPathArr[$]=w;var F=e.validate(f);f.baseId=b,e.util.varOccurences(F,A)<2?t+=" "+e.util.varReplace(F,A,M)+" ":t+=" var "+A+" = "+M+"; "+F+" ",h&&(t+=" if (!"+m+") break; "),t+=" } }  ",h&&(t+=" if ("+m+") { ",g+="}")}}else if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){f.schema=o,f.schemaPath=l,f.errSchemaPath=c,t+="  for (var "+w+" = 0; "+w+" < "+p+".length; "+w+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,w,e.opts.jsonPointers,!0);var M=p+"["+w+"]";f.dataPathArr[$]=w;var F=e.validate(f);f.baseId=b,e.util.varOccurences(F,A)<2?t+=" "+e.util.varReplace(F,A,M)+" ":t+=" var "+A+" = "+M+"; "+F+" ",h&&(t+=" if (!"+m+") break; "),t+=" }"}return h&&(t+=" "+g+" if ("+u+" == errors) {"),t}),rs}var as,$i;function Di(){return $i||($i=1,as=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,b,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=r=="maximum",g=f?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[g],w=e.opts.$data&&m&&m.$data,$=f?"<":">",A=f?">":"<",b=void 0;if(!(y||typeof o=="number"||o===void 0))throw new Error(r+" must be number");if(!(w||m===void 0||typeof m=="number"||typeof m=="boolean"))throw new Error(g+" must be number or boolean");if(w){var E=e.util.getData(m.$data,i,e.dataPathArr),x="exclusive"+n,T="exclType"+n,O="exclIsNumber"+n,C="op"+n,S="' + "+C+" + '";t+=" var schemaExcl"+n+" = "+E+"; ",E="schemaExcl"+n,t+=" var "+x+"; var "+T+" = typeof "+E+"; if ("+T+" != 'boolean' && "+T+" != 'undefined' && "+T+" != 'number') { ";var b=g,R=R||[];R.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: '"+g+" should be boolean' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var D=t;t=R.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+D+"]); ":t+=" validate.errors = ["+D+"]; return false; ":t+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+T+" == 'number' ? ( ("+x+" = "+u+" === undefined || "+E+" "+$+"= "+u+") ? "+p+" "+A+"= "+E+" : "+p+" "+A+" "+u+" ) : ( ("+x+" = "+E+" === true) ? "+p+" "+A+"= "+u+" : "+p+" "+A+" "+u+" ) || "+p+" !== "+p+") { var op"+n+" = "+x+" ? '"+$+"' : '"+$+"='; ",o===void 0&&(b=g,c=e.errSchemaPath+"/"+g,u=E,y=w)}else{var O=typeof m=="number",S=$;if(O&&y){var C="'"+S+"'";t+=" if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" ( "+u+" === undefined || "+m+" "+$+"= "+u+" ? "+p+" "+A+"= "+m+" : "+p+" "+A+" "+u+" ) || "+p+" !== "+p+") { "}else{O&&o===void 0?(x=!0,b=g,c=e.errSchemaPath+"/"+g,u=m,A+="="):(O&&(u=Math[f?"min":"max"](m,o)),m===(O?u:!0)?(x=!0,b=g,c=e.errSchemaPath+"/"+g,A+="="):(x=!1,S+="="));var C="'"+S+"'";t+=" if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+p+" "+A+" "+u+" || "+p+" !== "+p+") { "}}b=b||r;var R=R||[];R.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+C+", limit: "+u+", exclusive: "+x+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be "+S+" ",y?t+="' + "+u:t+=""+u+"'"),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var D=t;return t=R.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+D+"]); ":t+=" validate.errors = ["+D+"]; return false; ":t+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { "),t}),as}var ss,Ni;function ji(){return Ni||(Ni=1,ss=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,g,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxItems"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" "+p+".length "+f+" "+u+") { ";var g=r,m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(g||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxItems"?t+="more":t+="fewer",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" items' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),ss}var ns,Li;function qi(){return Li||(Li=1,ns=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,g,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxLength"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),e.opts.unicode===!1?t+=" "+p+".length ":t+=" ucs2length("+p+") ",t+=" "+f+" "+u+") { ";var g=r,m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(g||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be ",r=="maxLength"?t+="longer":t+="shorter",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" characters' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),ns}var is,Mi;function Fi(){return Mi||(Mi=1,is=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,g,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");var f=r=="maxProperties"?">":"<";t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'number') || "),t+=" Object.keys("+p+").length "+f+" "+u+") { ";var g=r,m=m||[];m.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(g||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxProperties"?t+="more":t+="fewer",t+=" than ",y?t+="' + "+u+" + '":t+=""+o,t+=" properties' "),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var w=t;return t=m.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),is}var os,Zi;function Ud(){return Zi||(Zi=1,os=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;if(y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o,!(y||typeof o=="number"))throw new Error(r+" must be number");t+="var division"+n+";if (",y&&(t+=" "+u+" !== undefined && ( typeof "+u+" != 'number' || "),t+=" (division"+n+" = "+p+" / "+u+", ",e.opts.multipleOfPrecision?t+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":t+=" division"+n+" !== parseInt(division"+n+") ",t+=" ) ",y&&(t+="  )  "),t+=" ) {   ";var f=f||[];f.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+u+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be multiple of ",y?t+="' + "+u:t+=""+u+"'"),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var g=t;return t=f.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),os}var ls,Ui;function zd(){return Ui||(Ui=1,ls=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e);u.level++;var f="valid"+u.level;if(e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=l,u.errSchemaPath=c,t+=" var "+y+" = errors;  ";var g=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.createErrors=!1;var m;u.opts.allErrors&&(m=u.opts.allErrors,u.opts.allErrors=!1),t+=" "+e.validate(u)+" ",u.createErrors=!0,m&&(u.opts.allErrors=m),e.compositeRule=u.compositeRule=g,t+=" if ("+f+") {   ";var w=w||[];w.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var $=t;t=w.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+$+"]); ":t+=" validate.errors = ["+$+"]; return false; ":t+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+y+"; if (vErrors !== null) { if ("+y+") vErrors.length = "+y+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h&&(t+=" if (false) { ");return t}),ls}var cs,zi;function Vd(){return zi||(zi=1,cs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u="errs__"+n,f=e.util.copy(e),g="";f.level++;var m="valid"+f.level,w=f.baseId,$="prevValid"+n,A="passingSchemas"+n;t+="var "+u+" = errors , "+$+" = false , "+y+" = false , "+A+" = null; ";var b=e.compositeRule;e.compositeRule=f.compositeRule=!0;var E=o;if(E)for(var x,T=-1,O=E.length-1;T<O;)x=E[T+=1],(e.opts.strictKeywords?typeof x=="object"&&Object.keys(x).length>0||x===!1:e.util.schemaHasRules(x,e.RULES.all))?(f.schema=x,f.schemaPath=l+"["+T+"]",f.errSchemaPath=c+"/"+T,t+="  "+e.validate(f)+" ",f.baseId=w):t+=" var "+m+" = true; ",T&&(t+=" if ("+m+" && "+$+") { "+y+" = false; "+A+" = ["+A+", "+T+"]; } else { ",g+="}"),t+=" if ("+m+") { "+y+" = "+$+" = true; "+A+" = "+T+"; }";return e.compositeRule=f.compositeRule=b,t+=""+g+"if (!"+y+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+A+" } ",e.opts.messages!==!1&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+="} else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t}),cs}var us,Vi;function Hd(){return Vi||(Vi=1,us=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y=e.opts.$data&&o&&o.$data,u;y?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",u="schema"+n):u=o;var f=y?"(new RegExp("+u+"))":e.usePattern(o);t+="if ( ",y&&(t+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),t+=" !"+f+".test("+p+") ) {   ";var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",y?t+=""+u:t+=""+e.util.toQuotedString(o),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match pattern "`,y?t+="' + "+u+" + '":t+=""+e.util.escapeQuotes(o),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",y?t+="validate.schema"+l:t+=""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var m=t;return t=g.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+m+"]); ":t+=" validate.errors = ["+m+"]; return false; ":t+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",h&&(t+=" else { "),t}),us}var ds,Hi;function Bd(){return Hi||(Hi=1,ds=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var g="valid"+u.level,m="key"+n,w="idx"+n,$=u.dataLevel=e.dataLevel+1,A="data"+$,b="dataProperties"+n,E=Object.keys(o||{}).filter(be),x=e.schema.patternProperties||{},T=Object.keys(x).filter(be),O=e.schema.additionalProperties,C=E.length||T.length,S=O===!1,R=typeof O=="object"&&Object.keys(O).length,D=e.opts.removeAdditional,M=S||R||D,F=e.opts.ownProperties,te=e.baseId,pe=e.schema.required;if(pe&&!(e.opts.$data&&pe.$data)&&pe.length<e.opts.loopRequired)var se=e.util.toHash(pe);function be(Ia){return Ia!=="__proto__"}if(t+="var "+y+" = errors;var "+g+" = true;",F&&(t+=" var "+b+" = undefined;"),M){if(F?t+=" "+b+" = "+b+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+b+".length; "+w+"++) { var "+m+" = "+b+"["+w+"]; ":t+=" for (var "+m+" in "+p+") { ",C){if(t+=" var isAdditional"+n+" = !(false ",E.length)if(E.length>8)t+=" || validate.schema"+l+".hasOwnProperty("+m+") ";else{var ue=E;if(ue)for(var de,tt=-1,Xe=ue.length-1;tt<Xe;)de=ue[tt+=1],t+=" || "+m+" == "+e.util.toQuotedString(de)+" "}if(T.length){var We=T;if(We)for(var Ue,gt=-1,P=We.length-1;gt<P;)Ue=We[gt+=1],t+=" || "+e.usePattern(Ue)+".test("+m+") "}t+=" ); if (isAdditional"+n+") { "}if(D=="all")t+=" delete "+p+"["+m+"]; ";else{var N=e.errorPath,H="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),S)if(D)t+=" delete "+p+"["+m+"]; ";else{t+=" "+g+" = false; ";var ce=c;c=e.errSchemaPath+"/additionalProperties";var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+H+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var V=t;t=j.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+V+"]); ":t+=" validate.errors = ["+V+"]; return false; ":t+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=ce,h&&(t+=" break; ")}else if(R)if(D=="failing"){t+=" var "+y+" = errors;  ";var ge=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.schema=O,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var Ee=p+"["+m+"]";u.dataPathArr[$]=m;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",t+=" if (!"+g+") { errors = "+y+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+m+"]; }  ",e.compositeRule=u.compositeRule=ge}else{u.schema=O,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var Ee=p+"["+m+"]";u.dataPathArr[$]=m;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",h&&(t+=" if (!"+g+") break; ")}e.errorPath=N}C&&(t+=" } "),t+=" }  ",h&&(t+=" if ("+g+") { ",f+="}")}var je=e.opts.useDefaults&&!e.compositeRule;if(E.length){var Ae=E;if(Ae)for(var de,Te=-1,et=Ae.length-1;Te<et;){de=Ae[Te+=1];var Me=o[de];if(e.opts.strictKeywords?typeof Me=="object"&&Object.keys(Me).length>0||Me===!1:e.util.schemaHasRules(Me,e.RULES.all)){var xt=e.util.getProperty(de),Ee=p+xt,rt=je&&Me.default!==void 0;u.schema=Me,u.schemaPath=l+xt,u.errSchemaPath=c+"/"+e.util.escapeFragment(de),u.errorPath=e.util.getPath(e.errorPath,de,e.opts.jsonPointers),u.dataPathArr[$]=e.util.toQuotedString(de);var we=e.validate(u);if(u.baseId=te,e.util.varOccurences(we,A)<2){we=e.util.varReplace(we,A,Ee);var Ze=Ee}else{var Ze=A;t+=" var "+A+" = "+Ee+"; "}if(rt)t+=" "+we+" ";else{if(se&&se[de]){t+=" if ( "+Ze+" === undefined ",F&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=") { "+g+" = false; ";var N=e.errorPath,ce=c,ze=e.util.escapeQuotes(de);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(N,de,e.opts.jsonPointers)),c=e.errSchemaPath+"/required";var j=j||[];j.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+ze+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+ze+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var V=t;t=j.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+V+"]); ":t+=" validate.errors = ["+V+"]; return false; ":t+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=ce,e.errorPath=N,t+=" } else { "}else h?(t+=" if ( "+Ze+" === undefined ",F&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=") { "+g+" = true; } else { "):(t+=" if ("+Ze+" !== undefined ",F&&(t+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(de)+"') "),t+=" ) { ");t+=" "+we+" } "}}h&&(t+=" if ("+g+") { ",f+="}")}}if(T.length){var ut=T;if(ut)for(var Ue,Vr=-1,ka=ut.length-1;Vr<ka;){Ue=ut[Vr+=1];var Me=x[Ue];if(e.opts.strictKeywords?typeof Me=="object"&&Object.keys(Me).length>0||Me===!1:e.util.schemaHasRules(Me,e.RULES.all)){u.schema=Me,u.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(Ue),u.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(Ue),F?t+=" "+b+" = "+b+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+b+".length; "+w+"++) { var "+m+" = "+b+"["+w+"]; ":t+=" for (var "+m+" in "+p+") { ",t+=" if ("+e.usePattern(Ue)+".test("+m+")) { ",u.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var Ee=p+"["+m+"]";u.dataPathArr[$]=m;var we=e.validate(u);u.baseId=te,e.util.varOccurences(we,A)<2?t+=" "+e.util.varReplace(we,A,Ee)+" ":t+=" var "+A+" = "+Ee+"; "+we+" ",h&&(t+=" if (!"+g+") break; "),t+=" } ",h&&(t+=" else "+g+" = true; "),t+=" }  ",h&&(t+=" if ("+g+") { ",f+="}")}}}return h&&(t+=" "+f+" if ("+y+" == errors) {"),t}),ds}var hs,Bi;function Gd(){return Bi||(Bi=1,hs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="errs__"+n,u=e.util.copy(e),f="";u.level++;var g="valid"+u.level;if(t+="var "+y+" = errors;",e.opts.strictKeywords?typeof o=="object"&&Object.keys(o).length>0||o===!1:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=l,u.errSchemaPath=c;var m="key"+n,w="idx"+n,$="i"+n,A="' + "+m+" + '",b=u.dataLevel=e.dataLevel+1,E="data"+b,x="dataProperties"+n,T=e.opts.ownProperties,O=e.baseId;T&&(t+=" var "+x+" = undefined; "),T?t+=" "+x+" = "+x+" || Object.keys("+p+"); for (var "+w+"=0; "+w+"<"+x+".length; "+w+"++) { var "+m+" = "+x+"["+w+"]; ":t+=" for (var "+m+" in "+p+") { ",t+=" var startErrs"+n+" = errors; ";var C=m,S=e.compositeRule;e.compositeRule=u.compositeRule=!0;var R=e.validate(u);u.baseId=O,e.util.varOccurences(R,E)<2?t+=" "+e.util.varReplace(R,E,C)+" ":t+=" var "+E+" = "+C+"; "+R+" ",e.compositeRule=u.compositeRule=S,t+=" if (!"+g+") { for (var "+$+"=startErrs"+n+"; "+$+"<errors; "+$+"++) { vErrors["+$+"].propertyName = "+m+"; }   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+A+"' } ",e.opts.messages!==!1&&(t+=" , message: 'property name \\'"+A+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),h&&(t+=" break; "),t+=" } }"}return h&&(t+=" "+f+" if ("+y+" == errors) {"),t}),hs}var fs,Gi;function Qd(){return Gi||(Gi=1,fs=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data;u&&(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ");var f="schema"+n;if(!u)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var g=[],m=o;if(m)for(var w,$=-1,A=m.length-1;$<A;){w=m[$+=1];var b=e.schema.properties[w];b&&(e.opts.strictKeywords?typeof b=="object"&&Object.keys(b).length>0||b===!1:e.util.schemaHasRules(b,e.RULES.all))||(g[g.length]=w)}}else var g=o;if(u||g.length){var E=e.errorPath,x=u||g.length>=e.opts.loopRequired,T=e.opts.ownProperties;if(h)if(t+=" var missing"+n+"; ",x){u||(t+=" var "+f+" = validate.schema"+l+"; ");var O="i"+n,C="schema"+n+"["+O+"]",S="' + "+C+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(E,C,e.opts.jsonPointers)),t+=" var "+y+" = true; ",u&&(t+=" if (schema"+n+" === undefined) "+y+" = true; else if (!Array.isArray(schema"+n+")) "+y+" = false; else {"),t+=" for (var "+O+" = 0; "+O+" < "+f+".length; "+O+"++) { "+y+" = "+p+"["+f+"["+O+"]] !== undefined ",T&&(t+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+f+"["+O+"]) "),t+="; if (!"+y+") break; } ",u&&(t+="  }  "),t+="  if (!"+y+") {   ";var R=R||[];R.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var D=t;t=R.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+D+"]); ":t+=" validate.errors = ["+D+"]; return false; ":t+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var M=g;if(M)for(var F,O=-1,te=M.length-1;O<te;){F=M[O+=1],O&&(t+=" || ");var pe=e.util.getProperty(F),se=p+pe;t+=" ( ( "+se+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(F)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?F:pe)+") ) "}t+=") {  ";var C="missing"+n,S="' + "+C+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(E,C,!0):E+" + "+C);var R=R||[];R.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var D=t;t=R.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+D+"]); ":t+=" validate.errors = ["+D+"]; return false; ":t+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(x){u||(t+=" var "+f+" = validate.schema"+l+"; ");var O="i"+n,C="schema"+n+"["+O+"]",S="' + "+C+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(E,C,e.opts.jsonPointers)),u&&(t+=" if ("+f+" && !Array.isArray("+f+")) {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+f+" !== undefined) { "),t+=" for (var "+O+" = 0; "+O+" < "+f+".length; "+O+"++) { if ("+p+"["+f+"["+O+"]] === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+f+"["+O+"]) "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",u&&(t+="  }  ")}else{var be=g;if(be)for(var F,ue=-1,de=be.length-1;ue<de;){F=be[ue+=1];var pe=e.util.getProperty(F),S=e.util.escapeQuotes(F),se=p+pe;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(E,F,e.opts.jsonPointers)),t+=" if ( "+se+" === undefined ",T&&(t+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(F)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+S+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+S+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=E}else h&&(t+=" if (true) {");return t}),fs}var ps,Qi;function Kd(){return Qi||(Qi=1,ps=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p="data"+(i||""),y="valid"+n,u=e.opts.$data&&o&&o.$data,f;if(u?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",f="schema"+n):f=o,(o||u)&&e.opts.uniqueItems!==!1){u&&(t+=" var "+y+"; if ("+f+" === false || "+f+" === undefined) "+y+" = true; else if (typeof "+f+" != 'boolean') "+y+" = false; else { "),t+=" var i = "+p+".length , "+y+" = true , j; if (i > 1) { ";var g=e.schema.items&&e.schema.items.type,m=Array.isArray(g);if(!g||g=="object"||g=="array"||m&&(g.indexOf("object")>=0||g.indexOf("array")>=0))t+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+p+"[i], "+p+"[j])) { "+y+" = false; break outer; } } } ";else{t+=" var itemIndices = {}, item; for (;i--;) { var item = "+p+"[i]; ";var w="checkDataType"+(m?"s":"");t+=" if ("+e.util[w](g,"item",e.opts.strictNumbers,!0)+") continue; ",m&&(t+=` if (typeof item == 'string') item = '"' + item; `),t+=" if (typeof itemIndices[item] == 'number') { "+y+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}t+=" } ",u&&(t+="  }  "),t+=" if (!"+y+") {   ";var $=$||[];$.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(t+=" , schema:  ",u?t+="validate.schema"+l:t+=""+o,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),t+=" } "):t+=" {} ";var A=t;t=$.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+A+"]); ":t+=" validate.errors = ["+A+"]; return false; ":t+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",h&&(t+=" else { ")}else h&&(t+=" if (true) { ");return t}),ps}var ms,Ki;function Jd(){return Ki||(Ki=1,ms={$ref:Od(),allOf:Cd(),anyOf:$d(),$comment:Dd(),const:Nd(),contains:jd(),dependencies:Ld(),enum:qd(),format:Md(),if:Fd(),items:Zd(),maximum:Di(),minimum:Di(),maxItems:ji(),minItems:ji(),maxLength:qi(),minLength:qi(),maxProperties:Fi(),minProperties:Fi(),multipleOf:Ud(),not:zd(),oneOf:Vd(),pattern:Hd(),properties:Bd(),propertyNames:Gd(),required:Qd(),uniqueItems:Kd(),validate:el()}),ms}var vs,Ji;function Wd(){if(Ji)return vs;Ji=1;var s=Jd(),e=Pr().toHash;return vs=function(){var a=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],i=["number","integer","string","array","object","boolean","null"];return a.all=e(t),a.types=e(i),a.forEach(function(o){o.rules=o.rules.map(function(l){var c;if(typeof l=="object"){var h=Object.keys(l)[0];c=l[h],l=h,c.forEach(function(y){t.push(y),a.all[y]=!0})}t.push(l);var p=a.all[l]={keyword:l,code:s[l],implements:c};return p}),a.all.$comment={keyword:"$comment",code:s.$comment},o.type&&(a.types[o.type]=o)}),a.keywords=e(t.concat(n)),a.custom={},a},vs}var gs,Wi;function Yd(){if(Wi)return gs;Wi=1;var s=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];return gs=function(e,r){for(var a=0;a<r.length;a++){e=JSON.parse(JSON.stringify(e));var t=r[a].split("/"),n=e,i;for(i=1;i<t.length;i++)n=n[t[i]];for(i=0;i<s.length;i++){var o=s[i],l=n[o];l&&(n[o]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e},gs}var ys,Yi;function Xd(){if(Yi)return ys;Yi=1;var s=_n().MissingRef;ys=e;function e(r,a,t){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof a=="function"&&(t=a,a=void 0);var i=o(r).then(function(){var c=n._addSchema(r,void 0,a);return c.validate||l(c)});return t&&i.then(function(c){t(null,c)},t),i;function o(c){var h=c.$schema;return h&&!n.getSchema(h)?e.call(n,{$ref:h},!0):Promise.resolve()}function l(c){try{return n._compile(c)}catch(p){if(p instanceof s)return h(p);throw p}function h(p){var y=p.missingSchema;if(g(y))throw new Error("Schema "+y+" is loaded but "+p.missingRef+" cannot be resolved");var u=n._loadingSchemas[y];return u||(u=n._loadingSchemas[y]=n._opts.loadSchema(y),u.then(f,f)),u.then(function(m){if(!g(y))return o(m).then(function(){g(y)||n.addSchema(m,y,void 0,a)})}).then(function(){return l(c)});function f(){delete n._loadingSchemas[y]}function g(m){return n._refs[m]||n._schemas[m]}}}}return ys}var _s,Xi;function eh(){return Xi||(Xi=1,_s=function(e,r,a){var t=" ",n=e.level,i=e.dataLevel,o=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,h=!e.opts.allErrors,p,y="data"+(i||""),u="valid"+n,f="errs__"+n,g=e.opts.$data&&o&&o.$data,m;g?(t+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",m="schema"+n):m=o;var w=this,$="definition"+n,A=w.definition,b="",E,x,T,O,C;if(g&&A.$data){C="keywordValidate"+n;var S=A.validateSchema;t+=" var "+$+" = RULES.custom['"+r+"'].definition; var "+C+" = "+$+".validate;"}else{if(O=e.useCustomRule(w,o,e.schema,e),!O)return;m="validate.schema"+l,C=O.code,E=A.compile,x=A.inline,T=A.macro}var R=C+".errors",D="i"+n,M="ruleErr"+n,F=A.async;if(F&&!e.async)throw new Error("async keyword in sync schema");if(x||T||(t+=""+R+" = null;"),t+="var "+f+" = errors;var "+u+";",g&&A.$data&&(b+="}",t+=" if ("+m+" === undefined) { "+u+" = true; } else { ",S&&(b+="}",t+=" "+u+" = "+$+".validateSchema("+m+"); if ("+u+") { ")),x)A.statements?t+=" "+O.validate+" ":t+=" "+u+" = "+O.validate+"; ";else if(T){var te=e.util.copy(e),b="";te.level++;var pe="valid"+te.level;te.schema=O.validate,te.schemaPath="";var se=e.compositeRule;e.compositeRule=te.compositeRule=!0;var be=e.validate(te).replace(/validate\.schema/g,C);e.compositeRule=te.compositeRule=se,t+=" "+be}else{var ue=ue||[];ue.push(t),t="",t+="  "+C+".call( ",e.opts.passContext?t+="this":t+="self",E||A.schema===!1?t+=" , "+y+" ":t+=" , "+m+" , "+y+" , validate.schema"+e.schemaPath+" ",t+=" , (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var de=i?"data"+(i-1||""):"parentData",tt=i?e.dataPathArr[i]:"parentDataProperty";t+=" , "+de+" , "+tt+" , rootData )  ";var Xe=t;t=ue.pop(),A.errors===!1?(t+=" "+u+" = ",F&&(t+="await "),t+=""+Xe+"; "):F?(R="customErrors"+n,t+=" var "+R+" = null; try { "+u+" = await "+Xe+"; } catch (e) { "+u+" = false; if (e instanceof ValidationError) "+R+" = e.errors; else throw e; } "):t+=" "+R+" = null; "+u+" = "+Xe+"; "}if(A.modifying&&(t+=" if ("+de+") "+y+" = "+de+"["+tt+"];"),t+=""+b,A.valid)h&&(t+=" if (true) { ");else{t+=" if ( ",A.valid===void 0?(t+=" !",T?t+=""+pe:t+=""+u):t+=" "+!A.valid+" ",t+=") { ",p=w.keyword;var ue=ue||[];ue.push(t),t="";var ue=ue||[];ue.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var We=t;t=ue.pop(),!e.compositeRule&&h?e.async?t+=" throw new ValidationError(["+We+"]); ":t+=" validate.errors = ["+We+"]; return false; ":t+=" var err = "+We+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var Ue=t;t=ue.pop(),x?A.errors?A.errors!="full"&&(t+="  for (var "+D+"="+f+"; "+D+"<errors; "+D+"++) { var "+M+" = vErrors["+D+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+M+".schema = "+m+"; "+M+".data = "+y+"; "),t+=" } "):A.errors===!1?t+=" "+Ue+" ":(t+=" if ("+f+" == errors) { "+Ue+" } else {  for (var "+D+"="+f+"; "+D+"<errors; "+D+"++) { var "+M+" = vErrors["+D+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+M+".schema = "+m+"; "+M+".data = "+y+"; "),t+=" } } "):T?(t+="   var err =   ",e.createErrors!==!1?(t+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+w.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+w.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; ")):A.errors===!1?t+=" "+Ue+" ":(t+=" if (Array.isArray("+R+")) { if (vErrors === null) vErrors = "+R+"; else vErrors = vErrors.concat("+R+"); errors = vErrors.length;  for (var "+D+"="+f+"; "+D+"<errors; "+D+"++) { var "+M+" = vErrors["+D+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+";  "+M+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(t+=" "+M+".schema = "+m+"; "+M+".data = "+y+"; "),t+=" } } else { "+Ue+" } "),t+=" } ",h&&(t+=" else { ")}return t}),_s}const th="http://json-schema.org/draft-07/schema#",rh="http://json-schema.org/draft-07/schema#",ah="Core schema meta-schema",sh={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},nh=["object","boolean"],ih={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},tl={$schema:th,$id:rh,title:ah,definitions:sh,type:nh,properties:ih,default:!0};var bs,eo;function oh(){if(eo)return bs;eo=1;var s=tl;return bs={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:s.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:s.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},bs}var ws,to;function lh(){if(to)return ws;to=1;var s=/^[a-z_$][a-z0-9_$-]*$/i,e=eh(),r=oh();ws={add:a,get:t,remove:n,validate:i};function a(o,l){var c=this.RULES;if(c.keywords[o])throw new Error("Keyword "+o+" is already defined");if(!s.test(o))throw new Error("Keyword "+o+" is not a valid identifier");if(l){this.validateKeyword(l,!0);var h=l.type;if(Array.isArray(h))for(var p=0;p<h.length;p++)u(o,h[p],l);else u(o,h,l);var y=l.metaSchema;y&&(l.$data&&this._opts.$data&&(y={anyOf:[y,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),l.validateSchema=this.compile(y,!0))}c.keywords[o]=c.all[o]=!0;function u(f,g,m){for(var w,$=0;$<c.length;$++){var A=c[$];if(A.type==g){w=A;break}}w||(w={type:g,rules:[]},c.push(w));var b={keyword:f,definition:m,custom:!0,code:e,implements:m.implements};w.rules.push(b),c.custom[f]=b}return this}function t(o){var l=this.RULES.custom[o];return l?l.definition:this.RULES.keywords[o]||!1}function n(o){var l=this.RULES;delete l.keywords[o],delete l.all[o],delete l.custom[o];for(var c=0;c<l.length;c++)for(var h=l[c].rules,p=0;p<h.length;p++)if(h[p].keyword==o){h.splice(p,1);break}return this}function i(o,l){i.errors=null;var c=this._validateKeyword=this._validateKeyword||this.compile(r,!0);if(c(o))return!0;if(i.errors=c.errors,l)throw new Error("custom keyword definition is invalid: "+this.errorsText(c.errors));return!1}return ws}const ch="http://json-schema.org/draft-07/schema#",uh="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",dh="Meta-schema for $data reference (JSON Schema extension proposal)",hh="object",fh=["$data"],ph={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},mh=!1,vh={$schema:ch,$id:uh,description:dh,type:hh,required:fh,properties:ph,additionalProperties:mh};var Ss,ro;function gh(){if(ro)return Ss;ro=1;var s=Id(),e=yn(),r=Ad(),a=Yo(),t=Xo(),n=Td(),i=Wd(),o=Yd(),l=Pr();Ss=f,f.prototype.validate=g,f.prototype.compile=m,f.prototype.addSchema=w,f.prototype.addMetaSchema=$,f.prototype.validateSchema=A,f.prototype.getSchema=E,f.prototype.removeSchema=O,f.prototype.addFormat=se,f.prototype.errorsText=pe,f.prototype._addSchema=S,f.prototype._compile=R,f.prototype.compileAsync=Xd();var c=lh();f.prototype.addKeyword=c.add,f.prototype.getKeyword=c.get,f.prototype.removeKeyword=c.remove,f.prototype.validateKeyword=c.validate;var h=_n();f.ValidationError=h.Validation,f.MissingRefError=h.MissingRef,f.$dataMetaSchema=o;var p="http://json-schema.org/draft-07/schema",y=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],u=["/properties"];function f(P){if(!(this instanceof f))return new f(P);P=this._opts=l.copy(P)||{},Ue(this),this._schemas={},this._refs={},this._fragments={},this._formats=n(P.format),this._cache=P.cache||new r,this._loadingSchemas={},this._compilations=[],this.RULES=i(),this._getId=D(P),P.loopRequired=P.loopRequired||1/0,P.errorDataPath=="property"&&(P._errorDataPathProperty=!0),P.serialize===void 0&&(P.serialize=t),this._metaOpts=We(this),P.formats&&de(this),P.keywords&&tt(this),be(this),typeof P.meta=="object"&&this.addMetaSchema(P.meta),P.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),ue(this)}function g(P,N){var H;if(typeof P=="string"){if(H=this.getSchema(P),!H)throw new Error('no schema with key or ref "'+P+'"')}else{var ce=this._addSchema(P);H=ce.validate||this._compile(ce)}var j=H(N);return H.$async!==!0&&(this.errors=H.errors),j}function m(P,N){var H=this._addSchema(P,void 0,N);return H.validate||this._compile(H)}function w(P,N,H,ce){if(Array.isArray(P)){for(var j=0;j<P.length;j++)this.addSchema(P[j],void 0,H,ce);return this}var V=this._getId(P);if(V!==void 0&&typeof V!="string")throw new Error("schema id must be string");return N=e.normalizeId(N||V),Xe(this,N),this._schemas[N]=this._addSchema(P,H,ce,!0),this}function $(P,N,H){return this.addSchema(P,N,H,!0),this}function A(P,N){var H=P.$schema;if(H!==void 0&&typeof H!="string")throw new Error("$schema must be a string");if(H=H||this._opts.defaultMeta||b(this),!H)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var ce=this.validate(H,P);if(!ce&&N){var j="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(j);else throw new Error(j)}return ce}function b(P){var N=P._opts.meta;return P._opts.defaultMeta=typeof N=="object"?P._getId(N)||N:P.getSchema(p)?p:void 0,P._opts.defaultMeta}function E(P){var N=T(this,P);switch(typeof N){case"object":return N.validate||this._compile(N);case"string":return this.getSchema(N);case"undefined":return x(this,P)}}function x(P,N){var H=e.schema.call(P,{schema:{}},N);if(H){var ce=H.schema,j=H.root,V=H.baseId,ge=s.call(P,ce,j,void 0,V);return P._fragments[N]=new a({ref:N,fragment:!0,schema:ce,root:j,baseId:V,validate:ge}),ge}}function T(P,N){return N=e.normalizeId(N),P._schemas[N]||P._refs[N]||P._fragments[N]}function O(P){if(P instanceof RegExp)return C(this,this._schemas,P),C(this,this._refs,P),this;switch(typeof P){case"undefined":return C(this,this._schemas),C(this,this._refs),this._cache.clear(),this;case"string":var N=T(this,P);return N&&this._cache.del(N.cacheKey),delete this._schemas[P],delete this._refs[P],this;case"object":var H=this._opts.serialize,ce=H?H(P):P;this._cache.del(ce);var j=this._getId(P);j&&(j=e.normalizeId(j),delete this._schemas[j],delete this._refs[j])}return this}function C(P,N,H){for(var ce in N){var j=N[ce];!j.meta&&(!H||H.test(ce))&&(P._cache.del(j.cacheKey),delete N[ce])}}function S(P,N,H,ce){if(typeof P!="object"&&typeof P!="boolean")throw new Error("schema should be object or boolean");var j=this._opts.serialize,V=j?j(P):P,ge=this._cache.get(V);if(ge)return ge;ce=ce||this._opts.addUsedSchema!==!1;var Ee=e.normalizeId(this._getId(P));Ee&&ce&&Xe(this,Ee);var we=this._opts.validateSchema!==!1&&!N,je;we&&!(je=Ee&&Ee==e.normalizeId(P.$schema))&&this.validateSchema(P,!0);var Ae=e.ids.call(this,P),Te=new a({id:Ee,schema:P,localRefs:Ae,cacheKey:V,meta:H});return Ee[0]!="#"&&ce&&(this._refs[Ee]=Te),this._cache.put(V,Te),we&&je&&this.validateSchema(P,!0),Te}function R(P,N){if(P.compiling)return P.validate=j,j.schema=P.schema,j.errors=null,j.root=N||j,P.schema.$async===!0&&(j.$async=!0),j;P.compiling=!0;var H;P.meta&&(H=this._opts,this._opts=this._metaOpts);var ce;try{ce=s.call(this,P.schema,N,P.localRefs)}catch(V){throw delete P.validate,V}finally{P.compiling=!1,P.meta&&(this._opts=H)}return P.validate=ce,P.refs=ce.refs,P.refVal=ce.refVal,P.root=ce.root,ce;function j(){var V=P.validate,ge=V.apply(this,arguments);return j.errors=V.errors,ge}}function D(P){switch(P.schemaId){case"auto":return te;case"id":return M;default:return F}}function M(P){return P.$id&&this.logger.warn("schema $id ignored",P.$id),P.id}function F(P){return P.id&&this.logger.warn("schema id ignored",P.id),P.$id}function te(P){if(P.$id&&P.id&&P.$id!=P.id)throw new Error("schema $id is different from id");return P.$id||P.id}function pe(P,N){if(P=P||this.errors,!P)return"No errors";N=N||{};for(var H=N.separator===void 0?", ":N.separator,ce=N.dataVar===void 0?"data":N.dataVar,j="",V=0;V<P.length;V++){var ge=P[V];ge&&(j+=ce+ge.dataPath+" "+ge.message+H)}return j.slice(0,-H.length)}function se(P,N){return typeof N=="string"&&(N=new RegExp(N)),this._formats[P]=N,this}function be(P){var N;if(P._opts.$data&&(N=vh,P.addMetaSchema(N,N.$id,!0)),P._opts.meta!==!1){var H=tl;P._opts.$data&&(H=o(H,u)),P.addMetaSchema(H,p,!0),P._refs["http://json-schema.org/schema"]=p}}function ue(P){var N=P._opts.schemas;if(N)if(Array.isArray(N))P.addSchema(N);else for(var H in N)P.addSchema(N[H],H)}function de(P){for(var N in P._opts.formats){var H=P._opts.formats[N];P.addFormat(N,H)}}function tt(P){for(var N in P._opts.keywords){var H=P._opts.keywords[N];P.addKeyword(N,H)}}function Xe(P,N){if(P._schemas[N]||P._refs[N])throw new Error('schema with key or id "'+N+'" already exists')}function We(P){for(var N=l.copy(P._opts),H=0;H<y.length;H++)delete N[y[H]];return N}function Ue(P){var N=P._opts.logger;if(N===!1)P.logger={log:gt,warn:gt,error:gt};else{if(N===void 0&&(N=console),!(typeof N=="object"&&N.log&&N.warn&&N.error))throw new Error("logger must implement log, warn and error methods");P.logger=N}}function gt(){}return Ss}var yh=gh();const _h=wl(yh);class bh extends Sd{constructor(e,r){var a;super(r),this._serverInfo=e,this._capabilities=(a=r?.capabilities)!==null&&a!==void 0?a:{},this._instructions=r?.instructions,this.setRequestHandler(Fo,t=>this._oninitialize(t)),this.setNotificationHandler(Zo,()=>{var t;return(t=this.oninitialized)===null||t===void 0?void 0:t.call(this)})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Ed(this._capabilities,e)}assertCapabilityForMethod(e){var r,a,t;switch(e){case"sampling/createMessage":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break}}async _oninitialize(e){const r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Iu.includes(r)?r:Co,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},cn)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},Ko,r)}async elicitInput(e,r){const a=await this.request({method:"elicitation/create",params:e},Jo,r);if(a.action==="accept"&&a.content)try{const t=new _h,n=t.compile(e.requestedSchema);if(!n(a.content))throw new Be(Fe.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(n.errors)}`)}catch(t){throw t instanceof Be?t:new Be(Fe.InternalError,`Error validating elicitation response: ${t}`)}return a}async listRoots(e,r){return this.request({method:"roots/list",params:e},Wo,r)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}const wh=Symbol("Let zodToJsonSchema decide on which parser to use"),ao={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Sh=s=>typeof s=="string"?{...ao,name:s}:{...ao,...s},Eh=s=>{const e=Sh(s),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([a,t])=>[t._def,{def:t._def,path:[...e.basePath,e.definitionPath,a],jsonSchema:void 0}]))}};function rl(s,e,r,a){a?.errorMessages&&r&&(s.errorMessage={...s.errorMessage,[e]:r})}function $e(s,e,r,a,t){s[e]=r,rl(s,e,a,t)}const al=(s,e)=>{let r=0;for(;r<s.length&&r<e.length&&s[r]===e[r];r++);return[(s.length-r).toString(),...e.slice(r)].join("/")};var jr;(function(s){s.assertEqual=t=>{};function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{const n={};for(const i of t)n[i]=i;return n},s.getValidEnumValues=t=>{const n=s.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),i={};for(const o of n)i[o]=t[o];return s.objectValues(i)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(i);return n},s.find=(t,n)=>{for(const i of t)if(n(i))return i},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&Number.isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(jr||(jr={}));var so;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(so||(so={}));jr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);jr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ga extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(t);else if(i.code==="invalid_return_type")t(i.returnTypeError);else if(i.code==="invalid_arguments")t(i.argumentsError);else if(i.path.length===0)a._errors.push(r(i));else{let o=a,l=0;for(;l<i.path.length;){const c=i.path[l];l===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(i))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof ga))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,jr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r=Object.create(null),a=[];for(const t of this.issues)if(t.path.length>0){const n=t.path[0];r[n]=r[n]||[],r[n].push(e(t))}else a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}}ga.create=s=>new ga(s);var no;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(no||(no={}));var fe;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(fe||(fe={}));function ht(s){if(s.target!=="openAi")return{};const e=[...s.basePath,s.definitionPath,s.openAiAnyTypeName];return s.flags.hasReferencedOpenAiAnyType=!0,{$ref:s.$refStrategy==="relative"?al(e,s.currentPath):e.join("/")}}function Ph(s,e){const r={type:"array"};return s.type?._def&&s.type?._def?.typeName!==fe.ZodAny&&(r.items=Oe(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&$e(r,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&$e(r,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&($e(r,"minItems",s.exactLength.value,s.exactLength.message,e),$e(r,"maxItems",s.exactLength.value,s.exactLength.message,e)),r}function xh(s,e){const r={type:"integer",format:"int64"};if(!s.checks)return r;for(const a of s.checks)switch(a.kind){case"min":e.target==="jsonSchema7"?a.inclusive?$e(r,"minimum",a.value,a.message,e):$e(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),$e(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?$e(r,"maximum",a.value,a.message,e):$e(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),$e(r,"maximum",a.value,a.message,e));break;case"multipleOf":$e(r,"multipleOf",a.value,a.message,e);break}return r}function Rh(){return{type:"boolean"}}function sl(s,e){return Oe(s.type._def,e)}const kh=(s,e)=>Oe(s.innerType._def,e);function nl(s,e,r){const a=r??e.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((t,n)=>nl(s,e,t))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Ih(s,e)}}const Ih=(s,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const a of s.checks)switch(a.kind){case"min":$e(r,"minimum",a.value,a.message,e);break;case"max":$e(r,"maximum",a.value,a.message,e);break}return r};function Ah(s,e){return{...Oe(s.innerType._def,e),default:s.defaultValue()}}function Th(s,e){return e.effectStrategy==="input"?Oe(s.schema._def,e):ht(e)}function Oh(s){return{type:"string",enum:Array.from(s.values)}}const Ch=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function $h(s,e){const r=[Oe(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Oe(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n);let a=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const t=[];return r.forEach(n=>{if(Ch(n))t.push(...n.allOf),n.unevaluatedProperties===void 0&&(a=void 0);else{let i=n;if("additionalProperties"in n&&n.additionalProperties===!1){const{additionalProperties:o,...l}=n;i=l}else a=void 0;t.push(i)}}),t.length?{allOf:t,...a}:void 0}function Dh(s,e){const r=typeof s.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[s.value]}:{type:r==="bigint"?"integer":r,const:s.value}}let Es;const Rt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Es===void 0&&(Es=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Es),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function il(s,e){const r={type:"string"};if(s.checks)for(const a of s.checks)switch(a.kind){case"min":$e(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e);break;case"max":$e(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":kt(r,"email",a.message,e);break;case"format:idn-email":kt(r,"idn-email",a.message,e);break;case"pattern:zod":at(r,Rt.email,a.message,e);break}break;case"url":kt(r,"uri",a.message,e);break;case"uuid":kt(r,"uuid",a.message,e);break;case"regex":at(r,a.regex,a.message,e);break;case"cuid":at(r,Rt.cuid,a.message,e);break;case"cuid2":at(r,Rt.cuid2,a.message,e);break;case"startsWith":at(r,RegExp(`^${Ps(a.value,e)}`),a.message,e);break;case"endsWith":at(r,RegExp(`${Ps(a.value,e)}$`),a.message,e);break;case"datetime":kt(r,"date-time",a.message,e);break;case"date":kt(r,"date",a.message,e);break;case"time":kt(r,"time",a.message,e);break;case"duration":kt(r,"duration",a.message,e);break;case"length":$e(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e),$e(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"includes":{at(r,RegExp(Ps(a.value,e)),a.message,e);break}case"ip":{a.version!=="v6"&&kt(r,"ipv4",a.message,e),a.version!=="v4"&&kt(r,"ipv6",a.message,e);break}case"base64url":at(r,Rt.base64url,a.message,e);break;case"jwt":at(r,Rt.jwt,a.message,e);break;case"cidr":{a.version!=="v6"&&at(r,Rt.ipv4Cidr,a.message,e),a.version!=="v4"&&at(r,Rt.ipv6Cidr,a.message,e);break}case"emoji":at(r,Rt.emoji(),a.message,e);break;case"ulid":{at(r,Rt.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{kt(r,"binary",a.message,e);break}case"contentEncoding:base64":{$e(r,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{at(r,Rt.base64,a.message,e);break}}break}case"nanoid":at(r,Rt.nanoid,a.message,e)}return r}function Ps(s,e){return e.patternStrategy==="escape"?jh(s):s}const Nh=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function jh(s){let e="";for(let r=0;r<s.length;r++)Nh.has(s[r])||(e+="\\"),e+=s[r];return e}function kt(s,e,r,a){s.format||s.anyOf?.some(t=>t.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&a.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...r&&a.errorMessages&&{errorMessage:{format:r}}})):$e(s,"format",e,r,a)}function at(s,e,r,a){s.pattern||s.allOf?.some(t=>t.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&a.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:io(e,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):$e(s,"pattern",io(e,a),r,a)}function io(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;const r={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},a=r.i?s.source.toLowerCase():s.source;let t="",n=!1,i=!1,o=!1;for(let l=0;l<a.length;l++){if(n){t+=a[l],n=!1;continue}if(r.i){if(i){if(a[l].match(/[a-z]/)){o?(t+=a[l],t+=`${a[l-2]}-${a[l]}`.toUpperCase(),o=!1):a[l+1]==="-"&&a[l+2]?.match(/[a-z]/)?(t+=a[l],o=!0):t+=`${a[l]}${a[l].toUpperCase()}`;continue}}else if(a[l].match(/[a-z]/)){t+=`[${a[l]}${a[l].toUpperCase()}]`;continue}}if(r.m){if(a[l]==="^"){t+=`(^|(?<=[\r
]))`;continue}else if(a[l]==="$"){t+=`($|(?=[\r
]))`;continue}}if(r.s&&a[l]==="."){t+=i?`${a[l]}\r
`:`[${a[l]}\r
]`;continue}t+=a[l],a[l]==="\\"?n=!0:i&&a[l]==="]"?i=!1:!i&&a[l]==="["&&(i=!0)}try{new RegExp(t)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return t}function ol(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===fe.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((a,t)=>({...a,[t]:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",t]})??ht(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const r={type:"object",additionalProperties:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(s.keyType?._def.typeName===fe.ZodString&&s.keyType._def.checks?.length){const{type:a,...t}=il(s.keyType._def,e);return{...r,propertyNames:t}}else{if(s.keyType?._def.typeName===fe.ZodEnum)return{...r,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===fe.ZodBranded&&s.keyType._def.type._def.typeName===fe.ZodString&&s.keyType._def.type._def.checks?.length){const{type:a,...t}=sl(s.keyType._def,e);return{...r,propertyNames:t}}}return r}function Lh(s,e){if(e.mapStrategy==="record")return ol(s,e);const r=Oe(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||ht(e),a=Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||ht(e);return{type:"array",maxItems:125,items:{type:"array",items:[r,a],minItems:2,maxItems:2}}}function qh(s){const e=s.values,a=Object.keys(s.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),t=Array.from(new Set(a.map(n=>typeof n)));return{type:t.length===1?t[0]==="string"?"string":"number":["string","number"],enum:a}}function Mh(s){return s.target==="openAi"?void 0:{not:ht({...s,currentPath:[...s.currentPath,"not"]})}}function Fh(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ya={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Zh(s,e){if(e.target==="openApi3")return oo(s,e);const r=s.options instanceof Map?Array.from(s.options.values()):s.options;if(r.every(a=>a._def.typeName in ya&&(!a._def.checks||!a._def.checks.length))){const a=r.reduce((t,n)=>{const i=ya[n._def.typeName];return i&&!t.includes(i)?[...t,i]:t},[]);return{type:a.length>1?a:a[0]}}else if(r.every(a=>a._def.typeName==="ZodLiteral"&&!a.description)){const a=r.reduce((t,n)=>{const i=typeof n._def.value;switch(i){case"string":case"number":case"boolean":return[...t,i];case"bigint":return[...t,"integer"];case"object":if(n._def.value===null)return[...t,"null"];default:return t}},[]);if(a.length===r.length){const t=a.filter((n,i,o)=>o.indexOf(n)===i);return{type:t.length>1?t:t[0],enum:r.reduce((n,i)=>n.includes(i._def.value)?n:[...n,i._def.value],[])}}}else if(r.every(a=>a._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((a,t)=>[...a,...t._def.values.filter(n=>!a.includes(n))],[])};return oo(s,e)}const oo=(s,e)=>{const r=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((a,t)=>Oe(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${t}`]})).filter(a=>!!a&&(!e.strictUnions||typeof a=="object"&&Object.keys(a).length>0));return r.length?{anyOf:r}:void 0};function Uh(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:ya[s.innerType._def.typeName],nullable:!0}:{type:[ya[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const a=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:!0}:a&&{...a,nullable:!0}}const r=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function zh(s,e){const r={type:"number"};if(!s.checks)return r;for(const a of s.checks)switch(a.kind){case"int":r.type="integer",rl(r,"type",a.message,e);break;case"min":e.target==="jsonSchema7"?a.inclusive?$e(r,"minimum",a.value,a.message,e):$e(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),$e(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?$e(r,"maximum",a.value,a.message,e):$e(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),$e(r,"maximum",a.value,a.message,e));break;case"multipleOf":$e(r,"multipleOf",a.value,a.message,e);break}return r}function Vh(s,e){const r=e.target==="openAi",a={type:"object",properties:{}},t=[],n=s.shape();for(const o in n){let l=n[o];if(l===void 0||l._def===void 0)continue;let c=Bh(l);c&&r&&(l._def.typeName==="ZodOptional"&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const h=Oe(l._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});h!==void 0&&(a.properties[o]=h,c||t.push(o))}t.length&&(a.required=t);const i=Hh(s,e);return i!==void 0&&(a.additionalProperties=i),a}function Hh(s,e){if(s.catchall._def.typeName!=="ZodNever")return Oe(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Bh(s){try{return s.isOptional()}catch{return!0}}const Gh=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Oe(s.innerType._def,e);const r=Oe(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:ht(e)},r]}:ht(e)},Qh=(s,e)=>{if(e.pipeStrategy==="input")return Oe(s.in._def,e);if(e.pipeStrategy==="output")return Oe(s.out._def,e);const r=Oe(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),a=Oe(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(t=>t!==void 0)}};function Kh(s,e){return Oe(s.type._def,e)}function Jh(s,e){const a={type:"array",uniqueItems:!0,items:Oe(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&$e(a,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&$e(a,"maxItems",s.maxSize.value,s.maxSize.message,e),a}function Wh(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((r,a)=>Oe(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[]),additionalItems:Oe(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((r,a)=>Oe(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[])}}function Yh(s){return{not:ht(s)}}function Xh(s){return ht(s)}const ef=(s,e)=>Oe(s.innerType._def,e),tf=(s,e,r)=>{switch(e){case fe.ZodString:return il(s,r);case fe.ZodNumber:return zh(s,r);case fe.ZodObject:return Vh(s,r);case fe.ZodBigInt:return xh(s,r);case fe.ZodBoolean:return Rh();case fe.ZodDate:return nl(s,r);case fe.ZodUndefined:return Yh(r);case fe.ZodNull:return Fh(r);case fe.ZodArray:return Ph(s,r);case fe.ZodUnion:case fe.ZodDiscriminatedUnion:return Zh(s,r);case fe.ZodIntersection:return $h(s,r);case fe.ZodTuple:return Wh(s,r);case fe.ZodRecord:return ol(s,r);case fe.ZodLiteral:return Dh(s,r);case fe.ZodEnum:return Oh(s);case fe.ZodNativeEnum:return qh(s);case fe.ZodNullable:return Uh(s,r);case fe.ZodOptional:return Gh(s,r);case fe.ZodMap:return Lh(s,r);case fe.ZodSet:return Jh(s,r);case fe.ZodLazy:return()=>s.getter()._def;case fe.ZodPromise:return Kh(s,r);case fe.ZodNaN:case fe.ZodNever:return Mh(r);case fe.ZodEffects:return Th(s,r);case fe.ZodAny:return ht(r);case fe.ZodUnknown:return Xh(r);case fe.ZodDefault:return Ah(s,r);case fe.ZodBranded:return sl(s,r);case fe.ZodReadonly:return ef(s,r);case fe.ZodCatch:return kh(s,r);case fe.ZodPipeline:return Qh(s,r);case fe.ZodFunction:case fe.ZodVoid:case fe.ZodSymbol:return;default:return(a=>{})()}};function Oe(s,e,r=!1){const a=e.seen.get(s);if(e.override){const o=e.override?.(s,e,a,r);if(o!==wh)return o}if(a&&!r){const o=rf(a,e);if(o!==void 0)return o}const t={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,t);const n=tf(s,s.typeName,e),i=typeof n=="function"?Oe(n(),e):n;if(i&&af(s,e,i),e.postProcess){const o=e.postProcess(i,s,e);return t.jsonSchema=i,o}return t.jsonSchema=i,i}const rf=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:al(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((r,a)=>e.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),ht(e)):e.$refStrategy==="seen"?ht(e):void 0}},af=(s,e,r)=>(s.description&&(r.description=s.description,e.markdownDescription&&(r.markdownDescription=s.description)),r),lo=(s,e)=>{const r=Eh(e);let a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[c,h])=>({...l,[c]:Oe(h._def,{...r,currentPath:[...r.basePath,r.definitionPath,c]},!0)??ht(r)}),{}):void 0;const t=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=Oe(s._def,t===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,t]},!1)??ht(r),i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(n.title=i),r.flags.hasReferencedOpenAiAnyType&&(a||(a={}),a[r.openAiAnyTypeName]||(a[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:r.$refStrategy==="relative"?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));const o=t===void 0?a?{...n,[r.definitionPath]:a}:n:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,t].join("/"),[r.definitionPath]:{...a,[t]:n}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Js;(function(s){s.Completable="McpCompletable"})(Js||(Js={}));class Ws extends Se{_parse(e){const{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}}Ws.create=(s,e)=>new Ws({type:s,typeName:Js.Completable,complete:e.complete,...sf(e)});function sf(s){if(!s)return{};const{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(i,o)=>{var l,c;const{message:h}=s;return i.code==="invalid_enum_value"?{message:h??o.defaultError}:typeof o.data>"u"?{message:(l=h??a)!==null&&l!==void 0?l:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(c=h??r)!==null&&c!==void 0?c:o.defaultError}},description:t}}class nf{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new bh(e,r)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Gs.shape.method.value),this.server.assertCanSetRequestHandler(Qs.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(Gs,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{const a={name:e,title:r.title,description:r.description,inputSchema:r.inputSchema?lo(r.inputSchema,{strictUnions:!0}):of,annotations:r.annotations};return r.outputSchema&&(a.outputSchema=lo(r.outputSchema,{strictUnions:!0})),a})})),this.server.setRequestHandler(Qs,async(e,r)=>{const a=this._registeredTools[e.params.name];if(!a)throw new Be(Fe.InvalidParams,`Tool ${e.params.name} not found`);if(!a.enabled)throw new Be(Fe.InvalidParams,`Tool ${e.params.name} disabled`);let t;if(a.inputSchema){const n=await a.inputSchema.safeParseAsync(e.params.arguments);if(!n.success)throw new Be(Fe.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${n.error.message}`);const i=n.data,o=a.callback;try{t=await Promise.resolve(o(i,r))}catch(l){t={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:!0}}}else{const n=a.callback;try{t=await Promise.resolve(n(r))}catch(i){t={content:[{type:"text",text:i instanceof Error?i.message:String(i)}],isError:!0}}}if(a.outputSchema&&!t.isError){if(!t.structuredContent)throw new Be(Fe.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);const n=await a.outputSchema.safeParseAsync(t.structuredContent);if(!n.success)throw new Be(Fe.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${n.error.message}`)}return t}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Ks.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(Ks,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new Be(Fe.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){const a=this._registeredPrompts[r.name];if(!a)throw new Be(Fe.InvalidParams,`Prompt ${r.name} not found`);if(!a.enabled)throw new Be(Fe.InvalidParams,`Prompt ${r.name} disabled`);if(!a.argsSchema)return Kr;const t=a.argsSchema.shape[e.params.argument.name];if(!(t instanceof Ws))return Kr;const i=await t._def.complete(e.params.argument.value,e.params.context);return uo(i)}async handleResourceCompletion(e,r){const a=Object.values(this._registeredResourceTemplates).find(i=>i.resourceTemplate.uriTemplate.toString()===r.uri);if(!a){if(this._registeredResources[r.uri])return Kr;throw new Be(Fe.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}const t=a.resourceTemplate.completeCallback(e.params.argument.name);if(!t)return Kr;const n=await t(e.params.argument.value,e.params.context);return uo(n)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Us.shape.method.value),this.server.assertCanSetRequestHandler(zs.shape.method.value),this.server.assertCanSetRequestHandler(Vs.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(Us,async(e,r)=>{const a=Object.entries(this._registeredResources).filter(([n,i])=>i.enabled).map(([n,i])=>({uri:n,name:i.name,...i.metadata})),t=[];for(const n of Object.values(this._registeredResourceTemplates)){if(!n.resourceTemplate.listCallback)continue;const i=await n.resourceTemplate.listCallback(r);for(const o of i.resources)t.push({...n.metadata,...o})}return{resources:[...a,...t]}}),this.server.setRequestHandler(zs,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,a])=>({name:r,uriTemplate:a.resourceTemplate.uriTemplate.toString(),...a.metadata}))})),this.server.setRequestHandler(Vs,async(e,r)=>{const a=new URL(e.params.uri),t=this._registeredResources[a.toString()];if(t){if(!t.enabled)throw new Be(Fe.InvalidParams,`Resource ${a} disabled`);return t.readCallback(a,r)}for(const n of Object.values(this._registeredResourceTemplates)){const i=n.resourceTemplate.uriTemplate.match(a.toString());if(i)return n.readCallback(a,i,r)}throw new Be(Fe.InvalidParams,`Resource ${a} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Hs.shape.method.value),this.server.assertCanSetRequestHandler(Bs.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Hs,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?cf(r.argsSchema):void 0}))})),this.server.setRequestHandler(Bs,async(e,r)=>{const a=this._registeredPrompts[e.params.name];if(!a)throw new Be(Fe.InvalidParams,`Prompt ${e.params.name} not found`);if(!a.enabled)throw new Be(Fe.InvalidParams,`Prompt ${e.params.name} disabled`);if(a.argsSchema){const t=await a.argsSchema.safeParseAsync(e.params.arguments);if(!t.success)throw new Be(Fe.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${t.error.message}`);const n=t.data,i=a.callback;return await Promise.resolve(i(n,r))}else{const t=a.callback;return await Promise.resolve(t(r))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,r,...a){let t;typeof a[0]=="object"&&(t=a.shift());const n=a[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);const i=this._createRegisteredResource(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const i=this._createRegisteredResourceTemplate(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),i}}registerResource(e,r,a,t){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);const n=this._createRegisteredResource(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const n=this._createRegisteredResourceTemplate(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}}_createRegisteredResource(e,r,a,t,n){const i={name:e,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({uri:null}),update:o=>{typeof o.uri<"u"&&o.uri!==a&&(delete this._registeredResources[a],o.uri&&(this._registeredResources[o.uri]=i)),typeof o.name<"u"&&(i.name=o.name),typeof o.title<"u"&&(i.title=o.title),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResources[a]=i,i}_createRegisteredResourceTemplate(e,r,a,t,n){const i={resourceTemplate:a,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredResourceTemplates[e],o.name&&(this._registeredResourceTemplates[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.template<"u"&&(i.resourceTemplate=o.template),typeof o.metadata<"u"&&(i.metadata=o.metadata),typeof o.callback<"u"&&(i.readCallback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=i,i}_createRegisteredPrompt(e,r,a,t,n){const i={title:r,description:a,argsSchema:t===void 0?void 0:K(t),callback:n,enabled:!0,disable:()=>i.update({enabled:!1}),enable:()=>i.update({enabled:!0}),remove:()=>i.update({name:null}),update:o=>{typeof o.name<"u"&&o.name!==e&&(delete this._registeredPrompts[e],o.name&&(this._registeredPrompts[o.name]=i)),typeof o.title<"u"&&(i.title=o.title),typeof o.description<"u"&&(i.description=o.description),typeof o.argsSchema<"u"&&(i.argsSchema=K(o.argsSchema)),typeof o.callback<"u"&&(i.callback=o.callback),typeof o.enabled<"u"&&(i.enabled=o.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=i,i}_createRegisteredTool(e,r,a,t,n,i,o){const l={title:r,description:a,inputSchema:t===void 0?void 0:K(t),outputSchema:n===void 0?void 0:K(n),annotations:i,callback:o,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredTools[e],c.name&&(this._registeredTools[c.name]=l)),typeof c.title<"u"&&(l.title=c.title),typeof c.description<"u"&&(l.description=c.description),typeof c.paramsSchema<"u"&&(l.inputSchema=K(c.paramsSchema)),typeof c.callback<"u"&&(l.callback=c.callback),typeof c.annotations<"u"&&(l.annotations=c.annotations),typeof c.enabled<"u"&&(l.enabled=c.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let a,t,n,i;if(typeof r[0]=="string"&&(a=r.shift()),r.length>1){const l=r[0];co(l)?(t=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!co(r[0])&&(i=r.shift())):typeof l=="object"&&l!==null&&(i=r.shift())}const o=r[0];return this._createRegisteredTool(e,void 0,a,t,n,i,o)}registerTool(e,r,a){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);const{title:t,description:n,inputSchema:i,outputSchema:o,annotations:l}=r;return this._createRegisteredTool(e,t,n,i,o,l,a)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let a;typeof r[0]=="string"&&(a=r.shift());let t;r.length>1&&(t=r.shift());const n=r[0],i=this._createRegisteredPrompt(e,void 0,a,t,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}registerPrompt(e,r,a){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);const{title:t,description:n,argsSchema:i}=r,o=this._createRegisteredPrompt(e,t,n,i,a);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}}const of={type:"object",properties:{}};function co(s){return typeof s!="object"||s===null?!1:Object.keys(s).length===0||Object.values(s).some(lf)}function lf(s){return s!==null&&typeof s=="object"&&"parse"in s&&typeof s.parse=="function"&&"safeParse"in s&&typeof s.safeParse=="function"}function cf(s){return Object.entries(s.shape).map(([e,r])=>({name:e,description:r.description,required:!r.isOptional()}))}function uo(s){return{completion:{values:s.slice(0,100),total:s.length,hasMore:s.length>100}}}const Kr={completion:{values:[],hasMore:!1}},ll=Sl.create({baseURL:window.wpAmeliaPluginAjaxURL});ll.interceptors.request.use(s=>(s.params={...s.params,wpAmeliaNonce:window.wpAmeliaNonce},s),s=>Promise.reject(s));async function dt(s,e={},r="GET",a){return(await ll.request({url:s,method:r,params:e,data:a})).data}function uf(){const s=new nf({name:"amelia-booking-service",version:"1.0.0"},{capabilities:{tools:{}}});return s.tool("list-services","Get all available booking services from Amelia. Use this when the user asks about services, available appointments, or what can be booked.",{},async()=>{const e=await dt("/services"),r=e?.data?.data?.services||e?.data?.services||e?.services;if(r&&Array.isArray(r))return{content:[{type:"text",text:JSON.stringify(r,null,2)}]};throw new Error("No services found in response")}),s.tool("list-employees","Get all employees/providers who can deliver services. Use this to find provider IDs needed for creating appointments.",{},async()=>{const e=await dt("/users/providers"),r=e?.data?.users||e?.users;if(r&&Array.isArray(r))return{content:[{type:"text",text:JSON.stringify(r,null,2)}]};throw new Error("No employees found in response")}),s.tool("list-customers","Get all customers in the Amelia system. Use this to find customer IDs needed for creating appointments.",{limit:Ce().min(1).max(500).optional().describe("Number of customers to retrieve (default 100, max 500)"),search:z().optional().describe("Search customers by name or email"),page:Ce().min(1).optional().describe("Page number for pagination (default 1)")},async({limit:e,search:r,page:a})=>{const t={page:a||1,limit:e||100};r&&(t.search=r);const n=await dt("/users/customers",t),i=n?.data?.users||n?.users;if(i&&Array.isArray(i))return{content:[{type:"text",text:JSON.stringify(i,null,2)}]};throw new Error("No customers found in response")}),s.tool("list-events","Get all events in the Amelia system. Use this to find event IDs and check if an event exists.",{limit:Ce().min(1).max(500).optional().describe("Number of events to retrieve (default 100, max 500)"),search:z().optional().describe("Search events by name"),page:Ce().min(1).optional().describe("Page number for pagination (default 1)"),dates:Je(z()).optional().describe("Filter events by dates in YYYY-MM-DD format")},async({limit:e,search:r,page:a,dates:t})=>{const n={page:a||1,limit:e||100};r&&(n.search=r),t&&t.length>0&&(n.dates=t);const i=await dt("/events",n),o=i?.data?.events||i?.events;if(o&&Array.isArray(o))return{content:[{type:"text",text:JSON.stringify(o,null,2)}]};throw new Error("No events found in response")}),s.tool("add-service","Creates a new service. Use this when user wants to add/create a new service.",{name:z().describe("Service name (required)"),categoryId:Ce().describe("Category ID (required). Use list-categories to find IDs."),duration:Ce().describe("Duration in seconds (required). Example: 3600 for 1 hour"),price:Ce().describe("Service price (required)"),providers:Je(Ce()).describe("Array of provider IDs (required). Use list-employees to find IDs.")},async({name:e,categoryId:r,duration:a,price:t,providers:n})=>{const o=await dt("/services",{},"POST",{name:e,categoryId:r,duration:a,price:t,minCapacity:1,maxCapacity:1,providers:n,color:"#1788FB",status:"visible",description:"",depositPayment:"disabled",recurringCycle:"disabled",recurringSub:"future",recurringPayment:0,deposit:0});return{content:[{type:"text",text:JSON.stringify(o,null,2)}]}}),s.tool("add-customer","Creates a new customer. Use this when user wants to add/create a new customer.",{firstName:z().describe("Customer first name (required)"),lastName:z().describe("Customer last name (required)"),email:z().email().describe("Customer email address (required)")},async({firstName:e,lastName:r,email:a})=>{const n=await dt("/users/customers",{},"POST",{firstName:e,lastName:r,email:a,type:"customer"});return{content:[{type:"text",text:JSON.stringify(n,null,2)}]}}),s.tool("create-appointment","Creates a new appointment booking. Use this when user wants to book/schedule an appointment.",{serviceId:Ce().describe("Service ID (required). Use list-services to find service IDs."),providerId:Ce().describe("Provider/employee ID (required). Use list-employees to find provider IDs."),customerId:Ce().describe("Customer ID (required). Use list-customers to find customer IDs."),bookingStart:z().regex(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/).describe('Appointment start date and time in YYYY-MM-DD HH:mm format (e.g., "2025-12-25 14:00")')},async({serviceId:e,providerId:r,customerId:a,bookingStart:t})=>{const[n,i]=t.split(" ");if(!n||!i)throw new Error("Invalid bookingStart format. Expected format: YYYY-MM-DD HH:mm");const l=await dt("/appointments",{},"POST",{serviceId:e,providerId:r,locationId:null,bookingStart:t,date:n,time:i,notifyParticipants:1,internalNotes:"",bookings:[{customerId:a,persons:1,status:"approved",duration:null,extras:[],customFields:[]}],recurring:[],payment:{gateway:"onSite",amount:0}});return{content:[{type:"text",text:JSON.stringify(l,null,2)}]}}),s.tool("create-event","Creates a new event in the Amelia system. Use this when user wants to create an event.",{name:z().describe("The name of the event (required)"),periodStart:z().describe("Event start date/time in YYYY-MM-DD HH:mm format (required)"),periodEnd:z().describe("Event end date/time in YYYY-MM-DD HH:mm format (required)"),price:Ce().optional().describe("Price of the event. Default: 0"),maxCapacity:Ce().optional().describe("Maximum capacity. Default: 10")},async({name:e,periodStart:r,periodEnd:a,price:t,maxCapacity:n})=>{const o=await dt("/events",{},"POST",{name:e,periods:[{periodStart:r,periodEnd:a}],price:t||0,maxCapacity:n||10,show:!0});return{content:[{type:"text",text:JSON.stringify(o,null,2)}]}}),s.tool("book-event","Book/register a customer for an event. Finds existing events or creates new ones automatically.",{eventName:z().describe("Event name (required)"),customerFirstName:z().describe("Customer first name (required)"),customerLastName:z().describe("Customer last name (required)"),customerEmail:z().email().describe("Customer email address (required)"),eventDate:z().regex(/^\d{4}-\d{2}-\d{2}$/).optional().describe("Event date in YYYY-MM-DD format. Required only for creating new events."),eventStartTime:z().regex(/^\d{2}:\d{2}$/).optional().describe('Event start time in HH:mm format. Default: "10:00"'),eventEndTime:z().regex(/^\d{2}:\d{2}$/).optional().describe('Event end time in HH:mm format. Default: "12:00"'),customerPhone:z().optional().describe("Customer phone number"),persons:Ce().min(1).optional().describe("Number of persons attending. Default: 1")},async({eventName:e,customerFirstName:r,customerLastName:a,customerEmail:t,eventDate:n,eventStartTime:i,eventEndTime:o,customerPhone:l,persons:c})=>{try{let h=null,p=null,y=!1;if(!e)throw new Error("Event name is required");const u={search:e,limit:100};n&&(u.dates=[n]);const f=await dt("/events",u),g=f?.data?.events||f?.events||[];let m=g.find(x=>x.name.toLowerCase()===e.toLowerCase());if(!m&&g.length>0&&(m=g.find(x=>x.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(x.name.toLowerCase()))),!m&&!n){const x=await dt("/events",{search:e,limit:100});m=(x?.data?.events||x?.events||[]).find(O=>O.name.toLowerCase()===e.toLowerCase()||O.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(O.name.toLowerCase()))}if(m)h=m.id;else{if(!n)throw new Error(`Event "${e}" not found. Provide eventDate parameter to create a new event.`);const x=i||"10:00",T=o||"12:00",O={name:e,periods:[{periodStart:`${n} ${x}`,periodEnd:`${n} ${T}`}],maxCapacity:10,price:0,show:!0},C=await dt("/events",{},"POST",O),S=C?.data?.data?.events||C?.data?.events||C?.events;if(S&&S.length>0)h=S[0].id,y=!0;else throw new Error("Failed to create event")}const w=await dt("/users/customers",{search:t}),A=(w?.data?.users||w?.users||[]).find(x=>x.email.toLowerCase()===t.toLowerCase());if(A)p=A.id;else{const x={firstName:r,lastName:a,email:t,type:"customer"};l&&(x.phone=l);const T=await dt("/users/customers",{},"POST",x),O=T?.data?.data?.user||T?.data?.user||T?.user;if(O)p=O.id;else throw new Error("Failed to create customer")}if(!h||!p)throw new Error("Failed to get event ID or customer ID");const E=await dt("/bookings",{},"POST",{type:"event",eventId:h,bookings:[{customerId:p,persons:c||1,status:"approved"}],payment:{gateway:"onSite",amount:0}});return{content:[{type:"text",text:JSON.stringify({success:!0,message:y?`Successfully created event "${e}" and booked ${r} ${a}`:`Successfully booked ${r} ${a} for event`,eventId:h,customerId:p,eventCreated:y,booking:E},null,2)}]}}catch(h){return{content:[{type:"text",text:JSON.stringify({success:!1,error:h.message||"Failed to book event",details:h.response?.data||h},null,2)}]}}}),s}const ho=async()=>{try{const s=uf(),e=new tu;if(typeof e.waitForReady=="function")try{await e.waitForReady()}catch{}await e.registerServer({name:"Amelia Booking System",version:"1.0.0",description:"Amelia Booking System - Manage appointments, services, events, employees, and customers. Tools: list-services, list-employees, list-customers, list-events, create-appointment, add-service, add-customer, create-event, book-event (unified tool for booking events - finds existing or creates new events automatically).",server:s})}catch(s){console.error(" [Amelia MCP] Registration failed:",s)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ho):ho();
